<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Jingwen&#39;s Note</title>
  <subtitle>Someone will look through your heart.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://fatelancer.github.io/"/>
  <updated>2018-06-21T08:42:09.565Z</updated>
  <id>http://fatelancer.github.io/</id>
  
  <author>
    <name>Jingwen CHEN</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>SikuliX</title>
    <link href="http://fatelancer.github.io/2018/06/21/SikuliX/"/>
    <id>http://fatelancer.github.io/2018/06/21/SikuliX/</id>
    <published>2018-06-21T07:13:13.000Z</published>
    <updated>2018-06-21T08:42:09.565Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Sikuli-Script"><a href="#Sikuli-Script" class="headerlink" title="Sikuli Script"></a><a href="http://www.sikuli.org/" target="_blank" rel="external">Sikuli Script</a></h1><p>To get debug output, if you use the SikuliX apps or otherwise have no chance to set parameters:<br>before starting add an empty file named SikulixDebug.txt in your home folder.</p>
<p>This is detected and will internally switch to <code>running with -d 3 -c</code> and redirect all debug output to this file.</p>
<p>The debug level can also be set inline in scripts and code<br>… and will be used from this point on until switched off or reset to another value</p>
<ul>
<li><code>Debug.on(3)</code> — switch debugging on with level 3</li>
<li><code>Debug.off()</code>— switch debugging off</li>
</ul>
<a id="more"></a>
<h2 id="general-aspect-of-scripting"><a href="#general-aspect-of-scripting" class="headerlink" title="general aspect of scripting"></a>general aspect of scripting</h2><p>Below is an Example of SikuliX script in Python:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">while</span> <span class="keyword">True</span>: <span class="comment"># repeat the body forever</span></div><div class="line">    wait(<span class="string">"image1.png"</span>, <span class="number">10</span>) <span class="comment"># wait max 10 seconds for image1 to get visible, otherwise die</span></div><div class="line">    click(<span class="string">"button1.png"</span>) <span class="comment"># click the button given by image button1</span></div><div class="line">    <span class="keyword">if</span> exists(<span class="string">"image2.png"</span>): <span class="comment"># wait max 3 seconds for image2 to get visible, return True or False</span></div><div class="line">       doSomething() <span class="comment"># in case True execute function doSomething (defined somewhere else)</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">       <span class="keyword">break</span> <span class="comment"># in case False get out of the loop, which ends the workflow</span></div><div class="line">    <span class="comment"># start all over with the line after the while</span></div><div class="line"><span class="comment"># the end of the workflow</span></div></pre></td></tr></table></figure>
<h2 id="Where-and-how-can-a-SikuliX-script-be-stored"><a href="#Where-and-how-can-a-SikuliX-script-be-stored" class="headerlink" title="Where and how can a SikuliX script be stored"></a>Where and how can a SikuliX script be stored</h2><p>A SikuliX script consists of <strong>one file containing the statements of your scripted workflow</strong> and zero to many image files, that you have captured, to support your workflow.</p>
<p>This bunch of related files is meant when we talk about a SikuliX script.</p>
<p>How to run such a script is shown in the next chapter.</p>
<p><strong>The standard storage for a SikuliX script is a folder/directory having the name that you have given to the script</strong>, when saving it from the IDE. It is mandatory, that the contained script file has the same name as the folder, which is guaranteed, when working with the SikuliX IDE. To avoid any problems, <strong>you should never directly access the folder content outside the SikuliX IDE</strong>, except you really know, what you are doing.</p>
<p>The file structure is like below:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">myscript.sikuli</div><div class="line">    button1.png</div><div class="line">    image1.png</div><div class="line">    image2.png</div><div class="line">    myscript.py</div></pre></td></tr></table></figure>
<p>There are two other storage variants for SikuliX scripts: zip-file and jar-file, which are intended for distribution of your scripts. Both variants pack the SikuliX script content in one file, which makes distribution easier. Both variants can be run with the means of SikuliX, as long as the target system has a valid SikuliX installation/setup.</p>
<ul>
<li><p>variant zip-file</p>
<p>It can be created in the SikuliX IDE with the file menu entry <code>Export packed source</code> and gets the <code>ending.skl</code> instead of <code>.sikuli</code>. As such it cannot be reopened for editing nor used for import, it can only be run using SikuliX features on systems having a valid SikuliX setup. In fact it is simply a zip-file, which can be brought back to a <code>.sikuli</code> folder using a zip utility. So be aware, that this variant does not really hide your script content.</p>
</li>
<li><p>variant jar-file (only available in 1.1.2+)</p>
<p>It can be created in the SikuliX IDE (file menu entry <code>Export as jar</code>). It can be run using SikuliX features on systems having a valid SikuliX setup. The script source is contained in compiled form (Java byte code) and hence not visible, even if one accesses the jar content. So this variant gives some level of secrecy for your scripted workflow.</p>
<p>There is a sub-variant, containing the scripting and SikuliX feature support additionally to the script content, which makes it runnable even on systems not having a valid SikuliX setup, but only a valid Java installation. Be aware, that such a jar has at least 60 MB though. <a href="https://answers.launchpad.net/sikuli/+faq/2947" target="_blank" rel="external">How to make and use it look here</a>.</p>
</li>
</ul>
<h2 id="How-to-Run-a-SikuliX-script"><a href="#How-to-Run-a-SikuliX-script" class="headerlink" title="How to Run a SikuliX script"></a>How to Run a SikuliX script</h2><p>In the SikuliX IDE a currently open script in the front most editor tab can be run by clicking the run button.</p>
<p>Saved scripts (.sikuli) and exported scripts (<code>.skl</code> and <code>.jar</code>) can be run from command line(<a href="http://sikulix-2014.readthedocs.io/en/latest/faq/010-command-line.html#runningscriptsfromcommandline" target="_blank" rel="external">see</a>) or from within other scripts (<a href="http://sikulix-2014.readthedocs.io/en/latest/scripting.html#runningscripts" target="_blank" rel="external">see</a>).</p>
<h1 id="Using-Python"><a href="#Using-Python" class="headerlink" title="Using Python"></a>Using Python</h1><h2 id="Setup-a-Jython-environment"><a href="#Setup-a-Jython-environment" class="headerlink" title="Setup a Jython environment"></a>Setup a Jython environment</h2><p>Apply the following steps, to get a Jython environment, that is SikuliX aware:</p>
<ul>
<li>download the installer package from Jython Downloads</li>
<li>install (usually by double-clicking the package) using the standard setup into an empty folder</li>
<li>test by running <code>&lt;jython-folder&gt;/bin/jython</code> from a command line, which should open an interactive Jython session, that allows, to run Python statements line by line</li>
<li>make sure, that pip and easy_install are available:<ul>
<li><code>&lt;jython-folder&gt;/bin/pip</code> exists</li>
<li><code>&lt;jython-folder&gt;/bin/easy_install</code> exists</li>
<li>if this is not the case run <code>&lt;jython-folder&gt;/bin/jython -m ensurepip</code> on a command line and check again</li>
<li>if you do not get pip ready, don’t bother: Jython is useable without it. The caveat: any additional packages have to be installed/setup manually.</li>
</ul>
</li>
</ul>
<p>If you succeeded with pip:</p>
<ul>
<li>run <code>&lt;jython-folder&gt;/bin/pip install jip</code> to install the package <code>jip</code>, which allows to add Java libraries easily to your Jython environment</li>
<li>add any needed Python package (must not depend on C-based stuff) using <code>pip, easy-install</code> or manual methods into<code>&lt;jython-folder&gt;/Lib/site-packages</code> and/or use <code>jip</code> for adding Java libraries preferably from Maven Central</li>
</ul>
<h2 id="Access-Python-packages-from-SikuliX-scripts-run-by-SikuliX-GUI-or-command-line"><a href="#Access-Python-packages-from-SikuliX-scripts-run-by-SikuliX-GUI-or-command-line" class="headerlink" title="Access Python packages from SikuliX scripts run by SikuliX (GUI or command line)"></a>Access Python packages from SikuliX scripts run by SikuliX (GUI or command line)</h2><p>The following approaches apply to situations, where you want to use Python modules installed somewhere on your system, without the need to manipulate <code>sys.path</code>, meaning, that when using <code>ìmport moduleXYZ</code> this package is found automatically.</p>
<p>SikuliX uses a central repository (<code>SikulixRepo</code> in the following) for internal stuff (native libraries, downloaded artifacts, resources needed at runtime and similar things). This is a folder in the user’s private space (home folder) <a href="http://sikulix-2014.readthedocs.io/en/latest/basicinfo.html#sikulixappdata" target="_blank" rel="external">look here</a>:</p>
<ul>
<li>Windows: <code>%APPDATA%\Sikulix</code></li>
</ul>
<h3 id="Basic-preparation"><a href="#Basic-preparation" class="headerlink" title="Basic preparation"></a>Basic preparation</h3><p>To <code>SikulixRepo</code> add a folder <code>Lib</code> (if not already there) and inside add a folder <code>site-packages</code></p>
<h3 id="Approach-1"><a href="#Approach-1" class="headerlink" title="Approach 1"></a>Approach 1</h3><p>Since an existing folder <code>SikulixRepo/Lib/site-packages</code> will be recognized and added automatically as the <code>1st entry to sys.path</code>, modules/packages contained in here will be found when imported without any further preparations. This approach can be used, to “overwrite” modules/packages, that otherwise would be found elsewhere on <code>sys.path</code> (e.g. for testing)</p>
<h3 id="Approach-2"><a href="#Approach-2" class="headerlink" title="Approach 2"></a>Approach 2</h3><p>In the folder <code>SikulixRepo/Lib/site-packages</code> have a file <code>sites.txt</code>, that contains absolute paths one per line, that point to other places, where modules packages can be found. These paths will be added automatically at startup to the <code>end of sys.path</code> in the given sequence. With this approach, you might for example add the <code>Lib/site-packages</code> folder of your own Jython installation.</p>
<h2 id="Prepare-and-use-your-own-jar-files-in-the-Jython-environment"><a href="#Prepare-and-use-your-own-jar-files-in-the-Jython-environment" class="headerlink" title="Prepare and use your own jar files in the Jython environment"></a>Prepare and use your own jar files in the Jython environment</h2><p>You might prepare jar files containing Python scripts/modules/packages, Java classes and other stuff like images, that are intended to be used in the scripting context.</p>
<h3 id="possible-use-case"><a href="#possible-use-case" class="headerlink" title="possible use case"></a>possible use case</h3><ul>
<li>you want to pack scripted stuff together with other resources into a container ready to be used by yourself or others via import (which is not supported by the <code>.skl</code> packaging method).</li>
<li>you want to secure your script code against modifications by others, that use your distributed jar.</li>
</ul>
<p>Later (possibly only with version 2) there will be a feature available, to run such script containers directly from command line (<code>java -jar mystuff.jar parameters</code>) or by double clicking.</p>
<h3 id="typical-jar-file-structure"><a href="#typical-jar-file-structure" class="headerlink" title="typical jar file structure"></a>typical jar file structure</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">-- jar rootlevel</div><div class="line">module1.py    <span class="comment"># Python module</span></div><div class="line">module2.py</div><div class="line">- folder1     <span class="comment"># Python package</span></div><div class="line">  __init__.py</div><div class="line">  stuff1.py</div><div class="line">  stuff2.py</div><div class="line">- images      <span class="comment"># image folder</span></div><div class="line">  img1.png</div><div class="line">  img2.png</div><div class="line">- org         <span class="comment"># Java package</span></div><div class="line">  - mystuff</div><div class="line">    class1.<span class="keyword">class</span></div><div class="line">    class1.<span class="keyword">class</span></div></pre></td></tr></table></figure>
<h3 id="how-to-pack-such-a-jar"><a href="#how-to-pack-such-a-jar" class="headerlink" title="how to pack such a jar"></a>how to pack such a jar</h3><p>You might use the Java <code>jar utility</code> (contained in the JDK).</p>
<p>Or use the <strong>SikuliX provided</strong> feature <code>Sikulix.buildJarFromFolder(jarpath, folder)</code>, where <code>jarpath</code> is the absolute path to the jar (the parent folder must exist, the jar is overwritten), that should be created and folder is the absolute path to a folder, containing the stuff to be packed. The content of the folder is copied to the root of the created jar.</p>
<p> Just run <code>Sikulix.buildJarFromFolder(jarpath, folder)</code> in an empty tab in the IDE or in a script, that might do some pre- and/or post processing.</p>
<p>If the folder contains an <code>__init__.py</code> on the first level, the given folder is taken as a Python package and as such copied to the root level of the jar, to preserve the package context:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">-- packagefolder</div><div class="line">  __init__.py</div><div class="line">  stuff.py</div><div class="line"></div><div class="line">becomes a jar</div><div class="line">-- jar rootlevel</div><div class="line">- packagefolder</div><div class="line">  __init__.py</div><div class="line">  stuff.py</div></pre></td></tr></table></figure>
<h3 id="how-to-secure-your-script-code-using-the-jar-packaging"><a href="#how-to-secure-your-script-code-using-the-jar-packaging" class="headerlink" title="how to secure your script code using the jar packaging"></a>how to secure your script code using the jar packaging</h3><ul>
<li>step 1: prepare a folder as in the previous chapter</li>
<li>Step 2: compile the folder into a new folder (see below)</li>
<li>Step 3: pack the new folder into a jar for distribution</li>
</ul>
<p>Run in an empty IDE tab or as part of a script:</p>
<p><code>Sikulix.compileJythonFolder(sourcefolder, targetfolder)</code></p>
<p>copies the complete content from source folder to target folder (the parent folder must exist, the folder is emptied if exists) and then traverses the target folder replacing each <code>foobar.py</code> with it’s compiled version <code>foobar$py.class</code>, that contains JVM-byte-code, so your script code cannot be edited anymore in this target folder, but still be used with <code>import foobar</code>.</p>
<p><strong>Be aware:</strong> Be sure, your code compiles without errors, because the compile feature either succeeds or fails (compile errors), but you will not get any information about the cause or even the place of the compile problem.</p>
<h2 id="Scripting-with-IntelliJ-PyCharm-and-IDEA-with-Python-plugin"><a href="#Scripting-with-IntelliJ-PyCharm-and-IDEA-with-Python-plugin" class="headerlink" title="Scripting with IntelliJ PyCharm and IDEA with Python plugin"></a>Scripting with IntelliJ PyCharm and IDEA with Python plugin</h2><p>PyCharm has a weakness, in that code completion while editing does not look into jar-files nor Java classes, while in the built-in Python console after having imported a Java class, code completion about the class attributes/methods works, so having a console open while editing might help as a workaround for inspecting Java classes.</p>
<p><strong>Step 1: get Jython up and running</strong></p>
<p>Just follow the steps mentioned in the chapter <code>Setup a Jython environment</code> above.</p>
<p><strong>Step 2: get PyCharm up and running</strong></p>
<p>Download and install the <a href="https://www.jetbrains.com/pycharm/" target="_blank" rel="external">PyCharm Community Edition</a>.</p>
<p><strong>Step 3: tell PyCharm to use Jython as interpreter</strong></p>
<p>Start PyCharm and make sure to have closed all projects and be in the start-up window titled <code>Welcome to PyCharm</code>.</p>
<p>At bottom right in the menu <code>Configure</code> select <code>Preferences</code>. You should get a dialog window titled <code>Default Preferences</code>.</p>
<p>At the left side select <code>Project Interpreter</code> and choose your installed Jython by pointing to the contained <code>.../bin/jython</code> script/command-file.</p>
<p>Click <code>Apply</code> and watch how the Jython setup is analyzed and implemented in PyCharm. If it worked click <code>Ok</code>.</p>
<p> <img src="http://sikulix-2014.readthedocs.io/en/latest/_images/pycharmDefaultInterpreter.png" alt="1|center"></p>
<p><strong>Step 4: setup the environment for a Python console</strong></p>
<p>As with the step before get the <code>Default Preferences</code> dialog open.</p>
<p>At the left side select <code>Build, Execution, Deployment</code>… <code>Console</code>… <code>Python Console</code>.</p>
<p>To the <code>Environment variables</code> add entry <code>CLASSPATH</code>, that points to a valid <code>sikulixapi.jar</code> (created using setup).</p>
<p>In the <code>Starting script</code> you might add the 2 lines <code>import org.sikuli.script.SikulixForJython from sikuli import *</code> so each time you start a console, the prompt is already prepared to know about SikuliX features.</p>
<p> <img src="http://sikulix-2014.readthedocs.io/en/latest/_images/pycharmDefaultConsole.png" alt="2|center"></p>
<h1 id="Using-RobotFramework"><a href="#Using-RobotFramework" class="headerlink" title="Using RobotFramework"></a>Using RobotFramework</h1><p>You can run ready Robot scripts out of the box in the SikuliX context (IDE or from command line). The needed Python module robot ( from <a href="https://pypi.python.org/pypi/robotframework" target="_blank" rel="external">robotframework 3.0</a> ) is bundled with the <code>sikulixapi.jar</code>. At runtime and already with setup, the module is exported to the folder <code>&lt;SikulixAppData&gt;/Lib</code>, which is on <code>sys.path</code> automatically. So there is no need to have anything else available than a suitable setup of SikuliX.</p>
<p>The easiest way is to use the SikuliX IDE with this principal setup</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">runScript(<span class="string">"""</span></div><div class="line">robot</div><div class="line">*** Variables ***</div><div class="line">$&#123;USERNAME&#125;               demo</div><div class="line">$&#123;PASSWORD&#125;               mode</div><div class="line">$&#123;TESTSITE&#125;               http://test.sikuli.de</div><div class="line">*** Settings ***</div><div class="line">Library           ./inline/LoginLibrary</div><div class="line">Test Setup        start firefox and goto testsite    $&#123;TESTSITE&#125;</div><div class="line">Test Teardown     stop firefox</div><div class="line">*** Test Cases ***</div><div class="line">User can log in with correct user and password</div><div class="line">    Attempt to Login with Credentials    $&#123;USERNAME&#125;    $&#123;PASSWORD&#125;</div><div class="line">    Status Should Be    Accepted</div><div class="line">User cannot log in with invalid user or bad password</div><div class="line">    Attempt to Login with Credentials    betty    wrong</div><div class="line">    Status Should Be    Denied</div><div class="line">""")</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginLibrary</span><span class="params">(object)</span>:</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">start_firefox_and_goto_testsite</span><span class="params">(self, page)</span>:</span></div><div class="line">    popup(<span class="string">"start_firefox_and_goto_testsite"</span>)</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">stop_firefox</span><span class="params">(self)</span>:</span></div><div class="line">    popup(<span class="string">"stop_firefox"</span>)</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">attempt_to_login_with_credentials</span><span class="params">(self, username, password)</span>:</span></div><div class="line">    popup(<span class="string">"attempt_to_login_with_credentials"</span>)</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">status_should_be</span><span class="params">(self, expected)</span>:</span></div><div class="line">    popup(<span class="string">"status_should_be"</span>)</div></pre></td></tr></table></figure>
<p>the first 2 lines</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">runScript(<span class="string">"""</span></div><div class="line">robot</div></pre></td></tr></table></figure>
<p>signal, that you want to run an inline Robot script, that follows on the next lines terminated by <code>&quot;&quot;&quot;)</code>. This construct is a multiline Python comment, that can be used as a string.</p>
<p><strong>BE AWARE</strong> In the standard, a report HTML will be automatically opened in the standard browser at termination. If you do not want that (e.g. in unattended situations) use this instead as the first 2 lines. Take care: after robot 1 space, a linefeed directly after silent and nothing else.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">runScript(<span class="string">"""</span></div><div class="line">robot silent</div></pre></td></tr></table></figure>
<p>Normally when working with SikuliX features, you have to do some Robot Keyword implementation at the Python level. To Robot you tell where to find these implementation using the <code>Library setting</code>.</p>
<p>In this case we have the implementations inline in the same script file according to the Robot rules packed into a Python class having the Keyword methods according to the Robot naming conventions. At runtime this class will be exported to a Python file, whose absolute path is then replacing the Library setting.</p>
<p>If you have the Keyword implementations somewhere outside, then you have to put the correct path specification into the Library setting. Another option is to reference a jar file as a Library again according to the Robot specifications.</p>
<p>If you now run the script in the IDE, internally a <code>robot.run</code> will be fired after having setup the script content and the environment. Currently no extra options can be provided for the robot run. As a result you get a folder with the ending <code>.robot</code> named as your script in the same folder as your script folder containing inputs to and the results from the robot run</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># supposing the script is named testrobot.sikuli</span></div><div class="line"><span class="comment"># then you get a folder testrobot.sikuli.robot with the content</span></div><div class="line">testrobot.robot <span class="comment"># the robot script</span></div><div class="line">LoginLibrary.py <span class="comment"># the Python Keyword implementations</span></div><div class="line"><span class="comment"># the standard Robot outcome</span></div><div class="line">output.xml</div><div class="line">log.html</div><div class="line">report.html</div></pre></td></tr></table></figure>
<p>Still being in the IDE another possible setup would be this way:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">robotScript = <span class="string">"""</span></div><div class="line">robot</div><div class="line">*** Variables ***</div><div class="line">$&#123;USERNAME&#125;               demo</div><div class="line">$&#123;PASSWORD&#125;               mode</div><div class="line">$&#123;TESTSITE&#125;               http://test.sikuli.de</div><div class="line">*** Settings ***</div><div class="line">Library           /some/path/to/LoginLibrary.py</div><div class="line">Test Setup        start firefox and goto testsite    $&#123;TESTSITE&#125;</div><div class="line">Test Teardown     stop firefox</div><div class="line">*** Test Cases ***</div><div class="line">User can log in with correct user and password</div><div class="line">    Attempt to Login with Credentials    $&#123;USERNAME&#125;    $&#123;PASSWORD&#125;</div><div class="line">    Status Should Be    Accepted</div><div class="line">User cannot log in with invalid user or bad password</div><div class="line">    Attempt to Login with Credentials    betty    wrong</div><div class="line">    Status Should Be    Denied</div><div class="line">"""</div><div class="line"></div><div class="line"><span class="comment"># here you could do some preprocessing and even modify the above robotscript</span></div><div class="line"></div><div class="line">runScript(robotscript)</div><div class="line"></div><div class="line"><span class="comment"># eventually do something with the result</span></div></pre></td></tr></table></figure>
<p><strong>BE AWARE</strong> for the keyword library, the <code>Name</code> in the file name <code>Name.py</code> and the statement <code>class Name()</code> <strong>must</strong> be the same and start with an uppercase letter.</p>
<p><strong>BE AWARE ON WINDOWS</strong> the file path must be escaped with 4 backslashes for each backslash like so <code>C:\\\\Robot\\\\Libraries\\\\Name.py</code> (which leads to the needed 2 backslashes for each backslash as escape in the final robot file)</p>
<blockquote>
<p><strong>I think two backslashes are just enough.</strong></p>
</blockquote>
<p>Of course you can use any other method, to fill a string representing a valid Robot script, provided the first line contains the string <code>robot</code> and only that (denoting the script type for run Script).</p>
<p>If in such a case you want to provide an inline Keyword implementation: this does the trick:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># prepare your script content</span></div><div class="line">runScript(<span class="string">"robot\n"</span> + scriptContent)</div><div class="line"><span class="comment"># eventually do something with the result</span></div><div class="line"></div><div class="line"><span class="comment"># """)</span></div><div class="line"></div><div class="line"><span class="comment"># the rest is taken as inline Keyword implementation</span></div></pre></td></tr></table></figure>
<p>If you have the need to specify extra parameters to the <code>robot.run()</code>, then you still have the option to stay within the SikuliX context (IDE or from command line):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">prepareRobot() <span class="comment"># takes care for the correct environment</span></div><div class="line"></div><div class="line">workdir = getParentFolder()</div><div class="line">script = <span class="string">"arobottest/arobottest.robot"</span></div><div class="line">robotscript = os.path.join(workdir, script)</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"*** trying to run:"</span>, robotscript</div><div class="line">robot.run(robotscript, outputdir=workdir)</div></pre></td></tr></table></figure>
<p>A <code>library.py</code> file being either in the script folder itself or in the folder containing the script folder is found automatically. So simply the library name is enough in this case. In all other cases you either have to specify the absolute path off the <code>.py</code> script (take care with windows - see above) or use <code>addImportPath()</code> to add the folder containing the <code>library.py</code> file to <code>sys.path</code>, in which case again only the name is sufficient in the Robot script.</p>
<p>It is strongly recommended, to always specify the <code>outputdir= parameter</code> since otherwise the report files will be written to the working folder (from where you are running), which might not always be what you want.</p>
<p>If you want to use any of these variants outside the SikuliX context (some external Jython or in an IDE like PyCharm) you have to add these 2 lines at the beginning of your main script (as always in such cases):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.sikuli.script.SikulixForJython</div><div class="line"><span class="keyword">from</span> sikuli <span class="keyword">import</span> *</div></pre></td></tr></table></figure>
<p>to get the SikuliX context ready.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Sikuli-Script&quot;&gt;&lt;a href=&quot;#Sikuli-Script&quot; class=&quot;headerlink&quot; title=&quot;Sikuli Script&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.sikuli.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sikuli Script&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;To get debug output, if you use the SikuliX apps or otherwise have no chance to set parameters:&lt;br&gt;before starting add an empty file named SikulixDebug.txt in your home folder.&lt;/p&gt;
&lt;p&gt;This is detected and will internally switch to &lt;code&gt;running with -d 3 -c&lt;/code&gt; and redirect all debug output to this file.&lt;/p&gt;
&lt;p&gt;The debug level can also be set inline in scripts and code&lt;br&gt;… and will be used from this point on until switched off or reset to another value&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Debug.on(3)&lt;/code&gt; — switch debugging on with level 3&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Debug.off()&lt;/code&gt;— switch debugging off&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="jython" scheme="http://fatelancer.github.io/tags/jython/"/>
    
      <category term="python" scheme="http://fatelancer.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>EESM 5650 L1 Introduction</title>
    <link href="http://fatelancer.github.io/2017/09/04/EESM-5650-L1-Introduction/"/>
    <id>http://fatelancer.github.io/2017/09/04/EESM-5650-L1-Introduction/</id>
    <published>2017-09-04T06:36:00.000Z</published>
    <updated>2018-06-21T03:46:06.333Z</updated>
    
    <content type="html"><![CDATA[<h1 id="L1-Intrduction"><a href="#L1-Intrduction" class="headerlink" title="L1 Intrduction"></a>L1 Intrduction</h1><p>network consists essentially of <strong>network switches, or nodes</strong>, interconnected by transmission links.</p>
<p><strong>Key operating parameters:</strong></p>
<ul>
<li>frequence: 2.4Ghz/5GHz (WiFi)</li>
<li>Band Width: 20MHz</li>
</ul>
<p><strong>Key tecxhnologies: OFDM（Orthogonal Frequency Division Multiplexing），MIMO（Multiple Input Multiple Output）</strong></p>
<p>Different types of networks</p>
<ul>
<li>Local Area Network (LAN)</li>
<li>Metropolitan Area Network (MAN)</li>
<li>Wide Area Network (WAN)</li>
</ul>
<a id="more"></a>
<h2 id="Communication-Systems-and-Networks"><a href="#Communication-Systems-and-Networks" class="headerlink" title="Communication Systems and Networks"></a>Communication Systems and Networks</h2><h3 id="Protocol-Architectures"><a href="#Protocol-Architectures" class="headerlink" title="Protocol Architectures"></a>Protocol Architectures</h3><ul>
<li>most networks are designed as a series of layers or levels: each one built upon its predecessor.</li>
<li>the goal of each layer is to offer certain services to the higher levels, shielding those layers from the details of how the offered services are actually implemented.</li>
<li>Layer N on one host carries on a conversation with layer N on another host.</li>
<li>The rules and conventions used in this conversation or session are collectively<br>known as the layer N protocol.</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504508669154.png" alt=""></p>
<h3 id="ISO’s-OSI-Reference-Model"><a href="#ISO’s-OSI-Reference-Model" class="headerlink" title="ISO’s OSI Reference Model"></a>ISO’s OSI Reference Model</h3><p>ISO’s OSI Reference Model consists <strong>7 Layers</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504508757572.png" alt=""></p>
<h4 id="Internet-Protocol-Stack"><a href="#Internet-Protocol-Stack" class="headerlink" title="Internet Protocol Stack"></a>Internet Protocol Stack</h4><ul>
<li>application: supporting network applications : HTTP, SMTP, FTP, DNS</li>
<li>transport: process-process data transfer:  TCP, UDP</li>
<li>network: routing of datagrams from source to destination: IP, routing protocols</li>
<li>link: data transfer between neighboring network elements: 802.11, Ethernet</li>
<li>physical: bits “on the wire”</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504509033269.png" alt=""></p>
<ul>
<li>link layer: bits—&gt;packets—&gt;correct errors</li>
<li>physical layer: sending bits from A —&gt; B</li>
<li>network layer: join nodes together</li>
</ul>
<h4 id="How-Layer-Works"><a href="#How-Layer-Works" class="headerlink" title="How Layer Works"></a>How Layer Works</h4><ul>
<li>Each layer adds/strips off its own header (and possibly a trailer)</li>
<li>Each layer may split up higher-level data</li>
<li>Each layer multiplexes multiple higher layers</li>
<li>Each layer is (mostly) transparent to higher layers</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504509297663.png" alt=""></p>
<p><strong>Encapsulation</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504509393734.png" alt=""></p>
<h3 id="Transmission-Protocols"><a href="#Transmission-Protocols" class="headerlink" title="Transmission Protocols"></a>Transmission Protocols</h3><ul>
<li>Simplex（单工）：Communication flow can <strong>only occur in one direction</strong></li>
<li>Half Duplex（半双工）：Communication flow can occur <strong>in both directions, but not at the same time</strong></li>
<li>Full Duplex（全双工）：Communication link can support <strong>simultaneous two-way communications.</strong>（requires twice channels of Simplex or half-duplex）</li>
</ul>
<h3 id="Transmission-Systems"><a href="#Transmission-Systems" class="headerlink" title="Transmission Systems"></a>Transmission Systems</h3><p><strong>Analog Communications</strong></p>
<ul>
<li>Continuous modulation</li>
<li>Fidelity is usually defined in terms of SNR</li>
</ul>
<p>$$ SNR={P_S \over P_N} $$<br>$$ dB=10log{P_S\over P_N} $$<br>When SNR&gt;10dB====&gt; Good Communications</p>
<p><strong>Digital Communications</strong></p>
<ul>
<li>Signals made up of discrete symbols selected from a finite set</li>
<li>Fidelity or Accuracy is specified in terms of bit error rate ( BER )</li>
</ul>
<p>mobile out: 0.1W<br>mobile in: $10^{-10}W\sim 10^{-13}W$<br>mobile noise: around $10^{-13}W$</p>
<h4 id="Digital-Communication-Systems"><a href="#Digital-Communication-Systems" class="headerlink" title="Digital Communication Systems"></a>Digital Communication Systems</h4><ul>
<li>Sampling</li>
<li>Quantization</li>
<li>Source Coding</li>
<li>Encryption</li>
<li>Channel coding</li>
<li>Modulation</li>
</ul>
<h4 id="Communication-Channels"><a href="#Communication-Channels" class="headerlink" title="Communication Channels"></a>Communication Channels</h4><p><strong>Effects include:</strong></p>
<ul>
<li>Attenuation</li>
<li>Noise</li>
<li>Filtering</li>
<li>Fading</li>
<li>Time Variation</li>
</ul>
<p><strong>Good Commnication System</strong></p>
<ul>
<li>Small signal power (measured in Watts or dBm)</li>
<li>Large data rate (measured in bits/sec)</li>
<li>Small bandwidth (measured in Hertz)</li>
<li>Low distortion (measured in SNR or bit error rate)</li>
<li>Low cost - with digital communications, large complexity does not always result in large cost</li>
</ul>
<h2 id="Stochastic-Process"><a href="#Stochastic-Process" class="headerlink" title="Stochastic Process"></a>Stochastic Process</h2><h3 id="Statistical-Description-of-Noise"><a href="#Statistical-Description-of-Noise" class="headerlink" title="Statistical Description of Noise"></a>Statistical Description of Noise</h3><ul>
<li>Generally noise can be modeled as a Gaussian process (by the central limit theorem). In this case, we say that at a particular time, t, the noise signal amplitude will be Gaussian distributed</li>
<li>If the noise is white noise, then all frequency components appear with equal power (white used in white light for similar reason)</li>
</ul>
<h3 id="Statistical-Averages"><a href="#Statistical-Averages" class="headerlink" title="Statistical Averages"></a>Statistical Averages</h3><p><strong>discrete: </strong></p>
<p>  $$\bar {X}=E[X]=\sum_{i=1}^M x_iP_i$$</p>
<p><strong>continuous: </strong></p>
<p>  $$\bar {X}=E[X]=\int_{-\infty}^{\infty}xf_X(x)dx$$</p>
<p><strong>Variance</strong></p>
<p>  $$\sigma_X^2=E[(X-\bar{X})]=E[X^2]-(E[X])^2$$</p>
<p>$\sigma_X$= Standard Deviation</p>
<h3 id="Joint-Distribution"><a href="#Joint-Distribution" class="headerlink" title="Joint Distribution"></a>Joint Distribution</h3><p>  $$F_{XY}=(x,y) \triangleq P(X\le x, Y\le y)$$</p>
<p>  $$f<em>{XY}(x, y)={\partial^2 F</em>{XY}(x, y)\over {\partial x\partial y}}$$</p>
<p><strong>If X and Y are said to be independent, </strong></p>
<p>  $$P(X\le x, Y\le y)=P(X\le x)P(Y\le y)$$</p>
<h3 id="Key-Distribution"><a href="#Key-Distribution" class="headerlink" title="Key Distribution"></a>Key Distribution</h3><p><strong>Gaussian Distribution</strong></p>
<p>  $$X\sim N(m_X, \sigma^2_X)$$</p>
<p>  $$f_X(x)={1\over {\sqrt{2\pi\sigma_X^2}}}exp(-{(x-m_X)^2\over {2\sigma^2_X}})$$</p>
<p>Zero Mean</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544041296.png" alt=""></p>
<h3 id="Correlation"><a href="#Correlation" class="headerlink" title="Correlation"></a>Correlation</h3><p>Correlation: the dependency between 2 entities</p>
<h3 id="Random-Process"><a href="#Random-Process" class="headerlink" title="Random Process"></a><a href="https://en.wikipedia.org/wiki/Stochastic_process" target="_blank" rel="external">Random Process</a></h3><ul>
<li><strong>A random process is a rule assigning every outcome of an experiment a function X(t)</strong></li>
<li><strong>A random process can be described as X(t)=x(t,n) where n is a member in the sample space S</strong></li>
<li>A particular X(t)=x(t,n) is referred to as <strong>a sample function or realization of the random process</strong></li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544336973.png" alt=""></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544361678.png" alt="n is fixed"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544390155.png" alt="t is fixed"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544415515.png" alt="t and n are fixed"></p>
<p>A random process is said to be Wide-Sense Stationary (WSS) If and Only If</p>
<p>  $$E[X(t)]\triangleq \bar{X}(t)=Constant$$</p>
<p>  $$R_X(t_1, t_2)=E[X(t_1)X(t_2)]=R_X(|t_1-t_2|)\triangleq R_X(\tau)$$</p>
<p>That is, a WSS process is characterized by a constant mean and a one-dimensional autocorrelation function that depends on only the time difference t</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544501666.png" alt=""></p>
<h3 id="Autocorrelation"><a href="#Autocorrelation" class="headerlink" title="Autocorrelation"></a>Autocorrelation</h3><ul>
<li>The autocorrelation of a random process describes the correlation between values of the process at different times</li>
<li><p>It is a function of the two times for which the values are found</p>
<p>$$R_X(t_1,t_2)=E[X(t_1)X(t_2)]$$</p>
</li>
<li><p>Typically as the difference between the two times gets larger the auto-correlation gets less</p>
</li>
</ul>
<p>for white noise: Autocorrelation = 0</p>
<h3 id="Time-Averages"><a href="#Time-Averages" class="headerlink" title="Time Averages"></a>Time Averages</h3><p><img src="http://oag5ozkgs.bkt.clouddn.com/1504545092742.png" alt=""></p>
<p>A r.p. is said to be Ergodic if all time averages and Ensemble averages are equal</p>
<p>  <img src="http://oag5ozkgs.bkt.clouddn.com/1504549964236.png" alt=""></p>
<p>Noise Power = $KT\times B$<br>$$dBW=10log(KTB/1W)$$</p>
<p>$$dB=10log({P_1\over P_2})\<br>dBW=10log({P_1 \over 1W})\<br>dBm=10log({P_1 \over 1mW})$$</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p><strong>Noise: </strong></p>
<ul>
<li>Gaussian</li>
<li>Ergodic-&gt;Stationary</li>
<li>mean-&gt;Zero mean</li>
<li>PSD-&gt;(FT)Autocorrelation</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;L1-Intrduction&quot;&gt;&lt;a href=&quot;#L1-Intrduction&quot; class=&quot;headerlink&quot; title=&quot;L1 Intrduction&quot;&gt;&lt;/a&gt;L1 Intrduction&lt;/h1&gt;&lt;p&gt;network consists essentially of &lt;strong&gt;network switches, or nodes&lt;/strong&gt;, interconnected by transmission links.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Key operating parameters:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;frequence: 2.4Ghz/5GHz (WiFi)&lt;/li&gt;
&lt;li&gt;Band Width: 20MHz&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Key tecxhnologies: OFDM（Orthogonal Frequency Division Multiplexing），MIMO（Multiple Input Multiple Output）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Different types of networks&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Local Area Network (LAN)&lt;/li&gt;
&lt;li&gt;Metropolitan Area Network (MAN)&lt;/li&gt;
&lt;li&gt;Wide Area Network (WAN)&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="EESM 5650 Digital Comminications and Networks" scheme="http://fatelancer.github.io/categories/EESM-5650-Digital-Comminications-and-Networks/"/>
    
    
      <category term="Stochastic Processe" scheme="http://fatelancer.github.io/tags/Stochastic-Processe/"/>
    
  </entry>
  
  <entry>
    <title>EESM 5620 L1 Introduction</title>
    <link href="http://fatelancer.github.io/2017/09/04/EESM-5620-L1-Introduction/"/>
    <id>http://fatelancer.github.io/2017/09/04/EESM-5620-L1-Introduction/</id>
    <published>2017-09-04T06:10:39.000Z</published>
    <updated>2017-09-04T17:28:03.631Z</updated>
    
    <content type="html"><![CDATA[<h1 id="EESM-5620-Flat-Display"><a href="#EESM-5620-Flat-Display" class="headerlink" title="EESM 5620 Flat Display"></a>EESM 5620 Flat Display</h1><h1 id="L1-Introduction"><a href="#L1-Introduction" class="headerlink" title="L1 Introduction"></a>L1 Introduction</h1><h2 id="Chapter-1-Introduction"><a href="#Chapter-1-Introduction" class="headerlink" title="Chapter 1 Introduction"></a>Chapter 1 Introduction</h2><h3 id="1-1-Background-Knowledge"><a href="#1-1-Background-Knowledge" class="headerlink" title="1.1  Background Knowledge"></a>1.1  Background Knowledge</h3><ul>
<li>materials science</li>
<li>electronics</li>
<li>optics</li>
</ul>
<h3 id="1-2-Various-kinds-of-displays"><a href="#1-2-Various-kinds-of-displays" class="headerlink" title="1.2 Various kinds of displays"></a>1.2 Various kinds of displays</h3><p>Information displays:</p>
<ul>
<li>Fixed displays （指针显示器？）</li>
<li>Electronic displays （电子显示器）<ul>
<li>Emissive （主动发光）<ul>
<li>Neon light signs Cathode ray tube (CRT) 阴极射线显像管</li>
<li>Light emitting diode (LED) 发光二极管</li>
<li>Electroluminescent display (ELD) 电致发光显示器</li>
<li>Plasma display panels (PDP) 等离子显示板</li>
<li>Vacuum fluorescent display (VFD) 真空荧光显示屏（类似电子管）</li>
<li>Field emission display (FED) 场发射显示器</li>
<li>Organic LED (OLED) 有机发光二极管</li>
<li>Polymer LED (PLED) 高分子发光二极管</li>
</ul>
</li>
<li>Non-emissive (based on control of light transmission or reflection) 被动发光（基于光的传输和反射的非发射性？）<ul>
<li>Mechanical tile displays</li>
<li>Liquid crystal display (LCD) 液晶显示器</li>
<li>Microelectromechanical (MEMS) based display (DMD or DLP) 微机电系统显示器</li>
<li>Electrochromic display (ECD) 电致变色显示器</li>
<li>Electronic ink (e-ink) 电墨显示器</li>
</ul>
</li>
</ul>
</li>
</ul>
<a id="more"></a>
<p> But the market is dominated by <strong>CRT</strong> and <strong>LCD</strong>.</p>
<p> LCD technology is further subdivided into TN, STN, TFT (active matrix) etc. TN = Twisted nematic（扭曲向列型）. STN = Supertwisted nematic（超扭曲向列屏）. TFT = Thin film transistor（薄膜晶体管）.</p>
<p>A projection display system consists of imager（成像器） + color management optics（光学色相。。） + projection lens（投影透镜） + screen （屏幕）</p>
<h2 id="Chapter-2-Basic-Structure-of-LCD"><a href="#Chapter-2-Basic-Structure-of-LCD" class="headerlink" title="Chapter 2 Basic Structure of LCD"></a>Chapter 2 Basic Structure of LCD</h2><h3 id="2-1-Basic-Structure-AND-Materials"><a href="#2-1-Basic-Structure-AND-Materials" class="headerlink" title="2.1 Basic Structure AND Materials"></a>2.1 Basic Structure AND Materials</h3><p><img src="http://oag5ozkgs.bkt.clouddn.com/1504231634577.png" alt="Basic Structure AND Materials"></p>
<h3 id="2-2-Basic-operating-principles"><a href="#2-2-Basic-operating-principles" class="headerlink" title="2.2 Basic operating principles"></a>2.2 Basic operating principles</h3><p>polarization manipulation of light using electrical pulses</p>
<p>Common model of a TN display:</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504231872291.png" alt="Common model"></p>
<h3 id="2-3-Different-ways-to-view-a-LCD"><a href="#2-3-Different-ways-to-view-a-LCD" class="headerlink" title="2.3 Different ways to view a LCD"></a>2.3 Different ways to view a LCD</h3><ul>
<li>Transmittive（透射）: This is often the case for LCD with backlighting（no reflector）.</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504232324260.png" alt="Transmittive"></p>
<ul>
<li><a href="https://baike.baidu.com/item/%E5%8D%8A%E5%8F%8D%E5%8D%8A%E9%80%8F%E5%B1%8F%E5%B9%95" target="_blank" rel="external">Transflective（半透）</a>: The rear reflector is often a diffusive type reflector to eliminate mirror effects.</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504232646622.png" alt="Transflective"></p>
<ul>
<li>Reflective（全反射）:  In a truly reflective LCD, there is only one front polarizer.</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504233149000.png" alt="Reflective"></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;EESM-5620-Flat-Display&quot;&gt;&lt;a href=&quot;#EESM-5620-Flat-Display&quot; class=&quot;headerlink&quot; title=&quot;EESM 5620 Flat Display&quot;&gt;&lt;/a&gt;EESM 5620 Flat Display&lt;/h1&gt;&lt;h1 id=&quot;L1-Introduction&quot;&gt;&lt;a href=&quot;#L1-Introduction&quot; class=&quot;headerlink&quot; title=&quot;L1 Introduction&quot;&gt;&lt;/a&gt;L1 Introduction&lt;/h1&gt;&lt;h2 id=&quot;Chapter-1-Introduction&quot;&gt;&lt;a href=&quot;#Chapter-1-Introduction&quot; class=&quot;headerlink&quot; title=&quot;Chapter 1 Introduction&quot;&gt;&lt;/a&gt;Chapter 1 Introduction&lt;/h2&gt;&lt;h3 id=&quot;1-1-Background-Knowledge&quot;&gt;&lt;a href=&quot;#1-1-Background-Knowledge&quot; class=&quot;headerlink&quot; title=&quot;1.1  Background Knowledge&quot;&gt;&lt;/a&gt;1.1  Background Knowledge&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;materials science&lt;/li&gt;
&lt;li&gt;electronics&lt;/li&gt;
&lt;li&gt;optics&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;1-2-Various-kinds-of-displays&quot;&gt;&lt;a href=&quot;#1-2-Various-kinds-of-displays&quot; class=&quot;headerlink&quot; title=&quot;1.2 Various kinds of displays&quot;&gt;&lt;/a&gt;1.2 Various kinds of displays&lt;/h3&gt;&lt;p&gt;Information displays:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Fixed displays （指针显示器？）&lt;/li&gt;
&lt;li&gt;Electronic displays （电子显示器）&lt;ul&gt;
&lt;li&gt;Emissive （主动发光）&lt;ul&gt;
&lt;li&gt;Neon light signs Cathode ray tube (CRT) 阴极射线显像管&lt;/li&gt;
&lt;li&gt;Light emitting diode (LED) 发光二极管&lt;/li&gt;
&lt;li&gt;Electroluminescent display (ELD) 电致发光显示器&lt;/li&gt;
&lt;li&gt;Plasma display panels (PDP) 等离子显示板&lt;/li&gt;
&lt;li&gt;Vacuum fluorescent display (VFD) 真空荧光显示屏（类似电子管）&lt;/li&gt;
&lt;li&gt;Field emission display (FED) 场发射显示器&lt;/li&gt;
&lt;li&gt;Organic LED (OLED) 有机发光二极管&lt;/li&gt;
&lt;li&gt;Polymer LED (PLED) 高分子发光二极管&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Non-emissive (based on control of light transmission or reflection) 被动发光（基于光的传输和反射的非发射性？）&lt;ul&gt;
&lt;li&gt;Mechanical tile displays&lt;/li&gt;
&lt;li&gt;Liquid crystal display (LCD) 液晶显示器&lt;/li&gt;
&lt;li&gt;Microelectromechanical (MEMS) based display (DMD or DLP) 微机电系统显示器&lt;/li&gt;
&lt;li&gt;Electrochromic display (ECD) 电致变色显示器&lt;/li&gt;
&lt;li&gt;Electronic ink (e-ink) 电墨显示器&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="EESM 5620 Flat Display" scheme="http://fatelancer.github.io/categories/EESM-5620-Flat-Display/"/>
    
    
  </entry>
  
  <entry>
    <title>多维混合Copula的风速建模</title>
    <link href="http://fatelancer.github.io/2017/04/13/%E5%A4%9A%E7%BB%B4%E6%B7%B7%E5%90%88Copula%E7%9A%84%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1/"/>
    <id>http://fatelancer.github.io/2017/04/13/多维混合Copula的风速建模/</id>
    <published>2017-04-13T08:12:39.000Z</published>
    <updated>2017-04-14T08:27:38.737Z</updated>
    
    <content type="html"><![CDATA[<h1 id="多维混合Copula参数估计"><a href="#多维混合Copula参数估计" class="headerlink" title="多维混合Copula参数估计"></a>多维混合Copula参数估计</h1><h2 id="EM算法主体部分"><a href="#EM算法主体部分" class="headerlink" title="EM算法主体部分"></a>EM算法主体部分</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">tic</div><div class="line">U=QWC;</div><div class="line">V=BDQC;</div><div class="line">Z=GHKC;</div><div class="line">M=CMC;</div><div class="line"><span class="comment">%初始化</span></div><div class="line">S=<span class="number">5</span>;</div><div class="line">th=<span class="number">0.001</span></div><div class="line">omega=[<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>];</div><div class="line">a1=copulafit(<span class="string">'Gaussian'</span>,[U,V,Z,M]);</div><div class="line">[a2,nuhat]=copulafit(<span class="string">'t'</span>,[U,V,Z,M]);</div><div class="line">a3=copula4fit(<span class="string">'Gumbel'</span>,[U,V,Z,M]);</div><div class="line">a4=copula4fit(<span class="string">'Clayton'</span>,[U,V,Z,M]);</div><div class="line">a5=copula4fit(<span class="string">'Frank'</span>,[U,V,Z,M]);</div><div class="line">theta=&#123;a1,a2,a3,a4,a5&#125;;</div><div class="line">tturntheta_old=<span class="built_in">zeros</span>(<span class="number">35</span>,<span class="number">1</span>);</div><div class="line">N=<span class="built_in">numel</span>(U);</div><div class="line">count=<span class="number">0</span>;</div><div class="line">tt=<span class="built_in">zeros</span>(N,<span class="number">4</span>);</div><div class="line">nn=<span class="built_in">zeros</span>(N,<span class="number">4</span>);</div><div class="line">tt(:,<span class="number">1</span>)=tinv(U(:),nuhat);</div><div class="line">tt(:,<span class="number">2</span>)=tinv(V(:),nuhat);</div><div class="line">tt(:,<span class="number">3</span>)=tinv(Z(:),nuhat);</div><div class="line">tt(:,<span class="number">4</span>)=tinv(M(:),nuhat);</div><div class="line">nn(:,<span class="number">1</span>)=norminv(U(:));</div><div class="line">nn(:,<span class="number">2</span>)=norminv(V(:));</div><div class="line">nn(:,<span class="number">3</span>)=norminv(Z(:));</div><div class="line">nn(:,<span class="number">4</span>)=norminv(M(:));</div><div class="line">t=<span class="built_in">inf</span>;</div><div class="line">COPULA=<span class="built_in">zeros</span>(N,S);</div><div class="line">list1=cell(<span class="number">6</span>,<span class="number">101</span>);</div><div class="line">list2=<span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">101</span>);</div><div class="line">puz=<span class="built_in">zeros</span>(N,S);</div><div class="line">puz1=<span class="built_in">zeros</span>(N,S);</div><div class="line">turntheta_old=<span class="built_in">zeros</span>(<span class="number">15</span>,<span class="number">1</span>);</div><div class="line">lower=[-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,<span class="number">1.001</span>,<span class="number">0.001</span>,-inf];</div><div class="line">turntheta=<span class="built_in">zeros</span>(<span class="number">15</span>,<span class="number">1</span>);</div><div class="line"><span class="keyword">while</span> t&gt;=th&amp;&amp;count&lt;=<span class="number">100</span></div><div class="line">    theta_old=theta;</div><div class="line">    omega_old=omega;</div><div class="line"></div><div class="line"><span class="comment">%保证搜索过程中仍为正定矩阵</span></div><div class="line">    [A1,B1]=eig(theta_old&#123;<span class="number">1</span>&#125;);</div><div class="line">    [A2,B2]=eig(theta_old&#123;<span class="number">2</span>&#125;);</div><div class="line">    C1=A1*<span class="built_in">sqrt</span>(B1);</div><div class="line">    C2=A2*<span class="built_in">sqrt</span>(B2);</div><div class="line"></div><div class="line">    tturntheta_old(<span class="number">1</span>:<span class="number">16</span>)=<span class="built_in">reshape</span>(C1,[<span class="number">16</span>,<span class="number">1</span>]);</div><div class="line">    tturntheta_old(<span class="number">17</span>:<span class="number">32</span>)=<span class="built_in">reshape</span>(C2,[<span class="number">16</span>,<span class="number">1</span>]);</div><div class="line">    tturntheta_old(<span class="number">33</span>)=theta_old&#123;<span class="number">3</span>&#125;;</div><div class="line">    tturntheta_old(<span class="number">34</span>)=theta_old&#123;<span class="number">4</span>&#125;;</div><div class="line">    tturntheta_old(<span class="number">35</span>)=theta_old&#123;<span class="number">5</span>&#125;;</div><div class="line"></div><div class="line">    COPULA(:,<span class="number">1</span>)=copulapdf(<span class="string">'Gaussian'</span>,[U,V,Z,M],theta_old&#123;<span class="number">1</span>&#125;);</div><div class="line">    COPULA(:,<span class="number">2</span>)=copulapdf(<span class="string">'t'</span>,[U,V,Z,M],theta_old&#123;<span class="number">2</span>&#125;,nuhat);</div><div class="line">    COPULA(:,<span class="number">3</span>)=copula4pdf(<span class="string">'Gumbel'</span>,[U,V,Z,M],theta_old&#123;<span class="number">3</span>&#125;);</div><div class="line">    COPULA(:,<span class="number">4</span>)=copula4pdf(<span class="string">'Clayton'</span>,[U,V,Z,M],theta_old&#123;<span class="number">4</span>&#125;);</div><div class="line">    COPULA(:,<span class="number">5</span>)=copula4pdf(<span class="string">'Frank'</span>,[U,V,Z,M],theta_old&#123;<span class="number">5</span>&#125;);</div><div class="line"></div><div class="line">    puz(:,<span class="number">1</span>)=COPULA(:,<span class="number">1</span>)*omega_old(<span class="number">1</span>);</div><div class="line">    puz(:,<span class="number">2</span>)=COPULA(:,<span class="number">2</span>)*omega_old(<span class="number">2</span>);</div><div class="line">    puz(:,<span class="number">3</span>)=COPULA(:,<span class="number">3</span>)*omega_old(<span class="number">3</span>);</div><div class="line">    puz(:,<span class="number">4</span>)=COPULA(:,<span class="number">4</span>)*omega_old(<span class="number">4</span>);</div><div class="line">    puz(:,<span class="number">5</span>)=COPULA(:,<span class="number">5</span>)*omega_old(<span class="number">5</span>);</div><div class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">1</span>)=puz(<span class="built_in">i</span>,<span class="number">1</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">2</span>)=puz(<span class="built_in">i</span>,<span class="number">2</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">3</span>)=puz(<span class="built_in">i</span>,<span class="number">3</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">4</span>)=puz(<span class="built_in">i</span>,<span class="number">4</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">5</span>)=puz(<span class="built_in">i</span>,<span class="number">5</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    omega(<span class="number">1</span>)=sum(puz1(:,<span class="number">1</span>))/N;</div><div class="line">    omega(<span class="number">2</span>)=sum(puz1(:,<span class="number">2</span>))/N;</div><div class="line">    omega(<span class="number">3</span>)=sum(puz1(:,<span class="number">3</span>))/N;</div><div class="line">    omega(<span class="number">4</span>)=sum(puz1(:,<span class="number">4</span>))/N;</div><div class="line">    omega(<span class="number">5</span>)=sum(puz1(:,<span class="number">5</span>))/N;</div><div class="line">    omega</div><div class="line">    [tturntheta,fval,exitflag,output]=update4theta(N,U,V,Z,M,tturntheta_old,puz1,tt,nn,lower,nuhat);</div><div class="line"></div><div class="line">    CC1=<span class="built_in">reshape</span>(tturntheta(<span class="number">1</span>:<span class="number">16</span>),[<span class="number">4</span>,<span class="number">4</span>]);</div><div class="line">    CC2=<span class="built_in">reshape</span>(tturntheta(<span class="number">17</span>:<span class="number">32</span>),[<span class="number">4</span>,<span class="number">4</span>]);</div><div class="line">    CC1=CC1*CC1';</div><div class="line">    CC2=CC2*CC2';</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">find</span>(eig(CC1)&lt;<span class="number">0.000000001</span>)&gt;<span class="number">0</span>)</div><div class="line">        CC1=CC1+<span class="built_in">eps</span>*<span class="built_in">eye</span>(<span class="number">4</span>);</div><div class="line">    <span class="keyword">end</span></div><div class="line">    <span class="keyword">if</span> (<span class="built_in">find</span>(eig(CC2)&lt;<span class="number">0.000000001</span>)&gt;<span class="number">0</span>)</div><div class="line">        CC2=CC2+<span class="built_in">eps</span>*<span class="built_in">eye</span>(<span class="number">4</span>);</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    theta&#123;<span class="number">1</span>&#125;=[<span class="number">1</span>,CC1(<span class="number">1</span>,<span class="number">2</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">2</span>,<span class="number">2</span>)),CC1(<span class="number">1</span>,<span class="number">3</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),CC1(<span class="number">1</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC1(<span class="number">1</span>,<span class="number">2</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,CC1(<span class="number">2</span>,<span class="number">3</span>)/sqrt(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),CC1(<span class="number">2</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC1(<span class="number">1</span>,<span class="number">3</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),CC1(<span class="number">2</span>,<span class="number">3</span>)/sqrt(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,CC1(<span class="number">3</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">3</span>,<span class="number">3</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC1(<span class="number">1</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>)),CC1(<span class="number">2</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>)),CC1(<span class="number">3</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">3</span>,<span class="number">3</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</div><div class="line">    theta&#123;<span class="number">2</span>&#125;=[<span class="number">1</span>,CC2(<span class="number">1</span>,<span class="number">2</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">2</span>,<span class="number">2</span>)),CC2(<span class="number">1</span>,<span class="number">3</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),CC2(<span class="number">1</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC2(<span class="number">1</span>,<span class="number">2</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,CC2(<span class="number">2</span>,<span class="number">3</span>)/sqrt(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),CC2(<span class="number">2</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC2(<span class="number">1</span>,<span class="number">3</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),CC2(<span class="number">2</span>,<span class="number">3</span>)/sqrt(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,CC2(<span class="number">3</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">3</span>,<span class="number">3</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC2(<span class="number">1</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>)),CC2(<span class="number">2</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>)),CC2(<span class="number">3</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">3</span>,<span class="number">3</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</div><div class="line">    theta&#123;<span class="number">3</span>&#125;=tturntheta(<span class="number">33</span>);</div><div class="line">    theta&#123;<span class="number">4</span>&#125;=tturntheta(<span class="number">34</span>);</div><div class="line">    theta&#123;<span class="number">5</span>&#125;=tturntheta(<span class="number">35</span>);</div><div class="line"></div><div class="line"></div><div class="line">    theta;</div><div class="line">    list1&#123;<span class="number">1</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">1</span>&#125;;</div><div class="line">    list1&#123;<span class="number">2</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">2</span>&#125;;</div><div class="line">    list1&#123;<span class="number">3</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">3</span>&#125;;</div><div class="line">    list1&#123;<span class="number">4</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">4</span>&#125;;</div><div class="line">    list1&#123;<span class="number">5</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">5</span>&#125;;</div><div class="line"></div><div class="line">    theta&#123;<span class="number">1</span>&#125;</div><div class="line">    theta&#123;<span class="number">2</span>&#125;</div><div class="line">    theta&#123;<span class="number">3</span>&#125;</div><div class="line">    theta&#123;<span class="number">4</span>&#125;</div><div class="line">    theta&#123;<span class="number">5</span>&#125;</div><div class="line"></div><div class="line">    list2(:,count+<span class="number">1</span>)=omega;</div><div class="line">    t=max([norm(tturntheta(:)-tturntheta_old(:));norm(omega_old(:)-omega(:))])</div><div class="line">    count=count+<span class="number">1</span></div><div class="line"><span class="keyword">end</span></div><div class="line">toc</div></pre></td></tr></table></figure>
<p><strong>注：在多维模式下最应注意的是搜索过程中多维高斯Copula与t-Copula的相依结构参数应该保持正定</strong></p>
<blockquote>
<p>保持矩阵正定的方法<br>假设 $A$ 矩阵正定，则;<br>$A=Y<em>\lambda</em>Y^T$,其中 $\lambda$ 为对角线上为矩阵$A$的特征值的对角矩阵，$Y$为对应各特征值的特征向量矩阵。<br>因此对于$B=Y<em>\sqrt{\lambda}$，有$A=B</em>B^T$。<br>因此只需对$B$中的元素进行搜索就能保证最后合成的$A$一定为正定。</p>
</blockquote>
<a id="more"></a>
<h2 id="非线性优化部分"><a href="#非线性优化部分" class="headerlink" title="非线性优化部分"></a>非线性优化部分</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="params">[turntheta,fval,exitflag,output]</span>=<span class="title">update4theta</span><span class="params">(N,U,V,Z,M,ttheta,puz,t,n,lower,nuhat)</span></span></div><div class="line">tic</div><div class="line">options=optimset(<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'MaxFunEvals'</span>,<span class="number">10000</span>,<span class="string">'TolFun'</span>,<span class="number">1e-8</span>,<span class="string">'TolX'</span>,<span class="number">1e-10</span>,<span class="string">'LargeScale'</span>,<span class="string">'on'</span>,<span class="string">'HessUpdate'</span>,<span class="string">'bfgs'</span>,<span class="string">'UseParallel'</span>,<span class="number">1</span>);</div><div class="line">[turntheta,fval,exitflag,output]=fmincon(@u4theta,ttheta,[],[],[],[],lower,[],[],options);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">u4theta</span><span class="params">(ttheta)</span></span></div><div class="line">    theta=cell(<span class="number">5</span>,<span class="number">1</span>);</div><div class="line"></div><div class="line">    X1=<span class="built_in">reshape</span>(ttheta(<span class="number">1</span>:<span class="number">16</span>),[<span class="number">4</span>,<span class="number">4</span>]);</div><div class="line">    X2=<span class="built_in">reshape</span>(ttheta(<span class="number">17</span>:<span class="number">32</span>),[<span class="number">4</span>,<span class="number">4</span>]);</div><div class="line">    X1=X1*X1';</div><div class="line">    X2=X2*X2';</div><div class="line"></div><div class="line">    theta&#123;<span class="number">1</span>&#125;=[<span class="number">1</span>,X1(<span class="number">1</span>,<span class="number">2</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">2</span>,<span class="number">2</span>)),X1(<span class="number">1</span>,<span class="number">3</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),X1(<span class="number">1</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X1(<span class="number">1</span>,<span class="number">2</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,X1(<span class="number">2</span>,<span class="number">3</span>)/sqrt(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),X1(<span class="number">2</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X1(<span class="number">1</span>,<span class="number">3</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),X1(<span class="number">2</span>,<span class="number">3</span>)/sqrt(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,X1(<span class="number">3</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">3</span>,<span class="number">3</span>)*X1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X1(<span class="number">1</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">4</span>,<span class="number">4</span>)),X1(<span class="number">2</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">4</span>,<span class="number">4</span>)),X1(<span class="number">3</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">3</span>,<span class="number">3</span>)*X1(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</div><div class="line">    theta&#123;<span class="number">2</span>&#125;=[<span class="number">1</span>,X2(<span class="number">1</span>,<span class="number">2</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">2</span>,<span class="number">2</span>)),X2(<span class="number">1</span>,<span class="number">3</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),X2(<span class="number">1</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X2(<span class="number">1</span>,<span class="number">2</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,X2(<span class="number">2</span>,<span class="number">3</span>)/sqrt(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),X2(<span class="number">2</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X2(<span class="number">1</span>,<span class="number">3</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),X2(<span class="number">2</span>,<span class="number">3</span>)/sqrt(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,X2(<span class="number">3</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">3</span>,<span class="number">3</span>)*X2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X2(<span class="number">1</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">4</span>,<span class="number">4</span>)),X2(<span class="number">2</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">4</span>,<span class="number">4</span>)),X2(<span class="number">3</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">3</span>,<span class="number">3</span>)*X2(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</div><div class="line">    theta&#123;<span class="number">3</span>&#125;=ttheta(<span class="number">33</span>);</div><div class="line">    theta&#123;<span class="number">4</span>&#125;=ttheta(<span class="number">34</span>);</div><div class="line">    theta&#123;<span class="number">5</span>&#125;=ttheta(<span class="number">35</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span> theta&#123;<span class="number">5</span>&#125;==<span class="number">0</span></div><div class="line">    theta&#123;<span class="number">5</span>&#125;=theta&#123;<span class="number">5</span>&#125;+<span class="number">0.0001</span>;</div><div class="line"><span class="keyword">end</span></div><div class="line">th1=theta&#123;<span class="number">1</span>&#125;;</div><div class="line">th2=theta&#123;<span class="number">2</span>&#125;;</div><div class="line">th3=theta&#123;<span class="number">3</span>&#125;;</div><div class="line">th4=theta&#123;<span class="number">4</span>&#125;;</div><div class="line">th5=theta&#123;<span class="number">5</span>&#125;;</div><div class="line">y=<span class="number">0</span>;</div><div class="line">Y=<span class="built_in">zeros</span>(<span class="number">1</span>,N);</div><div class="line"><span class="keyword">parfor</span> <span class="built_in">j</span>=<span class="number">1</span>:N</div><div class="line">    Y(<span class="built_in">j</span>)=<span class="built_in">log</span>(det(th1)^(<span class="number">-1</span>/<span class="number">2</span>)*<span class="built_in">exp</span>(<span class="number">-1</span>/<span class="number">2</span>*n(<span class="built_in">j</span>,:)*(th1^(<span class="number">1</span>)-<span class="built_in">eye</span>(<span class="number">4</span>))*n(<span class="built_in">j</span>,:)'))*puz(<span class="built_in">j</span>,<span class="number">1</span>)+...</div><div class="line">         <span class="built_in">log</span>(det(th2)^(<span class="number">-1</span>/<span class="number">2</span>)*<span class="built_in">gamma</span>((nuhat+<span class="number">4</span>)/<span class="number">2</span>)*<span class="built_in">gamma</span>(nuhat/<span class="number">2</span>)^(<span class="number">3</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,:)*th2^(<span class="number">-1</span>)*t(<span class="built_in">j</span>,:)'/nuhat)^(-(nuhat+<span class="number">4</span>)/<span class="number">2</span>)/((<span class="built_in">gamma</span>((nuhat+<span class="number">1</span>)/<span class="number">2</span>))^<span class="number">4</span>*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">1</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">2</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">3</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">4</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)))*puz(<span class="built_in">j</span>,<span class="number">2</span>)+...</div><div class="line">         <span class="built_in">log</span>((<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">4</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) + (th3^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)^<span class="number">2</span>*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) + (th3^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">2</span>/th3 - <span class="number">2</span>)*(<span class="number">2</span>/th3 - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) - (<span class="number">2</span>*th3*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">2</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) - (<span class="number">2</span>*th3*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">2</span>/th3 - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">3</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) - (th3^<span class="number">3</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">2</span>)*(<span class="number">1</span>/th3 - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) + (<span class="number">2</span>*th3^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">3</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)))*puz(<span class="built_in">j</span>,<span class="number">3</span>)+...</div><div class="line">         <span class="built_in">log</span>((th4^<span class="number">3</span>*(<span class="number">1</span>/th4 + <span class="number">1</span>)*(<span class="number">1</span>/th4 + <span class="number">2</span>)*(<span class="number">1</span>/th4 + <span class="number">3</span>))/(M(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*U(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*V(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*Z(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*(<span class="number">1</span>/M(<span class="built_in">j</span>)^th4 + <span class="number">1</span>/U(<span class="built_in">j</span>)^th4 + <span class="number">1</span>/V(<span class="built_in">j</span>)^th4 + <span class="number">1</span>/Z(<span class="built_in">j</span>)^th4 - <span class="number">3</span>)^(<span class="number">1</span>/th4 + <span class="number">4</span>)))*puz(<span class="built_in">j</span>,<span class="number">4</span>)+...</div><div class="line">         <span class="built_in">log</span>((<span class="number">7</span>*th5^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)^<span class="number">2</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">2</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)) + (<span class="number">6</span>*th5^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)^<span class="number">4</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">4</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)) - (th5^<span class="number">3</span>*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>))/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)) - (<span class="number">12</span>*th5^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)^<span class="number">3</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">3</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)))*puz(<span class="built_in">j</span>,<span class="number">5</span>);</div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line">y=-sum(Y);</div><div class="line"><span class="keyword">end</span></div><div class="line">toc</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h1 id="参数估计结果"><a href="#参数估计结果" class="headerlink" title="参数估计结果"></a>参数估计结果</h1><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">rho_n=[<span class="number">1.0000</span>   <span class="number">-0.4594</span>    <span class="number">0.6594</span>    <span class="number">0.3254</span></div><div class="line">     <span class="number">-0.4594</span>    <span class="number">1.0000</span>   <span class="number">-0.8218</span>    <span class="number">0.6426</span></div><div class="line">      <span class="number">0.6594</span>   <span class="number">-0.8218</span>    <span class="number">1.0000</span>   <span class="number">-0.4552</span></div><div class="line">      <span class="number">0.3254</span>    <span class="number">0.6426</span>   <span class="number">-0.4552</span>    <span class="number">1.0000</span>];</div><div class="line"></div><div class="line">rho_t=[<span class="number">1.0000</span>    <span class="number">0.6856</span>    <span class="number">0.6195</span>    <span class="number">0.6621</span></div><div class="line">      <span class="number">0.6856</span>    <span class="number">1.0000</span>    <span class="number">0.9344</span>    <span class="number">0.3696</span></div><div class="line">      <span class="number">0.6195</span>    <span class="number">0.9344</span>    <span class="number">1.0000</span>    <span class="number">0.3127</span></div><div class="line">      <span class="number">0.6621</span>    <span class="number">0.3696</span>    <span class="number">0.3127</span>    <span class="number">1.0000</span>];</div><div class="line"></div><div class="line">rho_g=<span class="number">1.9479</span>;</div><div class="line"></div><div class="line">rho_c=<span class="number">0.0010</span>;</div><div class="line"></div><div class="line">rho_f=<span class="number">2.0234</span>;</div><div class="line"></div><div class="line">omega=[<span class="number">0</span>    <span class="number">0.7098</span>    <span class="number">0.1432</span>    <span class="number">0.0364</span>    <span class="number">0.1106</span>]</div></pre></td></tr></table></figure>
<p>欧式距离</p>
<p>$d_m=6.6293$</p>
<p>可以看出从欧氏距离上讲，确实混合Copula模型比单个Copula建模的效果要好。<br>由于高斯Copula在多维下并不能表现出尾部相关性，因此其权重参数为0。其余的Copula基本是按照各自拟合优度占据权重。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;多维混合Copula参数估计&quot;&gt;&lt;a href=&quot;#多维混合Copula参数估计&quot; class=&quot;headerlink&quot; title=&quot;多维混合Copula参数估计&quot;&gt;&lt;/a&gt;多维混合Copula参数估计&lt;/h1&gt;&lt;h2 id=&quot;EM算法主体部分&quot;&gt;&lt;a href=&quot;#EM算法主体部分&quot; class=&quot;headerlink&quot; title=&quot;EM算法主体部分&quot;&gt;&lt;/a&gt;EM算法主体部分&lt;/h2&gt;&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;66&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;67&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;68&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;69&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;70&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;71&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;72&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;73&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;74&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;75&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;76&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;77&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;78&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;79&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;80&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;81&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;82&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;83&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;84&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;85&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;86&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;87&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;88&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;89&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;90&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;91&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;92&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;93&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;94&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;95&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;96&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;97&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;98&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;99&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;100&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;101&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;102&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;103&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;104&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;105&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;106&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;107&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;108&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;109&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;110&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;111&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;112&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;113&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;114&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;115&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;116&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;117&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;118&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;119&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;120&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;121&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;122&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tic&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;U=QWC;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;V=BDQC;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Z=GHKC;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;M=CMC;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;%初始化&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;S=&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;th=&lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;omega=[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a1=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;Gaussian&#39;&lt;/span&gt;,[U,V,Z,M]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;[a2,nuhat]=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;t&#39;&lt;/span&gt;,[U,V,Z,M]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a3=copula4fit(&lt;span class=&quot;string&quot;&gt;&#39;Gumbel&#39;&lt;/span&gt;,[U,V,Z,M]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a4=copula4fit(&lt;span class=&quot;string&quot;&gt;&#39;Clayton&#39;&lt;/span&gt;,[U,V,Z,M]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a5=copula4fit(&lt;span class=&quot;string&quot;&gt;&#39;Frank&#39;&lt;/span&gt;,[U,V,Z,M]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;theta=&amp;#123;a1,a2,a3,a4,a5&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tturntheta_old=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;N=&lt;span class=&quot;built_in&quot;&gt;numel&lt;/span&gt;(U);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;count=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tt=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nn=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tt(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=tinv(U(:),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tt(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=tinv(V(:),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tt(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=tinv(Z(:),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tt(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=tinv(M(:),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nn(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=norminv(U(:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nn(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=norminv(V(:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nn(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=norminv(Z(:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nn(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=norminv(M(:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;t=&lt;span class=&quot;built_in&quot;&gt;inf&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;COPULA=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;list1=cell(&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;list2=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;puz=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;puz1=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;turntheta_old=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;lower=[-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,&lt;span class=&quot;number&quot;&gt;1.001&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;,-inf];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;turntheta=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; t&amp;gt;=th&amp;amp;&amp;amp;count&amp;lt;=&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta_old=theta;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega_old=omega;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;%保证搜索过程中仍为正定矩阵&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    [A1,B1]=eig(theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    [A2,B2]=eig(theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    C1=A1*&lt;span class=&quot;built_in&quot;&gt;sqrt&lt;/span&gt;(B1);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    C2=A2*&lt;span class=&quot;built_in&quot;&gt;sqrt&lt;/span&gt;(B2);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tturntheta_old(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(C1,[&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tturntheta_old(&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(C2,[&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tturntheta_old(&lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;)=theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tturntheta_old(&lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;)=theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tturntheta_old(&lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;)=theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;Gaussian&#39;&lt;/span&gt;,[U,V,Z,M],theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;t&#39;&lt;/span&gt;,[U,V,Z,M],theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&amp;#125;,nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=copula4pdf(&lt;span class=&quot;string&quot;&gt;&#39;Gumbel&#39;&lt;/span&gt;,[U,V,Z,M],theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=copula4pdf(&lt;span class=&quot;string&quot;&gt;&#39;Clayton&#39;&lt;/span&gt;,[U,V,Z,M],theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=copula4pdf(&lt;span class=&quot;string&quot;&gt;&#39;Frank&#39;&lt;/span&gt;,[U,V,Z,M],theta_old&amp;#123;&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:N&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    [tturntheta,fval,exitflag,output]=update4theta(N,U,V,Z,M,tturntheta_old,puz1,tt,nn,lower,nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    CC1=&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(tturntheta(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;),[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    CC2=&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(tturntheta(&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;),[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    CC1=CC1*CC1&#39;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    CC2=CC2*CC2&#39;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;find&lt;/span&gt;(eig(CC1)&amp;lt;&lt;span class=&quot;number&quot;&gt;0.000000001&lt;/span&gt;)&amp;gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        CC1=CC1+&lt;span class=&quot;built_in&quot;&gt;eps&lt;/span&gt;*&lt;span class=&quot;built_in&quot;&gt;eye&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;find&lt;/span&gt;(eig(CC2)&amp;lt;&lt;span class=&quot;number&quot;&gt;0.000000001&lt;/span&gt;)&amp;gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        CC2=CC2+&lt;span class=&quot;built_in&quot;&gt;eps&lt;/span&gt;*&lt;span class=&quot;built_in&quot;&gt;eye&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;=[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)),CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)),CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)),&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)),CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)),CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)),&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,CC1(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)),CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)),CC1(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC1(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)*CC1(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)),&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&amp;#125;=[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)),CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)),CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)),&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)),CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)),CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)),&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,CC2(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)),CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)),CC2(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sqrt(CC2(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)*CC2(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)),&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;&amp;#125;=tturntheta(&lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&amp;#125;=tturntheta(&lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&amp;#125;=tturntheta(&lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list1&amp;#123;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;=theta&amp;#123;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list1&amp;#123;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;=theta&amp;#123;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list1&amp;#123;&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;=theta&amp;#123;&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list1&amp;#123;&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;=theta&amp;#123;&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list1&amp;#123;&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;=theta&amp;#123;&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&amp;#123;&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list2(:,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=omega;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    t=max([norm(tturntheta(:)-tturntheta_old(:));norm(omega_old(:)-omega(:))])&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    count=count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;toc&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;注：在多维模式下最应注意的是搜索过程中多维高斯Copula与t-Copula的相依结构参数应该保持正定&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;保持矩阵正定的方法&lt;br&gt;假设 $A$ 矩阵正定，则;&lt;br&gt;$A=Y&lt;em&gt;\lambda&lt;/em&gt;Y^T$,其中 $\lambda$ 为对角线上为矩阵$A$的特征值的对角矩阵，$Y$为对应各特征值的特征向量矩阵。&lt;br&gt;因此对于$B=Y&lt;em&gt;\sqrt{\lambda}$，有$A=B&lt;/em&gt;B^T$。&lt;br&gt;因此只需对$B$中的元素进行搜索就能保证最后合成的$A$一定为正定。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="MATLAB" scheme="http://fatelancer.github.io/tags/MATLAB/"/>
    
      <category term="EM算法" scheme="http://fatelancer.github.io/tags/EM%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>多维形式的Copula函数推导及建模</title>
    <link href="http://fatelancer.github.io/2017/04/06/%E5%A4%9A%E7%BB%B4%E5%BD%A2%E5%BC%8F%E7%9A%84Copula%E5%87%BD%E6%95%B0%E6%8E%A8%E5%AF%BC%E5%8F%8A%E5%BB%BA%E6%A8%A1/"/>
    <id>http://fatelancer.github.io/2017/04/06/多维形式的Copula函数推导及建模/</id>
    <published>2017-04-06T06:57:33.000Z</published>
    <updated>2018-06-21T03:47:16.085Z</updated>
    
    <content type="html"><![CDATA[<h1 id="两种Copula"><a href="#两种Copula" class="headerlink" title="两种Copula"></a>两种Copula</h1><p>Copula函数主要分为两种，一种为椭圆族Copula，一种为Archimedean-Copula。其中椭圆族Copula直接给出了其多维形式，具体详见<a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;filter=sc_long_sign&amp;tn=SE_xueshusource_2kduw22v&amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;ie=utf-8&amp;sc_us=15886197312218780659" target="_blank" rel="external">《MATLAB统计分析与应用：40个案例分析》</a>P189。而Archimedean-Copula的函数由于各种生成元的不同导致只给出了常用的二元形式。多维形式需要手动推导。</p>
<h1 id="对多维Archimedean-Copula推导"><a href="#对多维Archimedean-Copula推导" class="headerlink" title="对多维Archimedean-Copula推导"></a>对多维Archimedean-Copula推导</h1><h2 id="对于分布函数的推导"><a href="#对于分布函数的推导" class="headerlink" title="对于分布函数的推导"></a>对于分布函数的推导</h2><p>根据<a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;filter=sc_long_sign&amp;tn=SE_xueshusource_2kduw22v&amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;ie=utf-8&amp;sc_us=15886197312218780659" target="_blank" rel="external">书中</a>P190给出的生成元与基础形式，推导出各自生成元的反函数，然后将生成元带入，得到四维Copula分布函数。<br><a id="more"></a><br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Gumbelcdf =</div><div class="line"><span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U)).^a+(-<span class="built_in">log</span>(V)).^a+(-<span class="built_in">log</span>(Z)).^a+(-<span class="built_in">log</span>(M)).^a).^(<span class="number">1.</span>/a))</div><div class="line"></div><div class="line">Claytoncdf =</div><div class="line">(U.^(-a)+V.^(-a)+Z.^(-a)+M.^(-a)<span class="number">-3</span>).^(<span class="number">-1.</span>/a)</div><div class="line"></div><div class="line">Frankcdf =</div><div class="line">-<span class="built_in">log</span>(<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)./a</div></pre></td></tr></table></figure></p>
<h2 id="对于密度函数的推导"><a href="#对于密度函数的推导" class="headerlink" title="对于密度函数的推导"></a>对于密度函数的推导</h2><p>根据定义，密度函数是对分布函数中的多个样本进行多次求偏导得到的。由于函数较为复杂，手动推导会带来很大的麻烦，因而采用MATLAB程序进行推导。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">clear all;</div><div class="line">syms U V Z M a d</div><div class="line">S1=<span class="string">'exp(-((-log(U))^a+(-log(V))^a+(-log(Z))^a+(-log(M))^a)^(1/a))'</span>;</div><div class="line">d=S1;</div><div class="line">v=[U V Z M];</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></div><div class="line">    d=diff(d,v(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line">Gum=d</div><div class="line">S2=<span class="string">'(U^(-a)+V^(-a)+Z^(-a)+M^(-a)-3)^(-1/a)'</span></div><div class="line">d=S2;</div><div class="line">v=[U V Z M];</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></div><div class="line">    d=diff(d,v(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line">Clay=d</div><div class="line">S3=<span class="string">'-log(exp(log((exp(-M*a) - 1)/(exp(-a) - 1)) + log((exp(-U*a) - 1)/(exp(-a) - 1)) + log((exp(-V*a) - 1)/(exp(-a) - 1)) + log((exp(-Z*a) - 1)/(exp(-a) - 1)))*(exp(-a) - 1) + 1)/a'</span>;</div><div class="line">d=S3;</div><div class="line">v=[U V Z M];</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></div><div class="line">    d=diff(d,v(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line">Frank=d</div></pre></td></tr></table></figure>
<p>求得结果</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Gum =</div><div class="line">(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">4.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).^<span class="number">2.</span>*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*(<span class="number">2.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">2</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*(<span class="number">1.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (<span class="number">2.</span>*a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z)</div><div class="line"></div><div class="line">Clay =</div><div class="line">(a.^<span class="number">3.</span>*(<span class="number">1.</span>/a + <span class="number">1</span>).*(<span class="number">1.</span>/a + <span class="number">2</span>).*(<span class="number">1.</span>/a + <span class="number">3</span>))./(M.^(a + <span class="number">1</span>).*U.^(a + <span class="number">1</span>).*V.^(a + <span class="number">1</span>).*Z.^(a + <span class="number">1</span>).*(<span class="number">1.</span>/M.^a + <span class="number">1.</span>/U.^a + <span class="number">1.</span>/V.^a + <span class="number">1.</span>/Z.^a - <span class="number">3</span>).^(<span class="number">1.</span>/a + <span class="number">4</span>))</div><div class="line"></div><div class="line">Frank =</div><div class="line">(<span class="number">7.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">2</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">2.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) + (<span class="number">6.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">4</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">4.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (<span class="number">12.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">3</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">3.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>))</div></pre></td></tr></table></figure>
<p><em>注：以上是经过修正后能直接进行矩阵计算的结果，修正方法为将原结果中的`</em>,^,/<code>转换为</code>.<em>,.^,./`</em></p>
<h1 id="多维Copula参数估计"><a href="#多维Copula参数估计" class="headerlink" title="多维Copula参数估计"></a>多维Copula参数估计</h1><p>MATLAB自带的函数不支持多维的Archimdean-Copula的参数估计与函数计算，因此需要自己写出极大似然估计算法。由于MATLAB自带的极大似然估计函数<code>mle</code>不支持多维变量的输入，因此先计算出对数似然函数，然后利用非线性优化函数<code>fmincon</code>求解对应的参数值</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">para</span>=<span class="title">copula4fit</span><span class="params">(name,data)</span></span></div><div class="line">options = optimset(<span class="string">'Algorithm'</span>,<span class="string">'interior-point'</span>,<span class="string">'MaxFunEvals'</span>,<span class="number">1000</span>,<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'TolCon'</span>,<span class="number">10</span>^<span class="number">-12</span>,<span class="string">'TolFun'</span>,<span class="number">10</span>^<span class="number">-4</span>,<span class="string">'TolX'</span>,<span class="number">10</span>^<span class="number">-6</span>);</div><div class="line"><span class="keyword">switch</span> name</div><div class="line">    <span class="keyword">case</span> <span class="string">'Gumbel'</span></div><div class="line"></div><div class="line">        lower = <span class="number">1.1</span>;</div><div class="line">        a = <span class="number">2</span>;</div><div class="line">        [ para LL6] = fmincon(@mlepdffun_G,a,[],[],[],[],lower,[],[],options);</div><div class="line">    <span class="keyword">case</span> <span class="string">'Clayton'</span></div><div class="line">        lower = <span class="number">0.0001</span>;</div><div class="line">        a = <span class="number">1</span>;</div><div class="line">        [ para LL2] = fmincon(@mlepdffun_C,a,[],[],[],[],lower,[],[],options);</div><div class="line">    <span class="keyword">case</span> <span class="string">'Frank'</span></div><div class="line">        theta0 = <span class="number">1</span>;</div><div class="line">        [ para LL5] = fmincon(@mlepdffun_F,theta0,[],[],[],[],[],[],[],options);</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">mlepdffun_G</span><span class="params">(a)</span></span></div><div class="line">    U=data(:,<span class="number">1</span>);</div><div class="line">    V=data(:,<span class="number">2</span>);</div><div class="line">    Z=data(:,<span class="number">3</span>);</div><div class="line">    M=data(:,<span class="number">4</span>);</div><div class="line">    N=<span class="built_in">numel</span>(U);</div><div class="line">    Y=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U));</div><div class="line"></div><div class="line">    <span class="keyword">parfor</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        Y(<span class="built_in">i</span>)=<span class="built_in">log</span>((<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">4</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) + (a^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)^<span class="number">2</span>*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) + (a^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">2</span>/a - <span class="number">2</span>)*(<span class="number">2</span>/a - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) - (<span class="number">2</span>*a*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">2</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) - (<span class="number">2</span>*a*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">2</span>/a - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">3</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) - (a^<span class="number">3</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">2</span>)*(<span class="number">1</span>/a - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) + (<span class="number">2</span>*a^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">3</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    y=-sum(Y);</div><div class="line"></div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">mlepdffun_C</span><span class="params">(a)</span></span></div><div class="line">    U=data(:,<span class="number">1</span>);</div><div class="line">    V=data(:,<span class="number">2</span>);</div><div class="line">    Z=data(:,<span class="number">3</span>);</div><div class="line">    M=data(:,<span class="number">4</span>);</div><div class="line">    N=<span class="built_in">numel</span>(U);</div><div class="line">    Y=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U));</div><div class="line">    <span class="keyword">parfor</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        Y(<span class="built_in">i</span>)=<span class="built_in">log</span>((a^<span class="number">3</span>*(<span class="number">1</span>/a + <span class="number">1</span>)*(<span class="number">1</span>/a + <span class="number">2</span>)*(<span class="number">1</span>/a + <span class="number">3</span>))/(M(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*U(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*V(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*Z(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*(<span class="number">1</span>/M(<span class="built_in">i</span>)^a + <span class="number">1</span>/U(<span class="built_in">i</span>)^a + <span class="number">1</span>/V(<span class="built_in">i</span>)^a + <span class="number">1</span>/Z(<span class="built_in">i</span>)^a - <span class="number">3</span>)^(<span class="number">1</span>/a + <span class="number">4</span>)));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    y=-sum(Y);</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">mlepdffun_F</span><span class="params">(a)</span></span></div><div class="line">    U=data(:,<span class="number">1</span>);</div><div class="line">    V=data(:,<span class="number">2</span>);</div><div class="line">    Z=data(:,<span class="number">3</span>);</div><div class="line">    M=data(:,<span class="number">4</span>);</div><div class="line">    N=<span class="built_in">numel</span>(U);</div><div class="line">    Y=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U));</div><div class="line">    <span class="keyword">parfor</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        Y(<span class="built_in">i</span>)=<span class="built_in">log</span>((<span class="number">7</span>*a^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)^<span class="number">2</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">2</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)) + (<span class="number">6</span>*a^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)^<span class="number">4</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">4</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)) - (a^<span class="number">3</span>*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)) - (<span class="number">12</span>*a^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)^<span class="number">3</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">3</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    y=-sum(Y);</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h1 id="多维Copula函数值计算"><a href="#多维Copula函数值计算" class="headerlink" title="多维Copula函数值计算"></a>多维Copula函数值计算</h1><h2 id="多维分布函数"><a href="#多维分布函数" class="headerlink" title="多维分布函数"></a>多维分布函数</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">c</span>=<span class="title">copula4cdf</span><span class="params">(name,data,a)</span></span></div><div class="line">U=data(:,<span class="number">1</span>);</div><div class="line">V=data(:,<span class="number">2</span>);</div><div class="line">Z=data(:,<span class="number">3</span>);</div><div class="line">M=data(:,<span class="number">4</span>);</div><div class="line"><span class="keyword">switch</span> name</div><div class="line">    <span class="keyword">case</span> <span class="string">'Gumbel'</span></div><div class="line">        c=<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U)).^a+(-<span class="built_in">log</span>(V)).^a+(-<span class="built_in">log</span>(Z)).^a+(-<span class="built_in">log</span>(M)).^a).^(<span class="number">1.</span>/a));</div><div class="line">    <span class="keyword">case</span> <span class="string">'Clayton'</span></div><div class="line">        c=(U.^(-a)+V.^(-a)+Z.^(-a)+M.^(-a)<span class="number">-3</span>).^(<span class="number">-1.</span>/a);</div><div class="line">    <span class="keyword">case</span> <span class="string">'Frank'</span></div><div class="line">        c=-<span class="built_in">log</span>(<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)./a;</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="多维密度函数"><a href="#多维密度函数" class="headerlink" title="多维密度函数"></a>多维密度函数</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">p</span>=<span class="title">copula4pdf</span><span class="params">(name,data,a)</span></span></div><div class="line">U=data(:,<span class="number">1</span>);</div><div class="line">V=data(:,<span class="number">2</span>);</div><div class="line">Z=data(:,<span class="number">3</span>);</div><div class="line">M=data(:,<span class="number">4</span>);</div><div class="line"><span class="keyword">switch</span> name</div><div class="line">    <span class="keyword">case</span> <span class="string">'Gumbel'</span></div><div class="line">        p=(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">4.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).^<span class="number">2.</span>*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*(<span class="number">2.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">2</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*(<span class="number">1.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (<span class="number">2.</span>*a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z);</div><div class="line">    <span class="keyword">case</span> <span class="string">'Clayton'</span></div><div class="line">        p=(a.^<span class="number">3.</span>*(<span class="number">1.</span>/a + <span class="number">1</span>).*(<span class="number">1.</span>/a + <span class="number">2</span>).*(<span class="number">1.</span>/a + <span class="number">3</span>))./(M.^(a + <span class="number">1</span>).*U.^(a + <span class="number">1</span>).*V.^(a + <span class="number">1</span>).*Z.^(a + <span class="number">1</span>).*(<span class="number">1.</span>/M.^a + <span class="number">1.</span>/U.^a + <span class="number">1.</span>/V.^a + <span class="number">1.</span>/Z.^a - <span class="number">3</span>).^(<span class="number">1.</span>/a + <span class="number">4</span>));</div><div class="line">    <span class="keyword">case</span> <span class="string">'Frank'</span></div><div class="line">        p=(<span class="number">7.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">2</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">2.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) + (<span class="number">6.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">4</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">4.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (<span class="number">12.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">3</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">3.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>));</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h1 id="多维单一Copula建模"><a href="#多维单一Copula建模" class="headerlink" title="多维单一Copula建模"></a>多维单一Copula建模</h1><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">rho_n=copulafit(<span class="string">'Gaussian'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">[rho_t,df]=copulafit(<span class="string">'t'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">rho_g=copula4fit(<span class="string">'Gumbel'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">rho_c=copula4fit(<span class="string">'Clayton'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">rho_f=copula4fit(<span class="string">'Frank'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">[fx,xsort]=ecdf(qw);</div><div class="line">[fy,ysort]=ecdf(bdq);</div><div class="line">[fz,zsort]=ecdf(ghk);</div><div class="line">[fn,nsort]=ecdf(cm);</div><div class="line">U1=spline(xsort(<span class="number">2</span>:<span class="keyword">end</span>),fx(<span class="number">2</span>:<span class="keyword">end</span>),qw);</div><div class="line">U2=spline(ysort(<span class="number">2</span>:<span class="keyword">end</span>),fy(<span class="number">2</span>:<span class="keyword">end</span>),bdq);</div><div class="line">U3=spline(zsort(<span class="number">2</span>:<span class="keyword">end</span>),fz(<span class="number">2</span>:<span class="keyword">end</span>),ghk);</div><div class="line">U4=spline(nsort(<span class="number">2</span>:<span class="keyword">end</span>),fn(<span class="number">2</span>:<span class="keyword">end</span>),cm);</div><div class="line">C=@(u1,u2,u3,u4)mean((U1&lt;=u1).*(U2&lt;=u2).*(U3&lt;=u3).*(U4&lt;=u4));</div><div class="line">CU=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U1(:)));</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(U1)</div><div class="line">    CU(<span class="built_in">i</span>)=C(U1(<span class="built_in">i</span>),U2(<span class="built_in">i</span>),U3(<span class="built_in">i</span>),U4(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line">C_n=copulacdf(<span class="string">'Gaussian'</span>,[QWC,BDQC,GHKC,CMC],rho_n);</div><div class="line">C_t=copulacdf(<span class="string">'t'</span>,[QWC,BDQC,GHKC,CMC],rho_t,df);</div><div class="line">C_g=copula4cdf(<span class="string">'Gumbel'</span>,[QWC,BDQC,GHKC,CMC],rho_g);</div><div class="line">C_c=copula4cdf(<span class="string">'Clayton'</span>,[QWC,BDQC,GHKC,CMC],rho_c);</div><div class="line">C_f=copula4cdf(<span class="string">'Frank'</span>,[QWC,BDQC,GHKC,CMC],rho_f);</div><div class="line"></div><div class="line">d_n=(CU-C_n)'*(CU-C_n);</div><div class="line">d_t=(CU-C_t)'*(CU-C_t);</div><div class="line">d_g=(CU-C_g)'*(CU-C_g);</div><div class="line">d_c=(CU-C_c)'*(CU-C_c);</div><div class="line">d_f=(CU-C_f)'*(CU-C_f);</div></pre></td></tr></table></figure>
<h2 id="结果及评价"><a href="#结果及评价" class="headerlink" title="结果及评价"></a>结果及评价</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">rho_n =</div><div class="line"></div><div class="line">    <span class="number">1.0000</span>    <span class="number">0.6339</span>    <span class="number">0.5346</span>    <span class="number">0.6108</span></div><div class="line">    <span class="number">0.6339</span>    <span class="number">1.0000</span>    <span class="number">0.8092</span>    <span class="number">0.3639</span></div><div class="line">    <span class="number">0.5346</span>    <span class="number">0.8092</span>    <span class="number">1.0000</span>    <span class="number">0.3028</span></div><div class="line">    <span class="number">0.6108</span>    <span class="number">0.3639</span>    <span class="number">0.3028</span>    <span class="number">1.0000</span></div><div class="line"></div><div class="line">rho_t =</div><div class="line"></div><div class="line">    <span class="number">1.0000</span>    <span class="number">0.6441</span>    <span class="number">0.5591</span>    <span class="number">0.6179</span></div><div class="line">    <span class="number">0.6441</span>    <span class="number">1.0000</span>    <span class="number">0.8427</span>    <span class="number">0.3769</span></div><div class="line">    <span class="number">0.5591</span>    <span class="number">0.8427</span>    <span class="number">1.0000</span>    <span class="number">0.3204</span></div><div class="line">    <span class="number">0.6179</span>    <span class="number">0.3769</span>    <span class="number">0.3204</span>    <span class="number">1.0000</span></div><div class="line"></div><div class="line">rho_g =</div><div class="line"></div><div class="line">    <span class="number">1.5298</span></div><div class="line"></div><div class="line">rho_c =</div><div class="line"></div><div class="line">    <span class="number">0.4995</span></div><div class="line"></div><div class="line">rho_f =</div><div class="line"></div><div class="line">    <span class="number">3.5044</span></div></pre></td></tr></table></figure>
<h2 id="评价"><a href="#评价" class="headerlink" title="评价"></a>评价</h2><p>欧式距离</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">d_n =</div><div class="line"></div><div class="line">   <span class="number">11.0717</span></div><div class="line"></div><div class="line"></div><div class="line">d_t =</div><div class="line"></div><div class="line">    <span class="number">7.0748</span></div><div class="line"></div><div class="line"></div><div class="line">d_g =</div><div class="line"></div><div class="line">   <span class="number">48.8770</span></div><div class="line"></div><div class="line"></div><div class="line">d_c =</div><div class="line"></div><div class="line">  <span class="number">258.5072</span></div><div class="line"></div><div class="line"></div><div class="line">d_f =</div><div class="line"></div><div class="line">   <span class="number">48.3227</span></div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>欧氏距离</th>
<th>$d_n$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>计算值</td>
<td>11.0717</td>
<td>7.0748</td>
<td>48.8770</td>
<td>258.5072</td>
<td>48.3227</td>
</tr>
</tbody>
</table>
<p>我认为在对于多维变量的处理上，由于Archimedean-Copula函数仅仅通过一个变量来描述其多位相关性并不是很合理，因而通过一个结构相依矩阵来表述相关性的t-Copula与Normal-Copula就与源数据拟合方面表现的就更好</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;两种Copula&quot;&gt;&lt;a href=&quot;#两种Copula&quot; class=&quot;headerlink&quot; title=&quot;两种Copula&quot;&gt;&lt;/a&gt;两种Copula&lt;/h1&gt;&lt;p&gt;Copula函数主要分为两种，一种为椭圆族Copula，一种为Archimedean-Copula。其中椭圆族Copula直接给出了其多维形式，具体详见&lt;a href=&quot;http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;amp;filter=sc_long_sign&amp;amp;tn=SE_xueshusource_2kduw22v&amp;amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;amp;ie=utf-8&amp;amp;sc_us=15886197312218780659&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《MATLAB统计分析与应用：40个案例分析》&lt;/a&gt;P189。而Archimedean-Copula的函数由于各种生成元的不同导致只给出了常用的二元形式。多维形式需要手动推导。&lt;/p&gt;
&lt;h1 id=&quot;对多维Archimedean-Copula推导&quot;&gt;&lt;a href=&quot;#对多维Archimedean-Copula推导&quot; class=&quot;headerlink&quot; title=&quot;对多维Archimedean-Copula推导&quot;&gt;&lt;/a&gt;对多维Archimedean-Copula推导&lt;/h1&gt;&lt;h2 id=&quot;对于分布函数的推导&quot;&gt;&lt;a href=&quot;#对于分布函数的推导&quot; class=&quot;headerlink&quot; title=&quot;对于分布函数的推导&quot;&gt;&lt;/a&gt;对于分布函数的推导&lt;/h2&gt;&lt;p&gt;根据&lt;a href=&quot;http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;amp;filter=sc_long_sign&amp;amp;tn=SE_xueshusource_2kduw22v&amp;amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;amp;ie=utf-8&amp;amp;sc_us=15886197312218780659&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;书中&lt;/a&gt;P190给出的生成元与基础形式，推导出各自生成元的反函数，然后将生成元带入，得到四维Copula分布函数。&lt;br&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="MATLAB" scheme="http://fatelancer.github.io/tags/MATLAB/"/>
    
      <category term="多维Copula" scheme="http://fatelancer.github.io/tags/%E5%A4%9A%E7%BB%B4Copula/"/>
    
  </entry>
  
  <entry>
    <title>阶段性总结</title>
    <link href="http://fatelancer.github.io/2017/03/29/%E9%98%B6%E6%AE%B5%E6%80%A7%E6%80%BB%E7%BB%93/"/>
    <id>http://fatelancer.github.io/2017/03/29/阶段性总结/</id>
    <published>2017-03-29T07:54:58.000Z</published>
    <updated>2018-06-21T03:46:10.816Z</updated>
    
    <content type="html"><![CDATA[<h1 id="风速的随机性数学表述"><a href="#风速的随机性数学表述" class="headerlink" title="风速的随机性数学表述"></a>风速的随机性数学表述</h1><p>通过查阅文献可以得知，可以使用双参数威布尔分布来描述风速的概率分布</p>
<p>双参数威布尔函数<br>$$F_w(x)=1-exp(-({x \over c})^k)$$<br>其概率密度函数为<br>$$P(x)={k \over c} ({k \over c})^{k-1}exp(-({x \over c})^k)$$<br>式中 $k$ 为形状参数，无量纲； $c$ 为尺度参数，反映风电场的平均风速，单位为 $m/s$ 。</p>
<h2 id="程序验证随机性"><a href="#程序验证随机性" class="headerlink" title="程序验证随机性"></a>程序验证随机性</h2><p>通过将风速数据的频数分布图与根据风速数据拟合的威布尔分布概率密度函数曲线进行对比可以发现，使用双参数威布尔分布去拟合风速数据是完全合理的。下图中红色的曲线为威布尔分布概率密度函数曲线，蓝色部分为风速的频率分布直方图。</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/4in1_1.jpg" alt="图1 风速频数分布直方图"></p>
<h2 id="场间风速的关系"><a href="#场间风速的关系" class="headerlink" title="场间风速的关系"></a>场间风速的关系</h2><p>通过对拟合后的风速数据的分布函数绘制频数分布直方图可以简单的看出场间风速的一些关系。下图为桥湾（1）、北大桥（2）、干河口（3）以及昌马（4）四个风电场两两之间的风速频数分布直方图</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/6in1.jpg" alt="图2 场间风速频数直方图"></p>
<p>对于以上的关系可以通过地理以及气象等知识进行解释。下图是四个风电场的地理位置关系。<br><img src="http://oag5ozkgs.bkt.clouddn.com/%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE.jpg" alt="Alt text"></p>
<ul>
<li>桥湾（1）与北大桥（2）间地理位置是东西平行，在东西风向盛行的酒泉地区两者风况有较大的相似，所以线性相关性较大，如图2-1</li>
<li>干河口（3）与桥湾（1）的地理位置虽然接近东西平行，但是距离较远，因此线性相关性较低，如图2-2</li>
<li>桥湾（1）与昌马（4）间地理位置接近南北垂直，但是由于两者间距离较近，所以线性相关性也较为明显，如图2-3</li>
<li>干河口（3）与北大桥（2）的地理位置接近东西平行的，在东西风向盛行的酒泉地区两者风况有较大的相似。如图2-4可以看出存在较大的线性相关性。</li>
<li>昌马（4）与北大桥（2）的距离较远，因此线性相关性较差，如图2-5</li>
<li>干河口（3）与昌马（4）的距离最远，因此线性相关性也最差，如图2-6<a id="more"></a>
<h1 id="对场间风速进行建模"><a href="#对场间风速进行建模" class="headerlink" title="对场间风速进行建模"></a>对场间风速进行建模</h1></li>
</ul>
<h2 id="通过单个copula函数对场间风速进行建模"><a href="#通过单个copula函数对场间风速进行建模" class="headerlink" title="通过单个copula函数对场间风速进行建模"></a>通过单个copula函数对场间风速进行建模</h2><p><strong>参数估计结果</strong></p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$\rho_{Norm}$</th>
<th>$\rho_t$</th>
<th>$k$</th>
<th>$\theta_G$</th>
<th>$\theta_C$</th>
<th>$\theta_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾与北大桥</td>
<td>0.6339</td>
<td>0.6386</td>
<td>9.1619</td>
<td>1.8533</td>
<td>0.6913</td>
<td>5.0402</td>
</tr>
<tr>
<td>桥湾与干河口</td>
<td>0.5346</td>
<td>0.5364</td>
<td>9.7829</td>
<td>1.6350</td>
<td>0.4847</td>
<td>3.8853</td>
</tr>
<tr>
<td>桥湾与昌马</td>
<td>0.6108</td>
<td>0.6169</td>
<td>10.4474</td>
<td>1.7697</td>
<td>0.6530</td>
<td>4.8459</td>
</tr>
<tr>
<td>北大桥与干河口</td>
<td>0.8092</td>
<td>0.8479</td>
<td>2.7192</td>
<td>2.9270</td>
<td>1.4685</td>
<td>9.8959</td>
</tr>
<tr>
<td>北大桥与昌马</td>
<td>0.3639</td>
<td>0.3630</td>
<td>33.9054</td>
<td>1.3098</td>
<td>0.3072</td>
<td>2.3697</td>
</tr>
<tr>
<td>干河口与昌马</td>
<td>0.3028</td>
<td>0.3026</td>
<td>21.9903</td>
<td>1.2628</td>
<td>0.2141</td>
<td>1.9736</td>
</tr>
</tbody>
</table>
<p><strong>对建模结果进行评价</strong></p>
<p>与根据风速数据建立的经验Copula函数进行对比</p>
<p>使用Q-Q图进行校验（非定量分析）</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/2in1_1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/3in1_1.jpg" alt="qq图3"></p>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="external">Q-Q图的判定原则</a>可知，各类Copula函数差别很明显，其 中Gumbel-Copula，Frank-Copula，t-Copula函数曲线均较为接近45°曲线，拟合效果相对较好。以下采用统计法</p>
<p>使用K-S校验进行定量分析</p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>0.0406</td>
<td>0.0395</td>
<td>0.0302</td>
<td>0.0520</td>
<td>0.0364</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>0.0260</td>
<td>0.0219</td>
<td>0.0156</td>
<td>0.0489</td>
<td>0.0208</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>0.0260</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0499</td>
<td>0.0239</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>0.0239</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0385</td>
<td>0.0166</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>0.0208</td>
<td>0.0208</td>
<td>0.0146</td>
<td>0.0385</td>
<td>0.0156</td>
</tr>
</tbody>
</table>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="external">K-S检验法的判定原则</a>可知，在六种不同的风电场组合中，Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数的 $KS$ 统计值相对较小，而Normal-Copula，Clayton-Copula的统计值相对较大</p>
<p>秩相关性测度</p>
<table>
<thead>
<tr>
<th>数据来源</th>
<th>Kendall秩相关系数 $\tau$</th>
<th>Spearman秩相关系数 $\rho_s$</th>
</tr>
</thead>
<tbody>
<tr>
<td>原始观测数据</td>
<td>0.4816</td>
<td>0.6628</td>
</tr>
<tr>
<td>Normal-Copula</td>
<td>0.4371</td>
<td>0.6159</td>
</tr>
<tr>
<td>t-Copula</td>
<td>0.4410</td>
<td>0.6151</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>0.4604</td>
<td>0.6366</td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.2569</td>
<td>0.3751</td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>0.4592</td>
<td>0.6465</td>
</tr>
</tbody>
</table>
<p>通过与经验函数的Kendall秩相关系数，Spearman秩相关系数进行对比可以发现Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与原始数据保持着良好的秩相关性，而Normal-Copula，Clayton-Copula的秩相关性较差。</p>
<p>使用欧式距离进行分析</p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>2.8924</td>
<td>2.8209</td>
<td>1.3953</td>
<td>9.1763</td>
<td>2.4125</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>2.7285</td>
<td>2.6970</td>
<td>1.1862</td>
<td>8.2528</td>
<td>2.2180</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>2.3450</td>
<td>2.2558</td>
<td>1.3469</td>
<td>8.3662</td>
<td>1.8227</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>1.7187</td>
<td>1.7470</td>
<td>1.5995</td>
<td>5.0238</td>
<td>1.3692</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>1.8369</td>
<td>1.8561</td>
<td>1.3731</td>
<td>4.8842</td>
<td>1.4301</td>
</tr>
</tbody>
</table>
<p>可以看到在以上6种风电场组合中Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与经验Copula函数的欧氏距离较小，而Normal-Copula，Clayton-Copula与经验函数的欧氏距离较大</p>
<h2 id="使用多个Copula函数进行混合对风速进行建模"><a href="#使用多个Copula函数进行混合对风速进行建模" class="headerlink" title="使用多个Copula函数进行混合对风速进行建模"></a>使用多个Copula函数进行混合对风速进行建模</h2><p>通过查阅文献可以知道，多个Copula函数通过加权相加后仍然是Copula函数</p>
<p>由于Copula函数并非线性函数，简单的通过单个Copula函数拟合效果来选择使用哪几个Copula函数来进行混合可能不够准确，可能会存在两个单一表现并不好的Copula函数混合后结果却比较好的情况。</p>
<p>因此，将论文中的三个Copula混合模型拓展至五个常用Copula进行混合建模。</p>
<p>由于混合时运算量过大，因此选取干河口与北大桥的场间风速为例进行建模</p>
<p><strong>三个Copula混合的参数结果</strong></p>
<table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.1244</td>
<td>0.0822</td>
<td>3</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>4.1127</td>
<td>0.7495</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>6.5931</td>
<td>0.1683</td>
<td></td>
</tr>
</tbody>
</table>
<p>即<br>$$<br>C(u,v;a)=0.7495C<em>{Gumbel}(u,v;4.1127)+0.1683C</em>{Frank}(u,v;6.5931)<br>+0.0822C_t(u,v;0.1244,3)$$</p>
<p><strong>五个Copula混合的参数结果</strong></p>
<table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.9678</td>
<td>0.1075</td>
<td>2.7192</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>3.7781</td>
<td>0.5502</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>9.8959</td>
<td>0.1946</td>
<td></td>
</tr>
<tr>
<td>Norm-Copula</td>
<td>0.9250</td>
<td>0.0613</td>
<td></td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.0049</td>
<td>0.0864</td>
<td></td>
</tr>
</tbody>
</table>
<p>即<br>$$<br>\begin{aligned}<br>C(u,v;a)= &amp; 0.1075C_t(u,v;0.9678,2.7192)+0.0613C<em>N(u,v;0.9250)<br>+\<br>&amp; 0.5502C</em>{Gumbel}(u,v;3.7781)+0.1946C<em>{Frank}(u,v;9.8959)+0.0864C</em>{Clayton}(u,v;0.0049)<br>\end{aligned}<br> $$</p>
<p><strong>模型评价</strong></p>
<p>Q-Q图校验</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula.jpg" alt="3个Copula函数混合Q-Q图"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula_new.jpg" alt="5个Copula函数混合Q-Q图"></p>
<p>由于不是定量分析，对比效果不明显，以下采用定量分析，但是可以对比单个Copula时的QQ图<br><img src="http://oag5ozkgs.bkt.clouddn.com/im1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/im2.jpg" alt="qq图3"></p>
<p>可以明显看出混合Copula的效果比单个Copula效果要好。</p>
<p>K-S检验</p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
<th>$K_{3M}$</th>
<th>$K_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
<td>0.0271</td>
<td>0.0260</td>
</tr>
</tbody>
</table>
<p>可以看出5个Copula混合时的模型较3个Copula混合时的效果更好</p>
<p>欧氏距离</p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
<th>$d_{3M}$</th>
<th>$d_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
<td>1.3220</td>
<td>1.2730</td>
</tr>
</tbody>
</table>
<p>从欧氏距离上也能够得到与KS检验中同样的结果</p>
<h2 id="使用多元Copula进行4维风电场间风速建模"><a href="#使用多元Copula进行4维风电场间风速建模" class="headerlink" title="使用多元Copula进行4维风电场间风速建模"></a>使用多元Copula进行4维风电场间风速建模</h2><p><strong>使用单一多维Copula建模</strong></p>
<p>分别得到了Normal-Copula与t-Copula的多元风速相依结构矩阵</p>
<p>$$\rho_n=\begin{bmatrix}<br>1 &amp; 0.6339 &amp; 0.5346 &amp; 0.6108\<br>0.6339 &amp; 1 &amp; 0.8092 &amp; 0.3639\<br>0.5346 &amp; 0.8092 &amp; 1 &amp; 0.3028\<br>0.6108 &amp; 0.3639 &amp; 0.3028 &amp; 1<br>\end{bmatrix}$$</p>
<p>$$\rho_t=\begin{bmatrix}<br>1 &amp;0.6441  &amp;0.5591  &amp;0.6179 \<br>0.6441 &amp;1  &amp;0.8527  &amp;0.3769 \<br>0.5591 &amp;0.8527  &amp;1  &amp;0.3204 \<br>0.6179 &amp;0.3769  &amp;0.3204  &amp;1<br>\end{bmatrix}$$</p>
<p>$$k_t=7.8639$$</p>
<p><strong>模型评价</strong></p>
<p>K-S校验</p>
<p>$$k_G=0.0281\k_t=0.0401$$</p>
<p>欧氏距离</p>
<p>$$d_G=11.0717\d_t=7.0748$$</p>
<p>后来通过查阅文献得知KS校验不能在多维问题中使用，多维问题主要使用欧氏距离进行分析</p>
<p><strong>使用多维混合Copula两种思路</strong></p>
<ul>
<li><p>使用多维的Copula直接进行混合<br>问题： Archimedean Copula族的Copula函数需要手动计算多维形式，并手动编程通过MLE方法估算函数参数，MATLAB自带的fit函数仅支持二元的Archimedean Copula参数估计。并且在计算4维t-Copula概率密度函数时的计算量非常大，单句指令需要运算三个小时，当嵌套至EM算法的迭代中时将耗费更多的时间，预计计算时间将达到十几天。</p>
</li>
<li><p>通过pair-Copula将多个二维Copula函数进行合并，直至出现四维Copula<br>问题：暂时没有找到对于pair-Copula构建过程较为详细的文献，还处在摸索阶段</p>
</li>
</ul>
<h1 id="光伏的随机性表达"><a href="#光伏的随机性表达" class="headerlink" title="光伏的随机性表达"></a>光伏的随机性表达</h1><h2 id="通过核密度估计来表达长时间内的光伏照射强度"><a href="#通过核密度估计来表达长时间内的光伏照射强度" class="headerlink" title="通过核密度估计来表达长时间内的光伏照射强度"></a>通过核密度估计来表达长时间内的光伏照射强度</h2><p>定义<br>  :   设$x_1,x_2,…,x_n$为随机变量$x$的样本，令随机变量$x$的概率密度函数为$f(x)$，则 $f(x)$ 的核密度估计为：</p>
<p>  $$f<em>h(x)={1 \over nh}{\displaystyle \sum</em>{j=1}^n{K({x-x<em>j \over h})}}={1 \over n}{\displaystyle \sum</em>{j=1}^n{K_h(x-x_j)}}$$</p>
<p>  其中$n$为样本容量，$h$ 为平滑系数，$K(·)$ 为核函数</p>
<p><strong>结果</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1.jpg" alt="频率分布"></p>
<p>可以看到在长时间尺度上（上例为半年）核密度估计的拟合程度很高，但是在稍短的时间尺度上（一个月）则效果较差，如下图</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_2.jpg" alt=""></p>
<p>该种情况可以通过<a href="http://blog.csdn.net/matlab_matlab/article/details/56286868" target="_blank" rel="external">调整窗的宽度来提高拟合优度</a>，如下图为窗宽度为2.5时重新拟合一个月的光伏强度结果</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_3.jpg" alt="当width=2.5时拟合结果"></p>
<h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><p>所有代码详见<a href="https://github.com/fatelancer/Copula_Wind" target="_blank" rel="external">Copula_Wind</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;风速的随机性数学表述&quot;&gt;&lt;a href=&quot;#风速的随机性数学表述&quot; class=&quot;headerlink&quot; title=&quot;风速的随机性数学表述&quot;&gt;&lt;/a&gt;风速的随机性数学表述&lt;/h1&gt;&lt;p&gt;通过查阅文献可以得知，可以使用双参数威布尔分布来描述风速的概率分布&lt;/p&gt;
&lt;p&gt;双参数威布尔函数&lt;br&gt;$$F_w(x)=1-exp(-({x \over c})^k)$$&lt;br&gt;其概率密度函数为&lt;br&gt;$$P(x)={k \over c} ({k \over c})^{k-1}exp(-({x \over c})^k)$$&lt;br&gt;式中 $k$ 为形状参数，无量纲； $c$ 为尺度参数，反映风电场的平均风速，单位为 $m/s$ 。&lt;/p&gt;
&lt;h2 id=&quot;程序验证随机性&quot;&gt;&lt;a href=&quot;#程序验证随机性&quot; class=&quot;headerlink&quot; title=&quot;程序验证随机性&quot;&gt;&lt;/a&gt;程序验证随机性&lt;/h2&gt;&lt;p&gt;通过将风速数据的频数分布图与根据风速数据拟合的威布尔分布概率密度函数曲线进行对比可以发现，使用双参数威布尔分布去拟合风速数据是完全合理的。下图中红色的曲线为威布尔分布概率密度函数曲线，蓝色部分为风速的频率分布直方图。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://oag5ozkgs.bkt.clouddn.com/4in1_1.jpg&quot; alt=&quot;图1 风速频数分布直方图&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;场间风速的关系&quot;&gt;&lt;a href=&quot;#场间风速的关系&quot; class=&quot;headerlink&quot; title=&quot;场间风速的关系&quot;&gt;&lt;/a&gt;场间风速的关系&lt;/h2&gt;&lt;p&gt;通过对拟合后的风速数据的分布函数绘制频数分布直方图可以简单的看出场间风速的一些关系。下图为桥湾（1）、北大桥（2）、干河口（3）以及昌马（4）四个风电场两两之间的风速频数分布直方图&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://oag5ozkgs.bkt.clouddn.com/6in1.jpg&quot; alt=&quot;图2 场间风速频数直方图&quot;&gt;&lt;/p&gt;
&lt;p&gt;对于以上的关系可以通过地理以及气象等知识进行解释。下图是四个风电场的地理位置关系。&lt;br&gt;&lt;img src=&quot;http://oag5ozkgs.bkt.clouddn.com/%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE.jpg&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;桥湾（1）与北大桥（2）间地理位置是东西平行，在东西风向盛行的酒泉地区两者风况有较大的相似，所以线性相关性较大，如图2-1&lt;/li&gt;
&lt;li&gt;干河口（3）与桥湾（1）的地理位置虽然接近东西平行，但是距离较远，因此线性相关性较低，如图2-2&lt;/li&gt;
&lt;li&gt;桥湾（1）与昌马（4）间地理位置接近南北垂直，但是由于两者间距离较近，所以线性相关性也较为明显，如图2-3&lt;/li&gt;
&lt;li&gt;干河口（3）与北大桥（2）的地理位置接近东西平行的，在东西风向盛行的酒泉地区两者风况有较大的相似。如图2-4可以看出存在较大的线性相关性。&lt;/li&gt;
&lt;li&gt;昌马（4）与北大桥（2）的距离较远，因此线性相关性较差，如图2-5&lt;/li&gt;
&lt;li&gt;干河口（3）与昌马（4）的距离最远，因此线性相关性也最差，如图2-6
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="Copula" scheme="http://fatelancer.github.io/tags/Copula/"/>
    
      <category term="风速建模" scheme="http://fatelancer.github.io/tags/%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1/"/>
    
  </entry>
  
  <entry>
    <title>混合Copula建模修正——更多Copula函数的加入</title>
    <link href="http://fatelancer.github.io/2017/03/23/%E6%B7%B7%E5%90%88Copula%E5%BB%BA%E6%A8%A1%E4%BF%AE%E6%AD%A3/"/>
    <id>http://fatelancer.github.io/2017/03/23/混合Copula建模修正/</id>
    <published>2017-03-23T05:46:07.000Z</published>
    <updated>2018-06-21T03:46:13.439Z</updated>
    
    <content type="html"><![CDATA[<h1 id="修正的原因"><a href="#修正的原因" class="headerlink" title="修正的原因"></a>修正的原因</h1><p>由于Copula函数并非线性函数，简单的通过单个Copula函数拟合效果来选择使用哪几个Copula函数来进行混合可能不够准确，可能会存在两个单一表现并不好的Copula函数混合后结果却比较好的情况。</p>
<p>因此，将原来的混合Copula模型拓展至五个常用Copula进行混合建模。</p>
<h1 id="修正后的代码"><a href="#修正后的代码" class="headerlink" title="修正后的代码"></a>修正后的代码</h1><h2 id="EM算法主体部分"><a href="#EM算法主体部分" class="headerlink" title="EM算法主体部分"></a>EM算法主体部分</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line">U=GHKC;</div><div class="line">V=BDQC;</div><div class="line"><span class="comment">% 初始化</span></div><div class="line">S=<span class="number">5</span>;</div><div class="line">th=<span class="number">0.01</span>;</div><div class="line">omega=[<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>];</div><div class="line">[a,nuhat]=copulafit(<span class="string">'t'</span>,[U,V]);</div><div class="line">a2=copulafit(<span class="string">'Gumbel'</span>,[U,V]);</div><div class="line">a3=copulafit(<span class="string">'Frank'</span>,[U,V]);</div><div class="line">a4=copulafit(<span class="string">'Gaussian'</span>,[U,V]);</div><div class="line">a5=copulafit(<span class="string">'Clayton'</span>,[U,V]);</div><div class="line">theta=[a(<span class="number">1</span>,<span class="number">2</span>),a2,a3,a4(<span class="number">1</span>,<span class="number">2</span>),a5];</div><div class="line">[N,~]=<span class="built_in">size</span>(U);</div><div class="line">count=<span class="number">0</span>;</div><div class="line">tt=<span class="built_in">zeros</span>(N,<span class="number">2</span>);</div><div class="line">nn=<span class="built_in">zeros</span>(N,<span class="number">2</span>);</div><div class="line">tt(:,<span class="number">1</span>)=tinv(U(:),nuhat);</div><div class="line">tt(:,<span class="number">2</span>)=tinv(V(:),nuhat);</div><div class="line">nn(:,<span class="number">1</span>)=norminv(U(:));</div><div class="line">nn(:,<span class="number">2</span>)=norminv(V(:));</div><div class="line">t=<span class="built_in">inf</span>;</div><div class="line">COPULA=<span class="built_in">zeros</span>(N,S);</div><div class="line">list1=<span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">101</span>);</div><div class="line">list2=<span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">101</span>);</div><div class="line">puz=<span class="built_in">zeros</span>(N,S);</div><div class="line">puz1=<span class="built_in">zeros</span>(N,S);</div><div class="line">turntheta_old=<span class="built_in">zeros</span>(<span class="number">1</span>,S);</div><div class="line">tic</div><div class="line"><span class="keyword">while</span> t&gt;=th&amp;&amp;count&lt;=<span class="number">50</span>;</div><div class="line">    theta_old=theta;</div><div class="line">    omega_old=omega;</div><div class="line">    <span class="comment">%转化为无约束限制的参数</span></div><div class="line">    turntheta_old(<span class="number">1</span>)=<span class="built_in">tan</span>(<span class="built_in">pi</span>*theta_old(<span class="number">1</span>)/<span class="number">2</span>);</div><div class="line">    turntheta_old(<span class="number">2</span>)=<span class="built_in">log</span>(theta_old(<span class="number">2</span>)<span class="number">-1</span>);</div><div class="line">    turntheta_old(<span class="number">4</span>)=<span class="built_in">tan</span>(<span class="built_in">pi</span>*theta_old(<span class="number">4</span>)/<span class="number">2</span>);</div><div class="line">    turntheta_old(<span class="number">5</span>)=<span class="built_in">log</span>(theta_old(<span class="number">5</span>));</div><div class="line">    COPULA(:,<span class="number">1</span>)=copulapdf(<span class="string">'t'</span>,[U(:) V(:)],theta_old(<span class="number">1</span>),nuhat);</div><div class="line">    COPULA(:,<span class="number">2</span>)=copulapdf(<span class="string">'Gumbel'</span>,[U(:) V(:)],theta_old(<span class="number">2</span>));</div><div class="line">    COPULA(:,<span class="number">3</span>)=copulapdf(<span class="string">'Frank'</span>,[U(:) V(:)],theta_old(<span class="number">3</span>));</div><div class="line">    COPULA(:,<span class="number">4</span>)=copulapdf(<span class="string">'Gaussian'</span>,[U(:) V(:)],theta_old(<span class="number">4</span>));</div><div class="line">    COPULA(:,<span class="number">5</span>)=copulapdf(<span class="string">'Clayton'</span>,[U(:) V(:)],theta_old(<span class="number">5</span>));</div><div class="line">    puz(:,<span class="number">1</span>)=COPULA(:,<span class="number">1</span>)*omega_old(<span class="number">1</span>);</div><div class="line">    puz(:,<span class="number">2</span>)=COPULA(:,<span class="number">2</span>)*omega_old(<span class="number">2</span>);</div><div class="line">    puz(:,<span class="number">3</span>)=COPULA(:,<span class="number">3</span>)*omega_old(<span class="number">3</span>);</div><div class="line">    puz(:,<span class="number">4</span>)=COPULA(:,<span class="number">4</span>)*omega_old(<span class="number">4</span>);</div><div class="line">    puz(:,<span class="number">5</span>)=COPULA(:,<span class="number">5</span>)*omega_old(<span class="number">5</span>);</div><div class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">1</span>)=puz(<span class="built_in">i</span>,<span class="number">1</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">2</span>)=puz(<span class="built_in">i</span>,<span class="number">2</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">3</span>)=puz(<span class="built_in">i</span>,<span class="number">3</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">4</span>)=puz(<span class="built_in">i</span>,<span class="number">4</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">5</span>)=puz(<span class="built_in">i</span>,<span class="number">5</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    omega(<span class="number">1</span>)=sum(puz1(:,<span class="number">1</span>))/N;</div><div class="line">    omega(<span class="number">2</span>)=sum(puz1(:,<span class="number">2</span>))/N;</div><div class="line">    omega(<span class="number">3</span>)=sum(puz1(:,<span class="number">3</span>))/N;</div><div class="line">    omega(<span class="number">4</span>)=sum(puz1(:,<span class="number">4</span>))/N;</div><div class="line">    omega(<span class="number">5</span>)=sum(puz1(:,<span class="number">5</span>))/N;</div><div class="line">    omega</div><div class="line">    tic</div><div class="line">    [turntheta,fval,exitflag,output,grad,hessian]=updatetheta(N,U,V,turntheta_old,puz1,tt,nn,nuhat);</div><div class="line">    toc</div><div class="line">    theta(<span class="number">1</span>)=<span class="built_in">atan</span>(turntheta(<span class="number">1</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">    theta(<span class="number">2</span>)=<span class="built_in">exp</span>(turntheta(<span class="number">2</span>))+<span class="number">1</span>;</div><div class="line">    theta(<span class="number">4</span>)=<span class="built_in">atan</span>(turntheta(<span class="number">4</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">    theta(<span class="number">5</span>)=<span class="built_in">exp</span>(turntheta(<span class="number">5</span>));</div><div class="line">    theta</div><div class="line">    list1(:,count+<span class="number">1</span>)=theta;</div><div class="line">    list2(:,count+<span class="number">1</span>)=omega;</div><div class="line">    t=max([norm(theta_old(:)-theta(:));norm(omega_old(:)-omega(:))])</div><div class="line">    count=count+<span class="number">1</span></div><div class="line"><span class="keyword">end</span></div><div class="line">toc</div><div class="line">beep</div></pre></td></tr></table></figure>
<p>代码中涉及对参数进行数学变换将其参数从各自有限定义域转为$(-\infty,+ \infty)$</p>
<p>其中:</p>
<ul>
<li>t-Copula与正态Copula参数定义域为$(-1,1)$</li>
<li>Gumbel-Copula参数定义域为$(1,+\infty)$</li>
<li>Clayton-Copula参数定义域为$(0,+\infty)$</li>
<li>Frank-Copula参数定义域为$(-\infty,+\infty)$</li>
</ul>
<a id="more"></a>
<h2 id="参数更新部分"><a href="#参数更新部分" class="headerlink" title="参数更新部分"></a>参数更新部分</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="params">[turntheta,fval,exitflag,output,grad,hessian]</span>=<span class="title">updatetheta</span><span class="params">(N,U,V,theta,puz,t,n,nuhat)</span></span></div><div class="line">options=optimset(<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'MaxFunEvals'</span>,<span class="number">1000</span>,<span class="string">'TolFun'</span>,<span class="number">1e-6</span>,<span class="string">'TolX'</span>,<span class="number">1e-10</span>,<span class="string">'LargeScale'</span>,<span class="string">'on'</span>,<span class="string">'FinDiffType'</span>,<span class="string">'central'</span>,<span class="string">'HessUpdate'</span>,<span class="string">'bfgs'</span>);</div><div class="line">[turntheta,fval,exitflag,output,grad,hessian]=fminunc(@utheta,theta,options);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">utheta</span><span class="params">(theta)</span></span></div><div class="line"><span class="keyword">if</span> theta(<span class="number">3</span>)==<span class="number">0</span></div><div class="line">    theta(<span class="number">3</span>)=theta(<span class="number">3</span>)+<span class="number">0.0001</span>;  <span class="comment">%防止出现 Frank  Copula 的相依结构参数为 0</span></div><div class="line"><span class="keyword">end</span></div><div class="line">y=<span class="number">0</span>;</div><div class="line">th=<span class="built_in">eye</span>(<span class="number">2</span>);</div><div class="line">th1=<span class="built_in">eye</span>(<span class="number">2</span>);</div><div class="line">th(<span class="number">1</span>,<span class="number">2</span>)=<span class="built_in">atan</span>(theta(<span class="number">1</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">th(<span class="number">2</span>,<span class="number">1</span>)=<span class="built_in">atan</span>(theta(<span class="number">1</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">th1(<span class="number">1</span>,<span class="number">2</span>)=<span class="built_in">atan</span>(theta(<span class="number">4</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">th1(<span class="number">2</span>,<span class="number">1</span>)=<span class="built_in">atan</span>(theta(<span class="number">4</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line"><span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:N</div><div class="line"></div><div class="line">    y=y+<span class="built_in">log</span>(((det(th))^(<span class="number">-1</span>/<span class="number">2</span>))*<span class="built_in">gamma</span>((nuhat+<span class="number">2</span>)/<span class="number">2</span>)*<span class="built_in">gamma</span>(nuhat/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,:)*th^(<span class="number">-1</span>)*t(<span class="built_in">j</span>,:)'/nuhat)^(-(nuhat+<span class="number">2</span>)/<span class="number">2</span>)/((<span class="built_in">gamma</span>((nuhat+<span class="number">1</span>)/<span class="number">2</span>))^<span class="number">2</span>*((<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">1</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">2</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>))))*puz(<span class="built_in">j</span>,<span class="number">1</span>)+...</div><div class="line">        <span class="built_in">log</span>(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))^(<span class="number">1</span>/(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)))*(<span class="built_in">log</span>(U(<span class="built_in">j</span>))*<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)<span class="number">-1</span>)*(((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)))^(<span class="number">1</span>/(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))+(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)<span class="number">-1</span>)/(U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)))^(<span class="number">2</span><span class="number">-1</span>/(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))))*puz(<span class="built_in">j</span>,<span class="number">2</span>)+...</div><div class="line">        <span class="built_in">log</span>(theta(<span class="number">3</span>)*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))*<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*(U(<span class="built_in">j</span>)+V(<span class="built_in">j</span>)))/((<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))-(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*U(<span class="built_in">j</span>)))*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*V(<span class="built_in">j</span>))))^<span class="number">2</span>)*puz(<span class="built_in">j</span>,<span class="number">3</span>)+...</div><div class="line">        <span class="built_in">log</span>((det(th1))^(<span class="number">-1</span>/<span class="number">2</span>)*<span class="built_in">exp</span>(<span class="number">-1</span>/<span class="number">2</span>*n(<span class="built_in">j</span>,:)*(th1^(<span class="number">-1</span>)-<span class="built_in">eye</span>(<span class="number">2</span>))*n(<span class="built_in">j</span>,:)'))*puz(<span class="built_in">j</span>,<span class="number">4</span>)+...</div><div class="line">        <span class="built_in">log</span>((<span class="number">1</span>+<span class="built_in">exp</span>(theta(<span class="number">5</span>)))*(U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>))^(-<span class="built_in">exp</span>(theta(<span class="number">5</span>))<span class="number">-1</span>)*(U(<span class="built_in">j</span>)^(-<span class="built_in">exp</span>(theta(<span class="number">5</span>)))+V(<span class="built_in">j</span>)^(-<span class="built_in">exp</span>(theta(<span class="number">5</span>)))<span class="number">-1</span>)^(<span class="number">-2</span><span class="number">-1</span>/<span class="built_in">exp</span>(theta(<span class="number">5</span>))))*puz(<span class="built_in">j</span>,<span class="number">5</span>);</div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">y=-y;</div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h1 id="结果分析"><a href="#结果分析" class="headerlink" title="结果分析"></a>结果分析</h1><h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.9678</td>
<td>0.1075</td>
<td>2.7192</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>3.7781</td>
<td>0.5502</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>9.8959</td>
<td>0.1946</td>
<td></td>
</tr>
<tr>
<td>Norm-Copula</td>
<td>0.9250</td>
<td>0.0613</td>
<td></td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.0049</td>
<td>0.0864</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="Q-Q图"><a href="#Q-Q图" class="headerlink" title="Q-Q图"></a>Q-Q图</h2><p>与3个Copula函数混合时的模型相比：</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula.jpg" alt="3个Copula函数混合Q-Q图"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula_new.jpg" alt="5个Copula函数混合Q-Q图"></p>
<p>由于不是定量分析，对比效果不明显，以下采用定量分析</p>
<h2 id="KS检验"><a href="#KS检验" class="headerlink" title="KS检验"></a>KS检验</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
<th>$K_{3M}$</th>
<th>$K_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
<td>0.0271</td>
<td>0.0260</td>
</tr>
</tbody>
</table>
<p>可以看出5个Copula混合时的模型较3个Copula混合时的效果更好</p>
<h2 id="欧式距离"><a href="#欧式距离" class="headerlink" title="欧式距离"></a>欧式距离</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
<th>$d_{3M}$</th>
<th>$d_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
<td>1.3220</td>
<td>1.2730</td>
</tr>
</tbody>
</table>
<p>从欧氏距离上也能够得到与KS检验中同样的结果</p>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>综上，可以将混合Copula模型更新为如下形式</p>
<p>$$<br>\begin{aligned}<br>C(u,v;a)= &amp; 0.1075C_t(u,v;0.9678,2.7192)+0.0613C<em>N(u,v;0.9250)<br>+\<br>&amp; 0.5502C</em>{Gumbel}(u,v;3.7781)+0.1946C<em>{Frank}(u,v;9.8959)+0.0864C</em>{Clayton}(u,v;0.0049)<br>\end{aligned}<br> $$</p>
<p>PS:以上程序跑了9个小时，由于本人电脑运算处理速度问题，暂且限制在该精度下，但是结果仍可更加精确，后面会使用工作站进行进一步的精确计算</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;修正的原因&quot;&gt;&lt;a href=&quot;#修正的原因&quot; class=&quot;headerlink&quot; title=&quot;修正的原因&quot;&gt;&lt;/a&gt;修正的原因&lt;/h1&gt;&lt;p&gt;由于Copula函数并非线性函数，简单的通过单个Copula函数拟合效果来选择使用哪几个Copula函数来进行混合可能不够准确，可能会存在两个单一表现并不好的Copula函数混合后结果却比较好的情况。&lt;/p&gt;
&lt;p&gt;因此，将原来的混合Copula模型拓展至五个常用Copula进行混合建模。&lt;/p&gt;
&lt;h1 id=&quot;修正后的代码&quot;&gt;&lt;a href=&quot;#修正后的代码&quot; class=&quot;headerlink&quot; title=&quot;修正后的代码&quot;&gt;&lt;/a&gt;修正后的代码&lt;/h1&gt;&lt;h2 id=&quot;EM算法主体部分&quot;&gt;&lt;a href=&quot;#EM算法主体部分&quot; class=&quot;headerlink&quot; title=&quot;EM算法主体部分&quot;&gt;&lt;/a&gt;EM算法主体部分&lt;/h2&gt;&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;66&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;67&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;68&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;69&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;70&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;71&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;72&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;73&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;74&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;U=GHKC;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;V=BDQC;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;% 初始化&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;S=&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;th=&lt;span class=&quot;number&quot;&gt;0.01&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;omega=[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;[a,nuhat]=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;t&#39;&lt;/span&gt;,[U,V]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a2=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;Gumbel&#39;&lt;/span&gt;,[U,V]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a3=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;Frank&#39;&lt;/span&gt;,[U,V]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a4=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;Gaussian&#39;&lt;/span&gt;,[U,V]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a5=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;Clayton&#39;&lt;/span&gt;,[U,V]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;theta=[a(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;),a2,a3,a4(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;),a5];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;[N,~]=&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(U);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;count=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tt=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nn=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tt(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=tinv(U(:),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tt(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=tinv(V(:),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nn(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=norminv(U(:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nn(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=norminv(V(:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;t=&lt;span class=&quot;built_in&quot;&gt;inf&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;COPULA=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;list1=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;list2=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;puz=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;puz1=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;turntheta_old=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tic&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; t&amp;gt;=th&amp;amp;&amp;amp;count&amp;lt;=&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta_old=theta;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega_old=omega;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%转化为无约束限制的参数&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    turntheta_old(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;tan&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;pi&lt;/span&gt;*theta_old(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    turntheta_old(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;(theta_old(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    turntheta_old(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;tan&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;pi&lt;/span&gt;*theta_old(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    turntheta_old(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;(theta_old(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;t&#39;&lt;/span&gt;,[U(:) V(:)],theta_old(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;Gumbel&#39;&lt;/span&gt;,[U(:) V(:)],theta_old(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;Frank&#39;&lt;/span&gt;,[U(:) V(:)],theta_old(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;Gaussian&#39;&lt;/span&gt;,[U(:) V(:)],theta_old(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;Clayton&#39;&lt;/span&gt;,[U(:) V(:)],theta_old(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:N&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tic&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    [turntheta,fval,exitflag,output,grad,hessian]=updatetheta(N,U,V,turntheta_old,puz1,tt,nn,nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    toc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;atan&lt;/span&gt;(turntheta(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))*&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;/&lt;span class=&quot;built_in&quot;&gt;pi&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;exp&lt;/span&gt;(turntheta(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;))+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;atan&lt;/span&gt;(turntheta(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;))*&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;/&lt;span class=&quot;built_in&quot;&gt;pi&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=&lt;span class=&quot;built_in&quot;&gt;exp&lt;/span&gt;(turntheta(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list1(:,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=theta;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list2(:,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=omega;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    t=max([norm(theta_old(:)-theta(:));norm(omega_old(:)-omega(:))])&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    count=count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;toc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;beep&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;代码中涉及对参数进行数学变换将其参数从各自有限定义域转为$(-\infty,+ \infty)$&lt;/p&gt;
&lt;p&gt;其中:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;t-Copula与正态Copula参数定义域为$(-1,1)$&lt;/li&gt;
&lt;li&gt;Gumbel-Copula参数定义域为$(1,+\infty)$&lt;/li&gt;
&lt;li&gt;Clayton-Copula参数定义域为$(0,+\infty)$&lt;/li&gt;
&lt;li&gt;Frank-Copula参数定义域为$(-\infty,+\infty)$&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="MATLAB" scheme="http://fatelancer.github.io/tags/MATLAB/"/>
    
      <category term="混合Copula" scheme="http://fatelancer.github.io/tags/%E6%B7%B7%E5%90%88Copula/"/>
    
  </entry>
  
  <entry>
    <title>光伏建模（2）——核密度估计实现</title>
    <link href="http://fatelancer.github.io/2017/03/17/%E5%85%89%E4%BC%8F%E5%BB%BA%E6%A8%A1%EF%BC%882%EF%BC%89%E2%80%94%E2%80%94%E6%A0%B8%E5%AF%86%E5%BA%A6%E4%BC%B0%E8%AE%A1%E5%AE%9E%E7%8E%B0/"/>
    <id>http://fatelancer.github.io/2017/03/17/光伏建模（2）——核密度估计实现/</id>
    <published>2017-03-17T05:33:01.000Z</published>
    <updated>2017-03-17T07:24:55.316Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据录入"><a href="#数据录入" class="headerlink" title="数据录入"></a>数据录入</h1><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\一月\太阳能测光数据_2010-01-01 - 2010-02-01.xls'</span>);</div><div class="line">solardata=solar(:,<span class="number">2</span>);</div><div class="line">SData=cell(<span class="number">1</span>,<span class="number">7</span>);</div><div class="line">SData(<span class="number">1</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\二月\太阳能测光数据_2010-02.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">2</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\三月\太阳能测光数据_2010-03-01 - 2010-04-01.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">3</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\四月\太阳能测光数据_2010-04-01 - 2010-05-01.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">4</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\五月\太阳能测光数据_2010-05-01 - 2010-06-01.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">5</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\六月\太阳能测光数据_2010-06-01 - 2010-07-01.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">6</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\七月\太阳能测光数据2010-7-1-2010-8-1.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">3</span>)]</div><div class="line">SData(<span class="number">7</span>)=&#123;solar&#125;;</div></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="使用核密度估计对长时间内的光伏强度进行估计"><a href="#使用核密度估计对长时间内的光伏强度进行估计" class="headerlink" title="使用核密度估计对长时间内的光伏强度进行估计"></a>使用核密度估计对长时间内的光伏强度进行估计</h1><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[fsd,sdc]=ecdf(solardata);</div><div class="line">[fks,ksc]=ksdensity(solardata,[<span class="number">-100</span>:<span class="number">1</span>:<span class="number">1200</span>]);</div><div class="line">figure;</div><div class="line">ecdfhist(fsd,sdc,<span class="number">100</span>);</div><div class="line">hold on</div><div class="line">plot(ksc,fks,<span class="string">'-r'</span>)</div></pre></td></tr></table></figure>
<p><em>在默认情况下核函数选取的是高斯核函数，事实上在所有核函数中，高斯与epanechnikov这两种核函数拟合效果较好</em></p>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p><img src="http://oag5ozkgs.bkt.clouddn.com/1.jpg" alt="频率分布"></p>
<p>可以看到在长时间尺度上（上例为半年）核密度估计的拟合程度很高，但是在稍短的时间尺度上（一个月）则效果较差，如下图</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_2.jpg" alt=""></p>
<p>该种情况可以通过<a href="http://blog.csdn.net/matlab_matlab/article/details/56286868" target="_blank" rel="external">调整窗的宽度来提高拟合优度</a>，如下图为窗宽度为2.5时重新拟合一个月的光伏强度结果</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_3.jpg" alt="当width=2.5时拟合结果"></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;数据录入&quot;&gt;&lt;a href=&quot;#数据录入&quot; class=&quot;headerlink&quot; title=&quot;数据录入&quot;&gt;&lt;/a&gt;数据录入&lt;/h1&gt;&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;solar=xlsread(&lt;span class=&quot;string&quot;&gt;&#39;E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\一月\太阳能测光数据_2010-01-01 - 2010-02-01.xls&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solardata=solar(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;SData=cell(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;SData(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=&amp;#123;solar&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solar=xlsread(&lt;span class=&quot;string&quot;&gt;&#39;E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\二月\太阳能测光数据_2010-02.xls&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solardata=[solardata; solar(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;SData(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=&amp;#123;solar&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solar=xlsread(&lt;span class=&quot;string&quot;&gt;&#39;E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\三月\太阳能测光数据_2010-03-01 - 2010-04-01.xls&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solardata=[solardata; solar(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;SData(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=&amp;#123;solar&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solar=xlsread(&lt;span class=&quot;string&quot;&gt;&#39;E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\四月\太阳能测光数据_2010-04-01 - 2010-05-01.xls&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solardata=[solardata; solar(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;SData(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)=&amp;#123;solar&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solar=xlsread(&lt;span class=&quot;string&quot;&gt;&#39;E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\五月\太阳能测光数据_2010-05-01 - 2010-06-01.xls&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solardata=[solardata; solar(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;SData(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)=&amp;#123;solar&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solar=xlsread(&lt;span class=&quot;string&quot;&gt;&#39;E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\六月\太阳能测光数据_2010-06-01 - 2010-07-01.xls&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solardata=[solardata; solar(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;SData(&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;)=&amp;#123;solar&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solar=xlsread(&lt;span class=&quot;string&quot;&gt;&#39;E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\七月\太阳能测光数据2010-7-1-2010-8-1.xls&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;solardata=[solardata; solar(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;SData(&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;)=&amp;#123;solar&amp;#125;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="MATLAB" scheme="http://fatelancer.github.io/tags/MATLAB/"/>
    
      <category term="核密度估计" scheme="http://fatelancer.github.io/tags/%E6%A0%B8%E5%AF%86%E5%BA%A6%E4%BC%B0%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>光伏建模——核密度估计而非Beta分布</title>
    <link href="http://fatelancer.github.io/2017/03/15/%E5%85%89%E4%BC%8F%E5%BB%BA%E6%A8%A1/"/>
    <id>http://fatelancer.github.io/2017/03/15/光伏建模/</id>
    <published>2017-03-15T02:44:56.000Z</published>
    <updated>2017-03-17T06:47:48.282Z</updated>
    
    <content type="html"><![CDATA[<h1 id="光伏建模与风速建模的不同"><a href="#光伏建模与风速建模的不同" class="headerlink" title="光伏建模与风速建模的不同"></a>光伏建模与风速建模的不同</h1><ul>
<li>对与风速建模而言，其符合双参数威布尔分布表示其样本数据符合双参数威布尔数据样本的特征</li>
<li>对于光伏建模而言，所谓的使用beta分布拟合光伏实际意义为在短时间内（一天之内）光照强度的曲线可以通过beta分布的概率密度函数去近似拟合</li>
</ul>
<p>此二者有本质区别，因此如果仅通过曲线拟合表示光伏建模数据不能称作光伏建模随机性的数学表述，因此在缺乏先验的情况下只能求助于仅基于样本数据核密度估计</p>
<a id="more"></a>
<h1 id="非参数核密度估计"><a href="#非参数核密度估计" class="headerlink" title="非参数核密度估计"></a>非参数核密度估计</h1><p>定义<br>  :   设$x_1,x_2,…,x_n$为随机变量$x$的样本，令随机变量$x$的概率密度函数为$f(x)$，则 $f(x)$ 的核密度估计为： </p>
<p>  $$f<em>h(x)={1 \over nh}{\displaystyle \sum</em>{j=1}^n{K({x-x<em>j \over h})}}={1 \over n}{\displaystyle \sum</em>{j=1}^n{K_h(x-x_j)}}$$</p>
<p>  其中$n$为样本容量，$h$ 为平滑系数，$K(·)$ 为核函数</p>
<iframe src="http://www.cnblogs.com/wt869054461/p/5935992.html" width="100%" height="700px" frameborder="0" scrolling="auto"> </iframe>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;光伏建模与风速建模的不同&quot;&gt;&lt;a href=&quot;#光伏建模与风速建模的不同&quot; class=&quot;headerlink&quot; title=&quot;光伏建模与风速建模的不同&quot;&gt;&lt;/a&gt;光伏建模与风速建模的不同&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;对与风速建模而言，其符合双参数威布尔分布表示其样本数据符合双参数威布尔数据样本的特征&lt;/li&gt;
&lt;li&gt;对于光伏建模而言，所谓的使用beta分布拟合光伏实际意义为在短时间内（一天之内）光照强度的曲线可以通过beta分布的概率密度函数去近似拟合&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;此二者有本质区别，因此如果仅通过曲线拟合表示光伏建模数据不能称作光伏建模随机性的数学表述，因此在缺乏先验的情况下只能求助于仅基于样本数据核密度估计&lt;/p&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="核密度估计" scheme="http://fatelancer.github.io/tags/%E6%A0%B8%E5%AF%86%E5%BA%A6%E4%BC%B0%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>混合Copula风速建模——代码实现与结果分析</title>
    <link href="http://fatelancer.github.io/2017/03/10/%E6%B7%B7%E5%90%88Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E2%80%94%E2%80%94%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E4%B8%8E%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90/"/>
    <id>http://fatelancer.github.io/2017/03/10/混合Copula风速建模——代码实现与结果分析/</id>
    <published>2017-03-10T08:05:37.000Z</published>
    <updated>2017-03-10T08:50:28.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>由于仿真一次所耗时间较长，因此选择北大桥与干河口风电场作为代表</em></p>
<h1 id="EM算法估计混合Copula参数"><a href="#EM算法估计混合Copula参数" class="headerlink" title="EM算法估计混合Copula参数"></a>EM算法估计混合Copula参数</h1><h2 id="EM主体"><a href="#EM主体" class="headerlink" title="EM主体"></a>EM主体</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">U=GHK;</div><div class="line">V=BDQ;</div><div class="line"><span class="comment">% 初始化</span></div><div class="line">S=<span class="number">3</span>;</div><div class="line">th=<span class="number">0.01</span>;</div><div class="line">omega=[<span class="number">1</span>/<span class="number">3</span>,<span class="number">1</span>/<span class="number">3</span>,<span class="number">1</span>/<span class="number">3</span>];</div><div class="line">[a,nuhat]=copulafit(<span class="string">'t'</span>,[U,V]);</div><div class="line">a2=copulafit(<span class="string">'Gumbel'</span>,[U,V]);</div><div class="line">a3=copulafit(<span class="string">'Frank'</span>,[U,V]);</div><div class="line">theta=[a(<span class="number">1</span>,<span class="number">2</span>),a2,a3];</div><div class="line">[N,~]=<span class="built_in">size</span>(U);</div><div class="line">count=<span class="number">0</span>;</div><div class="line">tt=<span class="built_in">zeros</span>(N,<span class="number">2</span>);</div><div class="line">t=<span class="built_in">inf</span>;</div><div class="line">COPULA=<span class="built_in">zeros</span>(N,S);</div><div class="line">list1=<span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">101</span>);</div><div class="line">list2=<span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">101</span>);</div><div class="line">puz=<span class="built_in">zeros</span>(N,S);</div><div class="line">puz1=<span class="built_in">zeros</span>(N,S);</div><div class="line"><span class="keyword">while</span> t&gt;=th&amp;&amp;count&lt;=<span class="number">100</span>;</div><div class="line">    theta_old=theta;</div><div class="line">    omega_old=omega;</div><div class="line">    COPULA(:,<span class="number">1</span>)=copulapdf(<span class="string">'t'</span>,[U(:) V(:)],theta_old(<span class="number">1</span>),nuhat);</div><div class="line">    COPULA(:,<span class="number">2</span>)=copulapdf(<span class="string">'Gumbel'</span>,[U(:) V(:)],theta_old(<span class="number">2</span>));</div><div class="line">    COPULA(:,<span class="number">3</span>)=copulapdf(<span class="string">'Frank'</span>,[U(:) V(:)],theta_old(<span class="number">3</span>));</div><div class="line">    puz(:,<span class="number">1</span>)=COPULA(:,<span class="number">1</span>)*omega_old(<span class="number">1</span>);</div><div class="line">    puz(:,<span class="number">2</span>)=COPULA(:,<span class="number">2</span>)*omega_old(<span class="number">2</span>);</div><div class="line">    puz(:,<span class="number">3</span>)=COPULA(:,<span class="number">3</span>)*omega_old(<span class="number">3</span>);</div><div class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">1</span>)=puz(<span class="built_in">i</span>,<span class="number">1</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">2</span>)=puz(<span class="built_in">i</span>,<span class="number">2</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">3</span>)=puz(<span class="built_in">i</span>,<span class="number">3</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    omega(<span class="number">1</span>)=sum(puz1(:,<span class="number">1</span>))/N;</div><div class="line">    omega(<span class="number">2</span>)=sum(puz1(:,<span class="number">2</span>))/N;</div><div class="line">    omega(<span class="number">3</span>)=sum(puz1(:,<span class="number">3</span>))/N;</div><div class="line">    omega</div><div class="line">    tt(:,<span class="number">1</span>)=tinv(U(:),nuhat);</div><div class="line">    tt(:,<span class="number">2</span>)=tinv(V(:),nuhat);</div><div class="line">    [turntheta,fval,exitflag,output,grad,hessian]=updatetheta(N,U,V,theta_old,puz1,tt,nuhat);</div><div class="line">    theta=turntheta;</div><div class="line">    theta</div><div class="line">    list1(:,count+<span class="number">1</span>)=theta;</div><div class="line">    list2(:,count+<span class="number">1</span>)=omega;</div><div class="line">    t=max([norm(theta_old(:)-theta(:));norm(omega_old(:)-omega(:))])</div><div class="line">    count=count+<span class="number">1</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="参数更新（非线性优化bfgs）"><a href="#参数更新（非线性优化bfgs）" class="headerlink" title="参数更新（非线性优化bfgs）"></a>参数更新（非线性优化bfgs）</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="params">[turntheta,fval,exitflag,output,grad,hessian]</span>=<span class="title">updatetheta</span><span class="params">(N,U,V,theta,puz,t,nuhat)</span></span></div><div class="line">options=optimset(<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'TolFun'</span>,<span class="number">1e-10</span>,<span class="string">'TolX'</span>,<span class="number">1e-10</span>,<span class="string">'LargeScale'</span>,<span class="string">'off'</span>,<span class="string">'FinDiffType'</span>,<span class="string">'central'</span>,<span class="string">'HessUpdate'</span>,<span class="string">'bfgs'</span>);</div><div class="line">[turntheta,fval,exitflag,output,grad,hessian]=fminunc(@utheta,theta,options);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">utheta</span><span class="params">(theta)</span></span></div><div class="line"><span class="keyword">if</span> theta(<span class="number">3</span>)==<span class="number">0</span></div><div class="line">    theta(<span class="number">3</span>)=theta(<span class="number">3</span>)+<span class="number">0.0001</span>;  <span class="comment">%防止出现 Frank  Copula 的相依结构参数为 0</span></div><div class="line"><span class="keyword">end</span></div><div class="line">y=<span class="number">0</span>;</div><div class="line">th=<span class="built_in">eye</span>(<span class="number">2</span>);</div><div class="line">th(<span class="number">1</span>,<span class="number">2</span>)=theta(<span class="number">1</span>);</div><div class="line">th(<span class="number">2</span>,<span class="number">1</span>)=theta(<span class="number">1</span>);</div><div class="line"><span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:N</div><div class="line"></div><div class="line">    y=y+<span class="built_in">log</span>(((det(th))^(<span class="number">-1</span>/<span class="number">2</span>))*<span class="built_in">gamma</span>((nuhat+<span class="number">2</span>)/<span class="number">2</span>)*<span class="built_in">gamma</span>(nuhat/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,:)*th^(<span class="number">-1</span>)*t(<span class="built_in">j</span>,:)'/nuhat)^(-(nuhat+<span class="number">2</span>)/<span class="number">2</span>)/((<span class="built_in">gamma</span>((nuhat+<span class="number">1</span>)/<span class="number">2</span>))^<span class="number">2</span>*((<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">1</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">2</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>))))*puz(<span class="built_in">j</span>,<span class="number">1</span>)+...</div><div class="line">        <span class="built_in">log</span>(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^theta(<span class="number">2</span>)+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^theta(<span class="number">2</span>))^(<span class="number">1</span>/theta(<span class="number">2</span>)))*(<span class="built_in">log</span>(U(<span class="built_in">j</span>))*<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>)<span class="number">-1</span>)*(((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>)))^(<span class="number">1</span>/theta(<span class="number">2</span>))+theta(<span class="number">2</span>)<span class="number">-1</span>)/(U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>)))^(<span class="number">2</span><span class="number">-1</span>/theta(<span class="number">2</span>))))*puz(<span class="built_in">j</span>,<span class="number">2</span>)+...</div><div class="line">        <span class="built_in">log</span>(theta(<span class="number">3</span>)*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))*<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*(U(<span class="built_in">j</span>)+V(<span class="built_in">j</span>)))/((<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))-(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*U(<span class="built_in">j</span>)))*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*V(<span class="built_in">j</span>))))^<span class="number">2</span>)*puz(<span class="built_in">j</span>,<span class="number">3</span>);</div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">y=-y;</div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.1244</td>
<td>0.0822</td>
<td>3</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>4.1127</td>
<td>0.7495</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>6.5931</td>
<td>0.1683</td>
<td></td>
</tr>
</tbody>
</table>
<p>即<br>$$C(u,v;a)=0.7495C<em>{Gumbel}(u,v;4.1127)+0.1683C</em>{Frank}(u,v;6.5931)+0.0822C_t(u,v;0.1244,3)$$</p>
<h1 id="结果评价"><a href="#结果评价" class="headerlink" title="结果评价"></a>结果评价</h1><h2 id="Q-Q图"><a href="#Q-Q图" class="headerlink" title="Q-Q图"></a>Q-Q图</h2><p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula.jpg" alt="mixed-Copula"><br>可以与之前单一Copula的仿真QQ图进行比较<br><img src="http://oag5ozkgs.bkt.clouddn.com/im1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/im2.jpg" alt="qq图3"><br>可以明显的看出拟合优度上混合Copula有很大的优势</p>
<h2 id="K-S检验"><a href="#K-S检验" class="headerlink" title="K-S检验"></a>K-S检验</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
<th>$K_M$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
<td>0.0271</td>
</tr>
</tbody>
</table>
<p>可以看出就K-S统计值而言混合Copula也小于其他单一Copula</p>
<h2 id="欧式距离"><a href="#欧式距离" class="headerlink" title="欧式距离"></a>欧式距离</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
<th>$d_M$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
<td>1.3220</td>
</tr>
</tbody>
</table>
<p>可以看出就欧式距离而言混合Copula也小于其他单一Copula</p>
<p>PS：作为一个学电气的人一开始看到要使用一个从未见过的EM算法我几乎是拒绝的，要多谢CS的室友和我分享了有关这方面的知识并且和我一起探讨。这个程序跑起来确实让人奔溃，跑一次就要三个多小时，但是最后仿真出来的结果符合我推测确实让我很开心</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;由于仿真一次所耗时间较长，因此选择北大桥与干河口风电场作为代表&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&quot;EM算法估计混合Copula参数&quot;&gt;&lt;a href=&quot;#EM算法估计混合Copula参数&quot; class=&quot;headerlink&quot; title=&quot;EM算法估计混合Copula参数&quot;&gt;&lt;/a&gt;EM算法估计混合Copula参数&lt;/h1&gt;&lt;h2 id=&quot;EM主体&quot;&gt;&lt;a href=&quot;#EM主体&quot; class=&quot;headerlink&quot; title=&quot;EM主体&quot;&gt;&lt;/a&gt;EM主体&lt;/h2&gt;&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;U=GHK;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;V=BDQ;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;% 初始化&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;S=&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;th=&lt;span class=&quot;number&quot;&gt;0.01&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;omega=[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;[a,nuhat]=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;t&#39;&lt;/span&gt;,[U,V]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a2=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;Gumbel&#39;&lt;/span&gt;,[U,V]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a3=copulafit(&lt;span class=&quot;string&quot;&gt;&#39;Frank&#39;&lt;/span&gt;,[U,V]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;theta=[a(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;),a2,a3];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;[N,~]=&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(U);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;count=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tt=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;t=&lt;span class=&quot;built_in&quot;&gt;inf&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;COPULA=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;list1=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;list2=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;puz=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;puz1=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(N,S);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; t&amp;gt;=th&amp;amp;&amp;amp;count&amp;lt;=&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta_old=theta;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega_old=omega;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;t&#39;&lt;/span&gt;,[U(:) V(:)],theta_old(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;Gumbel&#39;&lt;/span&gt;,[U(:) V(:)],theta_old(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    COPULA(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=copulapdf(&lt;span class=&quot;string&quot;&gt;&#39;Frank&#39;&lt;/span&gt;,[U(:) V(:)],theta_old(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    puz(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=COPULA(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)*omega_old(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:N&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        puz1(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)/sum(puz(&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;,:));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)=sum(puz1(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;))/N;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    omega&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tt(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=tinv(U(:),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tt(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)=tinv(V(:),nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    [turntheta,fval,exitflag,output,grad,hessian]=updatetheta(N,U,V,theta_old,puz1,tt,nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta=turntheta;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    theta&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list1(:,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=theta;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    list2(:,count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)=omega;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    t=max([norm(theta_old(:)-theta(:));norm(omega_old(:)-omega(:))])&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    count=count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="MATLAB" scheme="http://fatelancer.github.io/tags/MATLAB/"/>
    
      <category term="EM算法" scheme="http://fatelancer.github.io/tags/EM%E7%AE%97%E6%B3%95/"/>
    
      <category term="混合Copula" scheme="http://fatelancer.github.io/tags/%E6%B7%B7%E5%90%88Copula/"/>
    
      <category term="bfgs" scheme="http://fatelancer.github.io/tags/bfgs/"/>
    
  </entry>
  
  <entry>
    <title>混合Copula函数风速建模——EM算法</title>
    <link href="http://fatelancer.github.io/2017/03/06/%E6%B7%B7%E5%90%88Copula%E5%87%BD%E6%95%B0%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1/"/>
    <id>http://fatelancer.github.io/2017/03/06/混合Copula函数风速建模/</id>
    <published>2017-03-06T01:24:08.000Z</published>
    <updated>2017-03-06T11:11:51.728Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/123.jpg" alt="1"><br><a id="more"></a><br><img src="/images/1232.jpg" alt="2"><br><img src="/images/1233.jpg" alt="3"><br><img src="/images/1234.jpg" alt="4"><br><img src="/images/1235.jpg" alt="5"><br><img src="/images/1236.jpg" alt="6"><br><img src="/images/1237.jpg" alt="7"><br><img src="/images/1238.jpg" alt="8"><br><img src="/images/1239.jpg" alt="9"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/123.jpg&quot; alt=&quot;1&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="Copula" scheme="http://fatelancer.github.io/tags/Copula/"/>
    
      <category term="风速建模" scheme="http://fatelancer.github.io/tags/%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1/"/>
    
      <category term="EM算法" scheme="http://fatelancer.github.io/tags/EM%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Copula风速建模相关（5）——结果分析</title>
    <link href="http://fatelancer.github.io/2017/03/03/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%885%EF%BC%89/"/>
    <id>http://fatelancer.github.io/2017/03/03/Copula风速建模相关（5）/</id>
    <published>2017-03-03T05:38:20.000Z</published>
    <updated>2017-03-03T07:38:31.627Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Q-Q图分析"><a href="#Q-Q图分析" class="headerlink" title="Q-Q图分析"></a>Q-Q图分析</h1><p><img src="http://oag5ozkgs.bkt.clouddn.com/2in1_1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/3in1_1.jpg" alt="qq图3"></p>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="external">Q-Q图的判定原则</a>可知，各类Copula函数差别不 很 明 显，其 中Gumbel-Copula，Frank-Copula，t-Copula函数曲线均较为接近45°曲线，拟合效果相对较好。以下采用统计法</p>
<a id="more"></a>
<h1 id="K-S检验法"><a href="#K-S检验法" class="headerlink" title="K-S检验法"></a>K-S检验法</h1><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>0.0406</td>
<td>0.0395</td>
<td>0.0302</td>
<td>0.0520</td>
<td>0.0364</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>0.0260</td>
<td>0.0219</td>
<td>0.0156</td>
<td>0.0489</td>
<td>0.0208</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>0.0260</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0499</td>
<td>0.0239</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>0.0239</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0385</td>
<td>0.0166</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>0.0208</td>
<td>0.0208</td>
<td>0.0146</td>
<td>0.0385</td>
<td>0.0156</td>
</tr>
</tbody>
</table>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="external">K-S检验法的判定原则</a>可知，在六种不同的风电场组合中，Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数的 $KS$ 统计值相对较小，而Normal-Copula，Clayton-Copula的统计值相对较大</p>
<h1 id="秩相关性测度"><a href="#秩相关性测度" class="headerlink" title="秩相关性测度"></a>秩相关性测度</h1><table>
<thead>
<tr>
<th>数据来源</th>
<th>Kendall秩相关系数 $\tau$</th>
<th>Spearman秩相关系数 $\rho_s$</th>
</tr>
</thead>
<tbody>
<tr>
<td>原始观测数据</td>
<td>0.4816</td>
<td>0.6628</td>
</tr>
<tr>
<td>Normal-Copula</td>
<td>0.4371</td>
<td>0.6159</td>
</tr>
<tr>
<td>t-Copula</td>
<td>0.4410</td>
<td>0.6151</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>0.4604</td>
<td>0.6366</td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.2569</td>
<td>0.3751</td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>0.4592</td>
<td>0.6465</td>
</tr>
</tbody>
</table>
<p>通过与经验函数的Kendall秩相关系数，Spearman秩相关系数进行对比可以发现Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与原始数据保持着良好的秩相关性，而Normal-Copula，Clayton-Copula的秩相关性较差。</p>
<h1 id="欧式距离"><a href="#欧式距离" class="headerlink" title="欧式距离"></a>欧式距离</h1><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>2.8924</td>
<td>2.8209</td>
<td>1.3953</td>
<td>9.1763</td>
<td>2.4125</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>2.7285</td>
<td>2.6970</td>
<td>1.1862</td>
<td>8.2528</td>
<td>2.2180</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>2.3450</td>
<td>2.2558</td>
<td>1.3469</td>
<td>8.3662</td>
<td>1.8227</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>1.7187</td>
<td>1.7470</td>
<td>1.5995</td>
<td>5.0238</td>
<td>1.3692</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>1.8369</td>
<td>1.8561</td>
<td>1.3731</td>
<td>4.8842</td>
<td>1.4301</td>
</tr>
</tbody>
</table>
<p>可以看到在以上6种风电场组合中Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与经验Copula函数的欧氏距离较小，而Normal-Copula，Clayton-Copula与经验函数的欧氏距离较大</p>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>任何一个单一的Copula函数都不能够非常好的表达风电场的相依结构，因此考虑使用混合Copula函数，即将表现较好的3个Copula函数进行加权组合，即<br>$$C(u,v;a)=\omega<em>1C</em>{Gumbel}(u,v;\theta_1)+\omega<em>2C</em>{Frank}(u,v;\theta_2)+\omega_3C_t(u,v;\theta_3,k)$$</p>
<p>其中 $\omega_1+ \omega_2+ \omega_3=1$</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Q-Q图分析&quot;&gt;&lt;a href=&quot;#Q-Q图分析&quot; class=&quot;headerlink&quot; title=&quot;Q-Q图分析&quot;&gt;&lt;/a&gt;Q-Q图分析&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;http://oag5ozkgs.bkt.clouddn.com/2in1_1.jpg&quot; alt=&quot;qq图2&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://oag5ozkgs.bkt.clouddn.com/3in1_1.jpg&quot; alt=&quot;qq图3&quot;&gt;&lt;/p&gt;
&lt;p&gt;通过&lt;a href=&quot;http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Q-Q图的判定原则&lt;/a&gt;可知，各类Copula函数差别不 很 明 显，其 中Gumbel-Copula，Frank-Copula，t-Copula函数曲线均较为接近45°曲线，拟合效果相对较好。以下采用统计法&lt;/p&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="Copula" scheme="http://fatelancer.github.io/tags/Copula/"/>
    
      <category term="风速建模" scheme="http://fatelancer.github.io/tags/%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1/"/>
    
  </entry>
  
  <entry>
    <title>Copula风速建模相关(4)——Copula模型评价</title>
    <link href="http://fatelancer.github.io/2017/03/02/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%884%EF%BC%89/"/>
    <id>http://fatelancer.github.io/2017/03/02/Copula风速建模相关（4）/</id>
    <published>2017-03-02T07:30:23.000Z</published>
    <updated>2017-03-03T07:38:45.477Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Q-Q图"><a href="#Q-Q图" class="headerlink" title="Q-Q图"></a>Q-Q图</h1><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">%计算网格点上Copula分布函数值画QQ图</span></div><div class="line">Ccdf_n=copulacdf(<span class="string">'Gaussian'</span>,[Udata(:),Vdata(:)],rho_norm);</div><div class="line">Ccdf_t=copulacdf(<span class="string">'t'</span>,[Udata(:),Vdata(:)],rho_t,nuhat);</div><div class="line">Ccdf_G=copulacdf(<span class="string">'Gumbel'</span>,[Udata(:),Vdata(:)],paramhat_G);</div><div class="line">Ccdf_C=copulacdf(<span class="string">'Clayton'</span>,[Udata(:),Vdata(:)],paramhat_C);</div><div class="line">Ccdf_F=copulacdf(<span class="string">'Frank'</span>,[Udata(:),Vdata(:)],paramhat_F);</div><div class="line">figure;</div><div class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_n,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</div><div class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'Normal Copula'</span>,<span class="string">'rho:'</span>,num2str(rho_norm(<span class="number">1</span>,<span class="number">2</span>))]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'Normal'</span>]);</div><div class="line">figure;</div><div class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_t,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</div><div class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'t-Copula'</span>,<span class="string">'rho:'</span>,num2str(rho_t(<span class="number">1</span>,<span class="number">2</span>)),<span class="string">'k:'</span>,num2str(nuhat)]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'t'</span>]);</div><div class="line">figure;</div><div class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_G,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</div><div class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'Gumbel-Copula'</span>,<span class="string">'p_G:'</span>,num2str(paramhat_G)]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'Gumbel'</span>]);</div><div class="line">figure;</div><div class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_C,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</div><div class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'Clayton-Copula'</span>,<span class="string">'p_C'</span>,num2str(paramhat_C)]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'Clayton'</span>]);</div><div class="line">figure;</div><div class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_F,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</div><div class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'Frank-Copula'</span>,<span class="string">'p_F'</span>,num2str(paramhat_F)]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'Frank'</span>]);</div></pre></td></tr></table></figure>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p> <img src="http://oag5ozkgs.bkt.clouddn.com/2in1_1.jpg" alt="qq图2"><br> <img src="http://oag5ozkgs.bkt.clouddn.com/3in1_1.jpg" alt="qq图3"></p>
<a id="more"></a>
<h1 id="K-S检验"><a href="#K-S检验" class="headerlink" title="K-S检验"></a>K-S检验</h1><p><em>以北大桥与桥湾风电场为例</em></p>
<h2 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%K-S检验</span></div><div class="line">[h_n,p_n,k_n]=kstest2(CopulaEmpirical',Ccdf_n)</div><div class="line">[h_t,p_t,k_t]=kstest2(CopulaEmpirical',Ccdf_t)</div><div class="line">[h_G,p_G,k_G]=kstest2(CopulaEmpirical',Ccdf_G)</div><div class="line">[h_C,p_C,k_C]=kstest2(CopulaEmpirical',Ccdf_C)</div><div class="line">[h_F,p_F,k_F]=kstest2(CopulaEmpirical',Ccdf_F)</div></pre></td></tr></table></figure>
<h2 id="结果-1"><a href="#结果-1" class="headerlink" title="结果"></a>结果</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>0.0406</td>
<td>0.0395</td>
<td>0.0302</td>
<td>0.0520</td>
<td>0.0364</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>0.0260</td>
<td>0.0219</td>
<td>0.0156</td>
<td>0.0489</td>
<td>0.0208</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>0.0260</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0499</td>
<td>0.0239</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>0.0239</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0385</td>
<td>0.0166</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>0.0208</td>
<td>0.0208</td>
<td>0.0146</td>
<td>0.0385</td>
<td>0.0156</td>
</tr>
</tbody>
</table>
<h1 id="Copula函数的秩相关性测度"><a href="#Copula函数的秩相关性测度" class="headerlink" title="Copula函数的秩相关性测度"></a>Copula函数的秩相关性测度</h1><h2 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%Copula模型的相关性测度</span></div><div class="line"><span class="comment">%使用原始数据计算秩相关系数</span></div><div class="line">Kendall=corr([X,Y],<span class="string">'type'</span>,<span class="string">'Kendall'</span>)</div><div class="line">Spearman=corr([X,Y],<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</div><div class="line"><span class="comment">%计算Copula的秩相关系数</span></div><div class="line">Kendall_norm = copulastat(<span class="string">'Gaussian'</span>,rho_norm)</div><div class="line">Spearman_norm = copulastat(<span class="string">'Gaussian'</span>,rho_norm,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</div><div class="line">Kendall_t = copulastat(<span class="string">'t'</span>,rho_t,nuhat)</div><div class="line">Spearman_t = copulastat(<span class="string">'t'</span>,rho_t,nuhat,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</div><div class="line">Kendall_G = copulastat(<span class="string">'Gumbel'</span>,paramhat_G)</div><div class="line">Spearman_G = copulastat(<span class="string">'Gumbel'</span>,paramhat_G,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</div><div class="line">Kendall_C = copulastat(<span class="string">'Clayton'</span>,paramhat_C)</div><div class="line">Spearman_C = copulastat(<span class="string">'Clayton'</span>,paramhat_C,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</div><div class="line">Kendall_F = copulastat(<span class="string">'Frank'</span>,paramhat_F)</div><div class="line">Spearman_F= copulastat(<span class="string">'Frank'</span>,paramhat_F,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</div></pre></td></tr></table></figure>
<h2 id="结果-2"><a href="#结果-2" class="headerlink" title="结果"></a>结果</h2><table>
<thead>
<tr>
<th>数据来源</th>
<th>Kendall秩相关系数 $\tau$</th>
<th>Spearman秩相关系数 $\rho_s$</th>
</tr>
</thead>
<tbody>
<tr>
<td>原始观测数据</td>
<td>0.4816</td>
<td>0.6628</td>
</tr>
<tr>
<td>Normal-Copula</td>
<td>0.4371</td>
<td>0.6159</td>
</tr>
<tr>
<td>t-Copula</td>
<td>0.4410</td>
<td>0.6151</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>0.4604</td>
<td>0.6366</td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.2569</td>
<td>0.3751</td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>0.4592</td>
<td>0.6465</td>
</tr>
</tbody>
</table>
<h1 id="欧式距离计算"><a href="#欧式距离计算" class="headerlink" title="欧式距离计算"></a>欧式距离计算</h1><h2 id="代码实现-3"><a href="#代码实现-3" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%----------------求欧式距离</span></div><div class="line"><span class="comment">% 通过循环计算经验Copula函数在新产生的网格点处的函数值</span></div><div class="line">CUV=<span class="built_in">zeros</span>(<span class="built_in">size</span>(UU(:)));</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(UU)</div><div class="line">    CUV(<span class="built_in">i</span>)=C(UU(<span class="built_in">i</span>),VV(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment">%求各Copula函数在原始样本点处的函数值</span></div><div class="line">Cnorm=copulacdf(<span class="string">'Gaussian'</span>,[UU(:),VV(:)],rho_norm);</div><div class="line">Ct=copulacdf(<span class="string">'t'</span>,[UU(:),VV(:)],rho_t,nuhat);</div><div class="line">CG=copulacdf(<span class="string">'Gumbel'</span>,[UU(:),VV(:)],paramhat_G);</div><div class="line">CC=copulacdf(<span class="string">'Clayton'</span>,[UU(:),VV(:)],paramhat_C);</div><div class="line">CF=copulacdf(<span class="string">'Frank'</span>,[UU(:),VV(:)],paramhat_F);</div><div class="line"></div><div class="line"><span class="comment">%计算欧式距离</span></div><div class="line">dnorm=<span class="built_in">sqrt</span>((CUV-Cnorm)'*(CUV-Cnorm))</div><div class="line">dt=<span class="built_in">sqrt</span>((CUV-Ct)'*(CUV-Ct))</div><div class="line">dG=<span class="built_in">sqrt</span>((CUV-CG)'*(CUV-CG))</div><div class="line">dC=<span class="built_in">sqrt</span>((CUV-CC)'*(CUV-CC))</div><div class="line">dF=<span class="built_in">sqrt</span>((CUV-CF)'*(CUV-CF))</div></pre></td></tr></table></figure>
<h2 id="结果-3"><a href="#结果-3" class="headerlink" title="结果"></a>结果</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>2.8924</td>
<td>2.8209</td>
<td>1.3953</td>
<td>9.1763</td>
<td>2.4125</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>2.7285</td>
<td>2.6970</td>
<td>1.1862</td>
<td>8.2528</td>
<td>2.2180</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>2.3450</td>
<td>2.2558</td>
<td>1.3469</td>
<td>8.3662</td>
<td>1.8227</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>1.7187</td>
<td>1.7470</td>
<td>1.5995</td>
<td>5.0238</td>
<td>1.3692</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>1.8369</td>
<td>1.8561</td>
<td>1.3731</td>
<td>4.8842</td>
<td>1.4301</td>
</tr>
</tbody>
</table>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Q-Q图&quot;&gt;&lt;a href=&quot;#Q-Q图&quot; class=&quot;headerlink&quot; title=&quot;Q-Q图&quot;&gt;&lt;/a&gt;Q-Q图&lt;/h1&gt;&lt;h2 id=&quot;代码实现&quot;&gt;&lt;a href=&quot;#代码实现&quot; class=&quot;headerlink&quot; title=&quot;代码实现&quot;&gt;&lt;/a&gt;代码实现&lt;/h2&gt;&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;%计算网格点上Copula分布函数值画QQ图&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Ccdf_n=copulacdf(&lt;span class=&quot;string&quot;&gt;&#39;Gaussian&#39;&lt;/span&gt;,[Udata(:),Vdata(:)],rho_norm);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Ccdf_t=copulacdf(&lt;span class=&quot;string&quot;&gt;&#39;t&#39;&lt;/span&gt;,[Udata(:),Vdata(:)],rho_t,nuhat);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Ccdf_G=copulacdf(&lt;span class=&quot;string&quot;&gt;&#39;Gumbel&#39;&lt;/span&gt;,[Udata(:),Vdata(:)],paramhat_G);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Ccdf_C=copulacdf(&lt;span class=&quot;string&quot;&gt;&#39;Clayton&#39;&lt;/span&gt;,[Udata(:),Vdata(:)],paramhat_C);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Ccdf_F=copulacdf(&lt;span class=&quot;string&quot;&gt;&#39;Frank&#39;&lt;/span&gt;,[Udata(:),Vdata(:)],paramhat_F);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;figure;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;qqplot(&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(CopulaEmpirical,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(Ccdf_n,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;xlabel(&lt;span class=&quot;string&quot;&gt;&#39;经验Copula&#39;&lt;/span&gt;);ylabel([&lt;span class=&quot;string&quot;&gt;&#39;Normal Copula&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;rho:&#39;&lt;/span&gt;,num2str(rho_norm(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;))]); title([N&amp;#123;n&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;与&#39;&lt;/span&gt;,N&amp;#123;m&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;Q-Q图&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;Normal&#39;&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;figure;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;qqplot(&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(CopulaEmpirical,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(Ccdf_t,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;xlabel(&lt;span class=&quot;string&quot;&gt;&#39;经验Copula&#39;&lt;/span&gt;);ylabel([&lt;span class=&quot;string&quot;&gt;&#39;t-Copula&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;rho:&#39;&lt;/span&gt;,num2str(rho_t(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)),&lt;span class=&quot;string&quot;&gt;&#39;k:&#39;&lt;/span&gt;,num2str(nuhat)]); title([N&amp;#123;n&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;与&#39;&lt;/span&gt;,N&amp;#123;m&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;Q-Q图&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;t&#39;&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;figure;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;qqplot(&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(CopulaEmpirical,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(Ccdf_G,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;xlabel(&lt;span class=&quot;string&quot;&gt;&#39;经验Copula&#39;&lt;/span&gt;);ylabel([&lt;span class=&quot;string&quot;&gt;&#39;Gumbel-Copula&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;p_G:&#39;&lt;/span&gt;,num2str(paramhat_G)]); title([N&amp;#123;n&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;与&#39;&lt;/span&gt;,N&amp;#123;m&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;Q-Q图&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;Gumbel&#39;&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;figure;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;qqplot(&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(CopulaEmpirical,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(Ccdf_C,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;xlabel(&lt;span class=&quot;string&quot;&gt;&#39;经验Copula&#39;&lt;/span&gt;);ylabel([&lt;span class=&quot;string&quot;&gt;&#39;Clayton-Copula&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;p_C&#39;&lt;/span&gt;,num2str(paramhat_C)]); title([N&amp;#123;n&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;与&#39;&lt;/span&gt;,N&amp;#123;m&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;Q-Q图&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;Clayton&#39;&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;figure;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;qqplot(&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(CopulaEmpirical,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;built_in&quot;&gt;reshape&lt;/span&gt;(Ccdf_F,&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;(Udata)),&lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;xlabel(&lt;span class=&quot;string&quot;&gt;&#39;经验Copula&#39;&lt;/span&gt;);ylabel([&lt;span class=&quot;string&quot;&gt;&#39;Frank-Copula&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;p_F&#39;&lt;/span&gt;,num2str(paramhat_F)]); title([N&amp;#123;n&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;与&#39;&lt;/span&gt;,N&amp;#123;m&amp;#125;,&lt;span class=&quot;string&quot;&gt;&#39;Q-Q图&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;Frank&#39;&lt;/span&gt;]);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;结果&quot;&gt;&lt;a href=&quot;#结果&quot; class=&quot;headerlink&quot; title=&quot;结果&quot;&gt;&lt;/a&gt;结果&lt;/h2&gt;&lt;p&gt; &lt;img src=&quot;http://oag5ozkgs.bkt.clouddn.com/2in1_1.jpg&quot; alt=&quot;qq图2&quot;&gt;&lt;br&gt; &lt;img src=&quot;http://oag5ozkgs.bkt.clouddn.com/3in1_1.jpg&quot; alt=&quot;qq图3&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="Copula" scheme="http://fatelancer.github.io/tags/Copula/"/>
    
      <category term="Q-Q图" scheme="http://fatelancer.github.io/tags/Q-Q%E5%9B%BE/"/>
    
      <category term="K-S检验" scheme="http://fatelancer.github.io/tags/K-S%E6%A3%80%E9%AA%8C/"/>
    
      <category term="欧氏距离" scheme="http://fatelancer.github.io/tags/%E6%AC%A7%E6%B0%8F%E8%B7%9D%E7%A6%BB/"/>
    
  </entry>
  
  <entry>
    <title>Copula风速建模相关（3）——代码实现</title>
    <link href="http://fatelancer.github.io/2017/03/01/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%883%EF%BC%89/"/>
    <id>http://fatelancer.github.io/2017/03/01/Copula风速建模相关（3）/</id>
    <published>2017-03-01T01:55:37.000Z</published>
    <updated>2017-03-14T09:50:25.526Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据来源"><a href="#数据来源" class="headerlink" title="数据来源"></a>数据来源</h1><p><strong>使用甘肃桥湾（1），北大桥（2），干河口（3），昌马（4）四处风速数据作为仿真数据</strong></p>
<h1 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h1><h2 id="读入数据"><a href="#读入数据" class="headerlink" title="读入数据"></a>读入数据</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%从文件中读取数据</span></div><div class="line">load(<span class="string">'data.mat'</span>);</div><div class="line">qw=data(:,<span class="number">1</span>);<span class="comment">%桥湾</span></div><div class="line">bdq=data(:,<span class="number">4</span>);<span class="comment">%北大桥</span></div><div class="line">ghk=data(:,<span class="number">7</span>);<span class="comment">%干河口</span></div><div class="line">cm=data(:,<span class="number">10</span>);<span class="comment">%昌马</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="对风速进行双参数威布尔分布化"><a href="#对风速进行双参数威布尔分布化" class="headerlink" title="对风速进行双参数威布尔分布化"></a>对风速进行双参数威布尔分布化</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%桥湾</span></div><div class="line">pqw=wblfit(qw);</div><div class="line">QW=wblpdf(<span class="number">1</span>:<span class="number">50</span>,pqw(<span class="number">1</span>),pqw(<span class="number">2</span>));</div><div class="line">QWC=wblcdf(qw,pqw(<span class="number">1</span>),pqw(<span class="number">2</span>));</div><div class="line"><span class="comment">%北大桥</span></div><div class="line">pbdq=wblfit(bdq);</div><div class="line">BDQ=wblpdf(<span class="number">1</span>:<span class="number">50</span>,pbdq(<span class="number">1</span>),pbdq(<span class="number">2</span>));</div><div class="line">BDQC=wblcdf(bdq,pbdq(<span class="number">1</span>),pbdq(<span class="number">2</span>));</div><div class="line"><span class="comment">%干河口</span></div><div class="line">pghk=wblfit(ghk);</div><div class="line">GHK=wblpdf(<span class="number">1</span>:<span class="number">50</span>,pghk(<span class="number">1</span>),pghk(<span class="number">2</span>));</div><div class="line">GHKC=wblcdf(ghk,pghk(<span class="number">1</span>),pghk(<span class="number">2</span>));</div><div class="line"><span class="comment">%昌马</span></div><div class="line">pcm=wblfit(cm);</div><div class="line">CM=wblpdf(<span class="number">1</span>:<span class="number">50</span>,pcm(<span class="number">1</span>),pcm(<span class="number">2</span>));</div><div class="line">CMC=wblcdf(cm,pcm(<span class="number">1</span>),pcm(<span class="number">2</span>));</div><div class="line">d=&#123;qw,bdq,ghk,cm&#125;;</div><div class="line">D=&#123;QW,BDQ,GHK,CM&#125;;</div><div class="line">DD=&#123;QWC,BDQC,GHKC,CMC&#125;;</div><div class="line">N=&#123;<span class="string">'桥湾'</span>,<span class="string">'北大桥'</span>,<span class="string">'干河口'</span>,<span class="string">'昌马'</span>&#125;;</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>风电场</th>
<th>威布尔参数a</th>
<th>威布尔参数b</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾</td>
<td>8.1343</td>
<td>1.8773</td>
</tr>
<tr>
<td>北大桥</td>
<td>8.6619</td>
<td>1.7378</td>
</tr>
<tr>
<td>干河口</td>
<td>8.3685</td>
<td>1.5731</td>
</tr>
<tr>
<td>昌马</td>
<td>9.1261</td>
<td>2.1229</td>
</tr>
</tbody>
</table>
<h1 id="频率与频数直方图"><a href="#频率与频数直方图" class="headerlink" title="频率与频数直方图"></a>频率与频数直方图</h1><h2 id="频率分布直方图"><a href="#频率分布直方图" class="headerlink" title="频率分布直方图"></a>频率分布直方图</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%桥湾</span></div><div class="line">[fqw,qwc]=ecdf(qw);</div><div class="line">figure(<span class="number">1</span>);</div><div class="line">ecdfhist(fqw,qwc,<span class="number">100</span>);</div><div class="line">hold on</div><div class="line">plot(QW,<span class="string">'-r'</span>);</div><div class="line">title(<span class="string">'桥湾'</span>);</div><div class="line">xlabel(<span class="string">'风速'</span>);</div><div class="line">ylabel(<span class="string">'f(x)'</span>);</div><div class="line">hold off</div><div class="line"><span class="comment">%北大桥</span></div><div class="line">[fbdq,bdqc]=ecdf(bdq);</div><div class="line">figure(<span class="number">2</span>);</div><div class="line">ecdfhist(fbdq,bdqc,<span class="number">100</span>);</div><div class="line">hold on</div><div class="line">plot(BDQ,<span class="string">'-r'</span>);</div><div class="line">title(<span class="string">'北大桥'</span>);</div><div class="line">xlabel(<span class="string">'风速'</span>);</div><div class="line">ylabel(<span class="string">'f(x)'</span>);</div><div class="line">hold off</div><div class="line"><span class="comment">%干河口</span></div><div class="line">[fghk,ghkc]=ecdf(ghk);</div><div class="line">figure(<span class="number">3</span>);</div><div class="line">ecdfhist(fghk,ghkc,<span class="number">100</span>);</div><div class="line">hold on;</div><div class="line">plot(GHK,<span class="string">'-r'</span>);</div><div class="line">title(<span class="string">'干河口'</span>);</div><div class="line">xlabel(<span class="string">'风速'</span>);</div><div class="line">ylabel(<span class="string">'f(x)'</span>);</div><div class="line">hold off</div><div class="line"><span class="comment">%昌马</span></div><div class="line">[fcm,cmc]=ecdf(cm);</div><div class="line">figure(<span class="number">4</span>);</div><div class="line">ecdfhist(fcm,cmc,<span class="number">100</span>);</div><div class="line">hold on</div><div class="line">plot(CM,<span class="string">'-r'</span>);</div><div class="line">title(<span class="string">'昌马'</span>);</div><div class="line">xlabel(<span class="string">'风速'</span>);</div><div class="line">ylabel(<span class="string">'f(x)'</span>);</div><div class="line">hold off</div></pre></td></tr></table></figure>
<p><strong>结果</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/4in1_1.jpg" alt="频率分布直方图"></p>
<h2 id="频数分布直方图"><a href="#频数分布直方图" class="headerlink" title="频数分布直方图"></a>频数分布直方图</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></div><div class="line">    <span class="keyword">for</span> <span class="built_in">j</span>=<span class="built_in">i</span>+<span class="number">1</span>:<span class="number">4</span></div><div class="line">        figure;</div><div class="line">        hist3([DD&#123;i&#125;(:) DD&#123;j&#125;(:)],[<span class="number">50</span>,<span class="number">50</span>]);</div><div class="line">        xlabel(N&#123;i&#125;);</div><div class="line">        ylabel(N&#123;j&#125;);</div><div class="line">        zlabel(<span class="string">'频数'</span>);</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p><strong>结果</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/6in1.jpg" alt="风电场间频数直方图"></p>
<h1 id="各Copula函数"><a href="#各Copula函数" class="headerlink" title="各Copula函数"></a>各Copula函数</h1><h2 id="Copula函数参数估计"><a href="#Copula函数参数估计" class="headerlink" title="Copula函数参数估计"></a>Copula函数参数估计</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">rho_norm = copulafit(<span class="string">'Gaussian'</span>,[U,V]);</div><div class="line">[rho_t,nuhat,nuci]=copulafit(<span class="string">'t'</span>,[U,V]);</div><div class="line">paramhat_G=copulafit(<span class="string">'Gumbel'</span>,[U,V]);</div><div class="line">paramhat_C=copulafit(<span class="string">'Clayton'</span>,[U,V]);</div><div class="line">paramhat_F=copulafit(<span class="string">'Frank'</span>,[U,V]);</div></pre></td></tr></table></figure>
<p><strong>结果</strong></p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$\rho_{Norm}$</th>
<th>$\rho_t$</th>
<th>$k$</th>
<th>$\theta_G$</th>
<th>$\theta_C$</th>
<th>$\theta_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾与北大桥</td>
<td>0.6339</td>
<td>0.6386</td>
<td>9.1619</td>
<td>1.8533</td>
<td>0.6913</td>
<td>5.0402</td>
</tr>
<tr>
<td>桥湾与干河口</td>
<td>0.5346</td>
<td>0.5364</td>
<td>9.7829</td>
<td>1.6350</td>
<td>0.4847</td>
<td>3.8853</td>
</tr>
<tr>
<td>桥湾与昌马</td>
<td>0.6108</td>
<td>0.6169</td>
<td>10.4474</td>
<td>1.7697</td>
<td>0.6530</td>
<td>4.8459</td>
</tr>
<tr>
<td>北大桥与干河口</td>
<td>0.8092</td>
<td>0.8479</td>
<td>2.7192</td>
<td>2.9270</td>
<td>1.4685</td>
<td>9.8959</td>
</tr>
<tr>
<td>北大桥与昌马</td>
<td>0.3639</td>
<td>0.3630</td>
<td>33.9054</td>
<td>1.3098</td>
<td>0.3072</td>
<td>2.3697</td>
</tr>
<tr>
<td>干河口与昌马</td>
<td>0.3028</td>
<td>0.3026</td>
<td>21.9903</td>
<td>1.2628</td>
<td>0.2141</td>
<td>1.9736</td>
</tr>
</tbody>
</table>
<h2 id="经验Copula"><a href="#经验Copula" class="headerlink" title="经验Copula"></a>经验Copula</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%计算经验分布</span></div><div class="line">[fx,xsort]=ecdf(X);</div><div class="line">[fy,ysort]=ecdf(Y);</div><div class="line"><span class="comment">%调用spine函数利用样条插值计算原始样本点的经验分布函数值</span></div><div class="line">UU=spline(xsort(<span class="number">2</span>:<span class="keyword">end</span>),fx(<span class="number">2</span>:<span class="keyword">end</span>),X);</div><div class="line">VV=spline(ysort(<span class="number">2</span>:<span class="keyword">end</span>),fy(<span class="number">2</span>:<span class="keyword">end</span>),Y);</div><div class="line"><span class="comment">%定义经验Copula函数</span></div><div class="line">C=@(u,v)mean((UU&lt;=u).*(VV&lt;=v));</div><div class="line"></div><div class="line">[Udata,Vdata] = <span class="built_in">meshgrid</span>(<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">31</span>));</div><div class="line"><span class="comment">%循环计算经验Copula函数值</span></div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(Udata)</div><div class="line">    CopulaEmpirical(<span class="built_in">i</span>)=C(Udata(<span class="built_in">i</span>),Vdata(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;数据来源&quot;&gt;&lt;a href=&quot;#数据来源&quot; class=&quot;headerlink&quot; title=&quot;数据来源&quot;&gt;&lt;/a&gt;数据来源&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;使用甘肃桥湾（1），北大桥（2），干河口（3），昌马（4）四处风速数据作为仿真数据&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;数据处理&quot;&gt;&lt;a href=&quot;#数据处理&quot; class=&quot;headerlink&quot; title=&quot;数据处理&quot;&gt;&lt;/a&gt;数据处理&lt;/h1&gt;&lt;h2 id=&quot;读入数据&quot;&gt;&lt;a href=&quot;#读入数据&quot; class=&quot;headerlink&quot; title=&quot;读入数据&quot;&gt;&lt;/a&gt;读入数据&lt;/h2&gt;&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;%从文件中读取数据&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;load(&lt;span class=&quot;string&quot;&gt;&#39;data.mat&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;qw=data(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;span class=&quot;comment&quot;&gt;%桥湾&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;bdq=data(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;span class=&quot;comment&quot;&gt;%北大桥&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ghk=data(:,&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;);&lt;span class=&quot;comment&quot;&gt;%干河口&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cm=data(:,&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;span class=&quot;comment&quot;&gt;%昌马&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="Copula" scheme="http://fatelancer.github.io/tags/Copula/"/>
    
      <category term="MATLAB" scheme="http://fatelancer.github.io/tags/MATLAB/"/>
    
      <category term="风力发电" scheme="http://fatelancer.github.io/tags/%E9%A3%8E%E5%8A%9B%E5%8F%91%E7%94%B5/"/>
    
  </entry>
  
  <entry>
    <title>Copula风速建模相关（2）——函数性质以及常用代码</title>
    <link href="http://fatelancer.github.io/2017/02/28/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%882%EF%BC%89/"/>
    <id>http://fatelancer.github.io/2017/02/28/Copula风速建模相关（2）/</id>
    <published>2017-02-28T01:33:07.000Z</published>
    <updated>2017-03-01T08:47:38.469Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;filter=sc_long_sign&amp;tn=SE_xueshusource_2kduw22v&amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;ie=utf-8&amp;sc_us=15886197312218780659" target="_blank" rel="external">1</a></p>
<h1 id="二元Copula函数的定义以及性质"><a href="#二元Copula函数的定义以及性质" class="headerlink" title="二元Copula函数的定义以及性质"></a>二元Copula函数的定义以及性质</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义:"></a><strong>定义:</strong></h2><blockquote>
<p>二元Copula函数是指满足以下性质的函数$C(u,v)$:</p>
<ul>
<li>$C(u,v)$ 的定义域为[0,1]x[0,1]；</li>
<li>$C(u,v)$ 有零基面，并且是二维递增的；</li>
<li>对任意$u,v\in [0,1]$，满足$C(u,1)=u，C(1,v)=v$。<br>所谓的有零基面是：至少存在一个$u_0\in[0,1]$ 和一个$v_0\in[0,1]$，使得$C(u_0,v)=0=C(u,v_0)$。<br>二维递增是指：对任意$0\le u_1\le u_2\le1$和$0\le v_1\le v_2\le1$，有<br>$$C(u_2,v_2)-C(u_2,v_1)-C(u_1,v_2)+C(u_1,v_1)\ge 0$$</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="性质："><a href="#性质：" class="headerlink" title="性质："></a><strong>性质：</strong></h2><blockquote>
<p>二元Copula函数满足以下性质：</p>
<ul>
<li>$C(u,v)$ 关于每一个变量都是单调非减的</li>
<li>对于任意的$u,v\in[0,1],C(u,0)=C(0,v)=0,C(u,1)=u,C(1,v)=v$</li>
<li>对任意$0\le u_1\le u_2\le1$和$0\le v_1\le v_2\le1$，有<br>$$C(u_2,v_2)-C(u_2,v_1)-C(u_1,v_2)+C(u_1,v_1)\ge 0$$</li>
<li>对任意的$u_1,u_2,v_1,v_2\in[0,1]$，有 $|C(u_2,v_2)-C(u_1,v_1)|\le|u_2-u_1|+|v_2-v_1|$。</li>
<li>对任意$u,v\in[0,1],max(u+v-1,0)\le C(u,v) \le min(u,v)$，令<br>$C^-(u,v)=max(u+v-1,0),C^+(u,v)=min(u,v)$，则称$C^-(u,v)和 C^+(u,v)$ 分别为<strong>Frechet上界和下界</strong></li>
<li>若$U,V$ 独立且同服从 $[0,1]$ 上的均匀分布，则$C(u,v)=uv$。</li>
</ul>
</blockquote>
<h1 id="多元Copula函数的定义及性质"><a href="#多元Copula函数的定义及性质" class="headerlink" title="多元Copula函数的定义及性质"></a>多元Copula函数的定义及性质</h1><h2 id="定义："><a href="#定义：" class="headerlink" title="定义："></a><strong>定义：</strong></h2><blockquote>
<p>N元Copula函数是指满足以下性质的函数 $C(u_1,u_2,…,u_N)$ ：</p>
<ul>
<li>定义域为 $[0,1]^N$</li>
<li>$C(u_1,u_2,…,u_N)$ 有零基面，并且是N维递增的；</li>
<li>$C(u_1,u_2,…,u_N)$ 有边缘分布函数<br>  $$ C_i(u_i)=C(1,…,1,u_i,1,…,1)=u_i $$<br>  其中 $u_i \in <a href="i=1,2,...,N">0,1</a>$ 。</li>
</ul>
</blockquote>
<h2 id="性质：-1"><a href="#性质：-1" class="headerlink" title="性质："></a><strong>性质：</strong></h2><blockquote>
<p>多元Copula函数具备以下性质：</p>
<ul>
<li>$C(u_1,u_2,…,u_N)$ 关于每个变量都是单调非减得</li>
<li>$C(u_1,u_2,…,0,…,u_N)=0,C(1,…,1,u_i,1,…,1)=u_i$ 。</li>
<li>对任意的 $u_i,v_i \in <a href="i=1,2,...,N">0,1</a>$ ，有<br>  $$|C(u_1,u_2,…,u_N)|-C(v_1,v_2,…,v<em>N) \le {\displaystyle \sum </em>{i=1}^N {|u_i-v_i|}}$$</li>
<li>令 $C^-(u_1,u_2,…u<em>N)=max({\displaystyle\sum</em>{i=1}^N{u_i-N+1,0}})$ ，<br>$C^+(u_1,u_2,…,u_N)=min(u_1,u_2,…,u_N)$ ，则对任意的  $u_i\in <a href="i=1,2,...,N">0,1</a>$ ，有<br>  $$C^-(u_1,u_2,…u_N)\le C(u_1,u_2,…,u_N)\le C^+(u_1,u_2,…,u_N)$$<br>  记为 $C^-\prec C\prec C^+$ 。称 $C^-$ 和 $C^+$ 分别为<strong>Frechet</strong>上下界，当 $N\ge 2$ 时，$C^+$ 是一个N元Copula函数，但是当 $N&gt;2$ 时， $C^-$ 并不是一个Copula函数</li>
<li>若 $U_i\sim U(0,1)(i=1,2,…,N)$ 相互独立，则 $C(u_1,u_2,…,u<em>N)={\displaystyle \prod </em>{i=1}^N{u_i}}$</li>
</ul>
</blockquote>
<h1 id="MATLAB常用Copula函数"><a href="#MATLAB常用Copula函数" class="headerlink" title="MATLAB常用Copula函数"></a>MATLAB常用Copula函数</h1><h2 id="copulafit"><a href="#copulafit" class="headerlink" title="copulafit"></a><a href="http://cn.mathworks.com/help/stats/copulafit.html?s_tid=srchtitle" target="_blank" rel="external">copulafit</a></h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%估计正态Copula中的参数</span></div><div class="line"><span class="number">1.</span> RHOHAT=copulafit(<span class="string">'Gaussian'</span>,U)</div><div class="line"><span class="comment">%估计t-Copula中的参数</span></div><div class="line"><span class="number">2.</span> [RHOHAT,nuhat]=copulafit(<span class="string">'t'</span>,U)</div><div class="line"><span class="number">3.</span> [RHOHAT,nuhat,nuci]=copulafit(<span class="string">'t'</span>,U)</div><div class="line"><span class="comment">%估计二元阿基米德Copula中的参数（包括Clayton，Frank，Gumbel）</span></div><div class="line"><span class="number">4.</span> paramhat=copulafit(family,U)</div><div class="line"><span class="number">5.</span> [paramhat,paramci]=copulafit(family,U)</div><div class="line">...</div></pre></td></tr></table></figure>
<h2 id="copulastat"><a href="#copulastat" class="headerlink" title="copulastat"></a><a href="http://cn.mathworks.com/help/stats/copulastat.html" target="_blank" rel="external">copulastat</a></h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%计算正态Copula对应的Kendall秩相关系数</span></div><div class="line"><span class="number">1.</span> R=copulastat(<span class="string">'Gaussian'</span>,rho)</div><div class="line"><span class="comment">%计算t-Copula对应的Kendall秩相关系数</span></div><div class="line"><span class="number">2.</span> R=copulastat(<span class="string">'t'</span>,rho,NU)</div><div class="line"><span class="comment">%计算二元阿基米德Copula对应的Kendall秩相关系数（family字段可选Clayton，Frank，Gumbel）</span></div><div class="line"><span class="number">3.</span> R=copulastat(family,alpha)</div><div class="line"><span class="comment">%计算由type参数制定的秩相关系数R可选字段为'Kendall','Spearman'</span></div><div class="line"><span class="number">4.</span> R=copulastat(...,<span class="string">'type'</span>,type)</div></pre></td></tr></table></figure>
<h2 id="copulaparam"><a href="#copulaparam" class="headerlink" title="copulaparam"></a><a href="http://cn.mathworks.com/help/stats/copulaparam.html" target="_blank" rel="external">copulaparam</a></h2><p><em>根据秩相关系数求解Copula中的 $\rho$ 或 $\alpha$</em><br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">%计算正态Copula中的线性相关参数ρ</span></div><div class="line"><span class="number">1.</span> rho=copulaparam(<span class="string">'Gaussian'</span>,R)</div><div class="line"><span class="comment">%计算t-Copula中的线性相关参数ρ</span></div><div class="line"><span class="number">2.</span> rho=copulaparam(<span class="string">'t'</span>,R,NU)</div><div class="line"><span class="comment">%计算二元阿基米德Copula中的参数α</span></div><div class="line"><span class="number">3.</span> alpha=copulaparam(family,R)</div><div class="line"><span class="comment">%用type参数指定秩相关系数的类型</span></div><div class="line"><span class="number">4.</span> [...]=copulaparam(...,<span class="string">'type'</span>,type)</div></pre></td></tr></table></figure></p>
<h2 id="copulapdf"><a href="#copulapdf" class="headerlink" title="copulapdf"></a><a href="http://cn.mathworks.com/help/stats/copulapdf.html?searchHighlight=copulapdf&amp;s_tid=doc_srchtitle" target="_blank" rel="external">copulapdf</a></h2><p><em>用于计算Copula的密度函数值</em><br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span> y = copulapdf(<span class="string">'Gaussian'</span>,u,rho)</div><div class="line"><span class="number">2.</span> y = copulapdf(<span class="string">'t'</span>,u,rho,nu)</div><div class="line"><span class="number">3.</span> y = copulapdf(family,u,alpha)</div></pre></td></tr></table></figure></p>
<h2 id="copulacdf"><a href="#copulacdf" class="headerlink" title="copulacdf"></a><a href="http://cn.mathworks.com/help/stats/copulacdf.html" target="_blank" rel="external">copulacdf</a></h2><p><em>用于计算Copula分布函数值</em><br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span> y = copulacdf(<span class="string">'Gaussian'</span>,u,rho)</div><div class="line"><span class="number">2.</span> y = copulacdf(<span class="string">'t'</span>,u,rho,nu)</div><div class="line"><span class="number">3.</span> y = copulacdf(family,u,alpha)</div></pre></td></tr></table></figure></p>
<p><strong>PS:双参数威布尔分布常用函数：<a href="http://cn.mathworks.com/help/stats/wblfit.html?searchHighlight=wblfit&amp;s_tid=doc_srchtitle" target="_blank" rel="external">wblfit</a>,<a href="http://cn.mathworks.com/help/stats/wblpdf.html?searchHighlight=wblpdf&amp;s_tid=doc_srchtitle" target="_blank" rel="external">wblpdf</a>,<a href="http://cn.mathworks.com/help/stats/wblcdf.html?searchHighlight=wblcdf&amp;s_tid=doc_srchtitle" target="_blank" rel="external">wblcdf</a></strong></p>
<h1 id="Copula经验分布函数的求取"><a href="#Copula经验分布函数的求取" class="headerlink" title="Copula经验分布函数的求取"></a>Copula经验分布函数的求取</h1><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">% 调用ecdf函数求X和Y的经验分布函数</span></div><div class="line">[fx, Xsort] = ecdf(X);</div><div class="line">[fy, Ysort] = ecdf(Y);</div><div class="line"><span class="comment">% 调用spline函数，利用样条插值法求原始样本点处的经验分布函数值</span></div><div class="line">U = spline(Xsort(<span class="number">2</span>:<span class="keyword">end</span>),fx(<span class="number">2</span>:<span class="keyword">end</span>),X);</div><div class="line">V = spline(Ysort(<span class="number">2</span>:<span class="keyword">end</span>),fy(<span class="number">2</span>:<span class="keyword">end</span>),Y);</div><div class="line"><span class="comment">% 定义经验Copula函数C(u,v)</span></div><div class="line">C = @(u,v)mean((U &lt;= u).*(V &lt;= v));</div><div class="line"><span class="comment">% 为作图的需要，产生新的网格数据</span></div><div class="line">[Udata,Vdata] = <span class="built_in">meshgrid</span>(<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">31</span>));</div><div class="line"><span class="comment">% 通过循环计算经验Copula函数在新产生的网格点处的函数值</span></div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(Udata)</div><div class="line">    CopulaEmpirical(<span class="built_in">i</span>) = C(Udata(<span class="built_in">i</span>),Vdata(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">figure;  <span class="comment">% 新建图形窗口</span></div><div class="line"><span class="comment">% 绘制经验Copula分布函数图像</span></div><div class="line">surf(Udata,Vdata,<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)))</div><div class="line">xlabel(<span class="string">'U'</span>);  <span class="comment">% 为X轴加标签</span></div><div class="line">ylabel(<span class="string">'V'</span>);  <span class="comment">% 为Y轴加标签</span></div><div class="line">zlabel(<span class="string">'Empirical Copula C(u,v)'</span>);  <span class="comment">% 为z轴加标签</span></div><div class="line"></div><div class="line"><span class="comment">% 通过循环计算经验Copula函数在原始样本点处的函数值</span></div><div class="line">CUV = <span class="built_in">zeros</span>(<span class="built_in">size</span>(U(:)));</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(U)</div><div class="line">    CUV(<span class="built_in">i</span>) = C(U(<span class="built_in">i</span>),V(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;amp;filter=sc_long_sign&amp;amp;tn=SE_xueshusource_2kduw22v&amp;amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;amp;ie=utf-8&amp;amp;sc_us=15886197312218780659&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;1&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;二元Copula函数的定义以及性质&quot;&gt;&lt;a href=&quot;#二元Copula函数的定义以及性质&quot; class=&quot;headerlink&quot; title=&quot;二元Copula函数的定义以及性质&quot;&gt;&lt;/a&gt;二元Copula函数的定义以及性质&lt;/h1&gt;&lt;h2 id=&quot;定义&quot;&gt;&lt;a href=&quot;#定义&quot; class=&quot;headerlink&quot; title=&quot;定义:&quot;&gt;&lt;/a&gt;&lt;strong&gt;定义:&lt;/strong&gt;&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;二元Copula函数是指满足以下性质的函数$C(u,v)$:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$C(u,v)$ 的定义域为[0,1]x[0,1]；&lt;/li&gt;
&lt;li&gt;$C(u,v)$ 有零基面，并且是二维递增的；&lt;/li&gt;
&lt;li&gt;对任意$u,v\in [0,1]$，满足$C(u,1)=u，C(1,v)=v$。&lt;br&gt;所谓的有零基面是：至少存在一个$u_0\in[0,1]$ 和一个$v_0\in[0,1]$，使得$C(u_0,v)=0=C(u,v_0)$。&lt;br&gt;二维递增是指：对任意$0\le u_1\le u_2\le1$和$0\le v_1\le v_2\le1$，有&lt;br&gt;$$C(u_2,v_2)-C(u_2,v_1)-C(u_1,v_2)+C(u_1,v_1)\ge 0$$&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="Copula" scheme="http://fatelancer.github.io/tags/Copula/"/>
    
      <category term="MATLAB" scheme="http://fatelancer.github.io/tags/MATLAB/"/>
    
  </entry>
  
  <entry>
    <title>Copula风速建模相关（1）——相关参数</title>
    <link href="http://fatelancer.github.io/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/"/>
    <id>http://fatelancer.github.io/2017/02/27/Copula风速建模相关（1）/</id>
    <published>2017-02-27T05:57:21.000Z</published>
    <updated>2017-03-01T08:47:55.165Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Copula函数的拟合优度校验——与经验Copula函数对比"><a href="#Copula函数的拟合优度校验——与经验Copula函数对比" class="headerlink" title="Copula函数的拟合优度校验——与经验Copula函数对比"></a>Copula函数的拟合优度校验——与经验Copula函数对比</h1><blockquote>
<p><strong>QQ图（Q-QNorm）</strong><br>把数据的分位数与已知分布相比较，从而来判断数据的分布情况。把已知分布的分位数标在纵轴上，样本分位数标在横轴上，从图形上可以了解到分布的信息。图形是直线说明是正态分布。图形中有一段是直线，在两端存在弧度，说明峰度的情况。</p>
<ul>
<li>图形是曲线图，说明不对称。</li>
<li>如果Q-Q图是直线，当该直线成45度角并穿过原点时，说明分布与给定的正态分布完全一样。</li>
<li>如果是成45度角但不穿过原点，说明均值与给定的正态分布不同</li>
<li>如果是直线但不是45度角，说明均值与方差都与给定的分布不同。</li>
<li>如果Q-Q图中间部分是直线，但是右边在直线下面，左边在直线上面，说明分布的峰度大于3，反之说明峰度小于3.<a id="more"></a>
</li>
</ul>
<p><a href="http://m.blog.csdn.net/article/details?id=52794839" target="_blank" rel="external"><strong>K-S检验法（Kolmogorov-Smirnov test）</strong></a><br>检验数据是否符合某种分布\<br>Kolmogorov-Smirnov是比较一个频率分布f(x)与理论分布g(x)或者两个观测值分布的检验方法。其原假设H0:两个数据分布一致或者数据符合理论分布。 $D=max| f(x)- g(x)|$ ，当实际观测值D&gt;D(n,α)则拒绝H0，否则则接受H0假设。\<br>KS检验与t-检验之类的其他方法不同是KS检验不需要知道数据的分布情况，可以算是一种非参数检验方法。当然这样方便的代价就是当检验的数据分布符合特定的分布事，KS检验的灵敏度没有相应的检验来的高。在样本量比较小的时候，KS检验最为非参数检验在分析两组数据之间是否不同时相当常用。\<br>PS：t-检验的假设是检验的数据满足正态分布，否则对于小样本不满足正态分布的数据用t-检验就会造成较大的偏差，虽然对于大样本不满足正态分布的数据而言t-检验还是相当精确有效的手段。\<br>本例中使用kstest2函数</p>
</blockquote>
<h1 id="对风电场风速进行处理——双参数威布尔分布"><a href="#对风电场风速进行处理——双参数威布尔分布" class="headerlink" title="对风电场风速进行处理——双参数威布尔分布"></a>对风电场风速进行处理——双参数威布尔分布</h1><p>双参数威布尔函数<br>$$F_w(x)=1-exp(-({x \over c})^k)$$<br>其概率密度函数为<br>$$P(x)={k \over c} ({k \over c})^{k-1}exp(-({x \over c})^k)$$<br>式中 $k$ 为形状参数，无量纲； $c$ 为尺度参数，反映风电场的平均风速，单位为 $m/s$ 。</p>
<h1 id="Pearson相关系数"><a href="#Pearson相关系数" class="headerlink" title="Pearson相关系数"></a><a href="http://blog.csdn.net/wsywl/article/details/5727327" target="_blank" rel="external">Pearson相关系数</a></h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>皮尔逊相关也称为积差相关（或积矩相关）是英国统计学家皮尔逊于20世纪提出的一种计算直线相关的方法。在本例中主要用于对两组风速曲线的相关性进行表示</p>
<p>假设有两个变量X、Y，那么两变量间的皮尔逊相关系数可通过以下公式计算：</p>
<p>公式一：</p>
<p>$$ \rho_{X,Y}={cov(X,Y) \over \sigma_X \sigma_Y}={E((X-\mu_X)(Y-\mu_Y))\over  \sigma_X \sigma_Y}={E(XY)-E(X)E(Y)\over \sqrt{E(X^2)-E^2(X)}\sqrt{E(Y^2)-E^2(Y)}}$$</p>
<p>公式二：</p>
<p>$$\rho_{X,Y}={N\sum{XY}-\sum{X} \sum{Y} \over\sqrt{N\sum{X^2}-(\sum{X})^2}\sqrt{N\sum{Y^2}-(\sum{Y})^2}}$$</p>
<p>公式三：</p>
<p>$$\rho_{X,Y}={\sum(X-\overline{X})(Y-\overline{Y}) \over\sqrt{\sum(X-\overline{X})^2\sum(Y-\overline{Y})^2}}$$</p>
<p>公式四：</p>
<p>$$\rho_{X,Y}={\sum{XY}-{\sum{X}\sum{Y}\over N}\over\sqrt{(\sum{X^2}-{(\sum{X})^2\over N})}\sqrt{(\sum{Y^2}-{(\sum{Y})^2\over N})}}$$</p>
<p>以上列出的四个公式等价，其中E是数学期望，cov表示协方差，N表示变量取值的个数。</p>
<h2 id="适用范围"><a href="#适用范围" class="headerlink" title="适用范围"></a>适用范围</h2><p>当两个变量的标准差都不为零时，相关系数才有定义，皮尔逊相关系数适用于：</p>
<ol>
<li><p>两个变量之间是线性关系，都是连续数据。</p>
</li>
<li><p>两个变量的总体是正态分布，或接近正态的单峰分布。</p>
</li>
<li><p>两个变量的观测值是成对的，每对观测值之间相互独立。</p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Copula函数的拟合优度校验——与经验Copula函数对比&quot;&gt;&lt;a href=&quot;#Copula函数的拟合优度校验——与经验Copula函数对比&quot; class=&quot;headerlink&quot; title=&quot;Copula函数的拟合优度校验——与经验Copula函数对比&quot;&gt;&lt;/a&gt;Copula函数的拟合优度校验——与经验Copula函数对比&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;QQ图（Q-QNorm）&lt;/strong&gt;&lt;br&gt;把数据的分位数与已知分布相比较，从而来判断数据的分布情况。把已知分布的分位数标在纵轴上，样本分位数标在横轴上，从图形上可以了解到分布的信息。图形是直线说明是正态分布。图形中有一段是直线，在两端存在弧度，说明峰度的情况。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;图形是曲线图，说明不对称。&lt;/li&gt;
&lt;li&gt;如果Q-Q图是直线，当该直线成45度角并穿过原点时，说明分布与给定的正态分布完全一样。&lt;/li&gt;
&lt;li&gt;如果是成45度角但不穿过原点，说明均值与给定的正态分布不同&lt;/li&gt;
&lt;li&gt;如果是直线但不是45度角，说明均值与方差都与给定的分布不同。&lt;/li&gt;
&lt;li&gt;如果Q-Q图中间部分是直线，但是右边在直线下面，左边在直线上面，说明分布的峰度大于3，反之说明峰度小于3.
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="可再生能源" scheme="http://fatelancer.github.io/tags/%E5%8F%AF%E5%86%8D%E7%94%9F%E8%83%BD%E6%BA%90/"/>
    
      <category term="Copula" scheme="http://fatelancer.github.io/tags/Copula/"/>
    
      <category term="双参数威布尔函数" scheme="http://fatelancer.github.io/tags/%E5%8F%8C%E5%8F%82%E6%95%B0%E5%A8%81%E5%B8%83%E5%B0%94%E5%87%BD%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>基于Copula理论的风电场间建模</title>
    <link href="http://fatelancer.github.io/2017/02/21/%E5%9F%BA%E4%BA%8ECopula%E7%90%86%E8%AE%BA%E7%9A%84%E9%A3%8E%E7%94%B5%E5%9C%BA%E9%97%B4%E5%BB%BA%E6%A8%A1/"/>
    <id>http://fatelancer.github.io/2017/02/21/基于Copula理论的风电场间建模/</id>
    <published>2017-02-21T02:22:19.000Z</published>
    <updated>2017-06-30T04:30:45.475Z</updated>
    
    <content type="html"><![CDATA[<h1 id="关于研究目的"><a href="#关于研究目的" class="headerlink" title="关于研究目的"></a>关于研究目的</h1><p>由于风电基地的多个风电场地理位置比较靠近，且基本处于同一风带，风速之间具有较强的相关性，使得多个风电场的总体特性不同于单个风电场的特性。</p>
<p>通过Copula理论进行多个风电场风俗的联合概率分布研究。<br><a id="more"></a></p>
<h1 id="Copula理论"><a href="#Copula理论" class="headerlink" title="Copula理论"></a>Copula理论</h1><h2 id="关于Copula函数"><a href="#关于Copula函数" class="headerlink" title="关于Copula函数"></a>关于Copula函数</h2><p>Copula函数在网络中所能检索到的信息</p>
<blockquote>
<p><strong><a href="http://baike.baidu.com/link?url=qvRvG5X9bS0pqQzhZ7WtPKjmalr9UxgsV8kHdMbNFxPePq4CemrnaHF3c6-9g8Ihdw_9RyfSHJtHnw0uyLeGKCZv2In40VEqDCbmQrvQ5Zk4sbjreZggZCwwgpedrK8j" target="_blank" rel="external">Copula函数</a>百度</strong><br>Copula函数描述的是变量间的相关性，实际上是一类将联合分布函数与它们各自的边缘分布函数连接在一起的函数，因此也有人将它称为连接函数。相关理论的提出可以追溯到1959年，SKlar通过定理形式将多元分布与Copula函数联系起来。\<br>20世纪90年代后期相关理论和方法在国外开始得到迅速发展并应用到金融，保险等领域的相关分析，投资组合分析和风险管理等多个方面。\<br>定义:(Nelsen.2006) N 元Copula函数是指具有以下性质的函数（下记为C）：\<br>（1）定义域为[0,1]×[0,1]×。。。×[0,1] （共为N个域相乘）；\<br>（2）C具有零基面（grounded）且是N维递增的；\<br>（3）C的边缘分布Cn，n=1,2,,,,N,满足Cn(xn)=C(1,…,1,xn,1,,,1)=xn，其中xn∈[0,1],n=1,2,,,N \</p>
<p>CopulaWIKI</p>
</blockquote>
<p><a href="http://oag5ozkgs.bkt.clouddn.com/02211106461%E8%80%A6%E5%90%88%28%E6%A6%82%E7%8E%87%29-%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91%EF%BC%8C%E8%87%AA%E7%94%B1%E7%9A%84%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6_1.Png" target="_blank" rel="external">1</a><br><a href="http://oag5ozkgs.bkt.clouddn.com/02211106461%E8%80%A6%E5%90%88%28%E6%A6%82%E7%8E%87%29-%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91%EF%BC%8C%E8%87%AA%E7%94%B1%E7%9A%84%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6_2.Png" target="_blank" rel="external">2</a><br><a href="http://oag5ozkgs.bkt.clouddn.com/02211106461%E8%80%A6%E5%90%88%28%E6%A6%82%E7%8E%87%29-%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91%EF%BC%8C%E8%87%AA%E7%94%B1%E7%9A%84%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6_3.Png" target="_blank" rel="external">3</a></p>
<p><strong>要点：</strong></p>
<ul>
<li>边缘分布与联合分布的概念</li>
<li>关于风速的概率分布问题</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;关于研究目的&quot;&gt;&lt;a href=&quot;#关于研究目的&quot; class=&quot;headerlink&quot; title=&quot;关于研究目的&quot;&gt;&lt;/a&gt;关于研究目的&lt;/h1&gt;&lt;p&gt;由于风电基地的多个风电场地理位置比较靠近，且基本处于同一风带，风速之间具有较强的相关性，使得多个风电场的总体特性不同于单个风电场的特性。&lt;/p&gt;
&lt;p&gt;通过Copula理论进行多个风电场风俗的联合概率分布研究。&lt;br&gt;
    
    </summary>
    
      <category term="毕业设计" scheme="http://fatelancer.github.io/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="可再生能源" scheme="http://fatelancer.github.io/tags/%E5%8F%AF%E5%86%8D%E7%94%9F%E8%83%BD%E6%BA%90/"/>
    
      <category term="Copula" scheme="http://fatelancer.github.io/tags/Copula/"/>
    
  </entry>
  
  <entry>
    <title>Java 第二次课</title>
    <link href="http://fatelancer.github.io/2016/10/23/javaclass2/"/>
    <id>http://fatelancer.github.io/2016/10/23/javaclass2/</id>
    <published>2016-10-22T16:00:00.000Z</published>
    <updated>2016-10-22T16:17:51.452Z</updated>
    
    <content type="html"><![CDATA[<h1 id="封装继承多态"><a href="#封装继承多态" class="headerlink" title="封装继承多态"></a>封装继承多态</h1><a id="more"></a>
<h2 id="1-父类"><a href="#1-父类" class="headerlink" title="1. 父类"></a>1. 父类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Class_1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fatel on 2016/5/8.</div><div class="line"> */</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Robot</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> String r_id;</div><div class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> speed;</div><div class="line">    <span class="comment">//private double temp;</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Robot</span><span class="params">()</span></span>&#123;</div><div class="line">        r_id = JOptionPane.showInputDialog(<span class="keyword">null</span>,</div><div class="line">                <span class="string">"r_id = "</span>,</div><div class="line">                <span class="string">"请输入ID"</span>,</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        );</div><div class="line">        speed = Integer.parseInt( JOptionPane.showInputDialog(<span class="keyword">null</span>,</div><div class="line">                <span class="string">"speed = "</span>,</div><div class="line">                <span class="string">"请输入速度"</span>,</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        ));</div><div class="line">        <span class="comment">/*temp = Double.parseDouble(JOptionPane.showInputDialog(null,</span></div><div class="line">                "temp = ",</div><div class="line">                "请输入温度",</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        ));*/</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (speed&gt;<span class="number">120</span>)&#123;</div><div class="line">            speed = <span class="number">115</span>;</div><div class="line">            <span class="keyword">return</span> <span class="string">"您超速了"</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="comment">//speed = 40;</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"您的速度正常"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></div><div class="line">                <span class="string">"r_id = "</span>+r_id+<span class="string">"\n"</span>+<span class="string">"speed = "</span>+speed +<span class="string">"\n"</span> <span class="comment">/*+ "temp = "+temp+"\n"*/</span>+ judge() + <span class="string">"\n"</span>,</div><div class="line">                <span class="string">"机器人信息"</span>,</div><div class="line">                JOptionPane.INFORMATION_MESSAGE</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="2-子类"><a href="#2-子类" class="headerlink" title="2. 子类"></a>2. 子类</h2><p>###2.1 子类1（WarRobot）<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Class_1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fatel on 2016/5/8.</div><div class="line"> */</div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">WarRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> weapon_count;</div><div class="line">    <span class="comment">//private String r_id;</span></div><div class="line">    <span class="comment">//private int speed;</span></div><div class="line">    <span class="comment">//private double temp;</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WarRobot</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">        weapon_count = Integer.parseInt(JOptionPane.showInputDialog(<span class="keyword">null</span>,</div><div class="line">                <span class="string">"weapon_count = "</span>,</div><div class="line">                <span class="string">"请输入武器数量"</span>,</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        ));</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (weapon_count &gt; <span class="number">10</span>) &#123;</div><div class="line">            speed = <span class="number">200</span>;</div><div class="line">            <span class="keyword">return</span> <span class="string">"您是战神"</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">//speed = 40;</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"您是菜鸟"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></div><div class="line">                <span class="string">"r_id = "</span> + r_id + <span class="string">"\n"</span> + <span class="string">"speed = "</span> + speed + <span class="string">"\n"</span> + <span class="string">"weapon_count = "</span> + weapon_count + <span class="string">"\n"</span> + judge() + <span class="string">"\n"</span>,</div><div class="line">                <span class="string">"战斗机器人信息"</span>,</div><div class="line">                JOptionPane.INFORMATION_MESSAGE</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>###2.2 子类2（HomeRobot）<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Class_1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fatel on 2016/5/8.</div><div class="line"> */</div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">HomeRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> skill_count;</div><div class="line">    <span class="comment">//protected String r_id;</span></div><div class="line">    <span class="comment">//protected int speed;</span></div><div class="line">    <span class="comment">//private double temp;</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HomeRobot</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">        skill_count = Integer.parseInt(JOptionPane.showInputDialog(<span class="keyword">null</span>,</div><div class="line">                <span class="string">"skill_count = "</span>,</div><div class="line">                <span class="string">"请输入技能数"</span>,</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        ));</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (skill_count&gt;<span class="number">5</span>)&#123;</div><div class="line">           <span class="comment">// speed = 115;</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"你是家务大师"</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="comment">//speed = 40;</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"您是家务菜鸟"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">super</span>.output();</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></div><div class="line">                <span class="string">"skill_count = "</span>+skill_count+<span class="string">"\n"</span>+ judge() + <span class="string">"\n"</span>,</div><div class="line">                <span class="string">"机器人信息"</span>,</div><div class="line">                JOptionPane.INFORMATION_MESSAGE</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>###2.3 UML类图<br><img src="https://github.com/fatelancer/robot_class/blob/master/src/Class_1/uml.png" alt=""></p>
<p>#抽象类</p>
<p>##1. 父类抽象类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Class_1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fatel on 2016/5/8.</div><div class="line"> */</div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Robot</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> String r_id;</div><div class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> speed;</div><div class="line">    <span class="comment">//private double temp;</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Robot</span><span class="params">()</span></span>&#123;</div><div class="line">        r_id = JOptionPane.showInputDialog(<span class="keyword">null</span>,</div><div class="line">                <span class="string">"r_id = "</span>,</div><div class="line">                <span class="string">"请输入ID"</span>,</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        );</div><div class="line">        speed = Integer.parseInt( JOptionPane.showInputDialog(<span class="keyword">null</span>,</div><div class="line">                <span class="string">"speed = "</span>,</div><div class="line">                <span class="string">"请输入速度"</span>,</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        ));</div><div class="line">        <span class="comment">/*temp = Double.parseDouble(JOptionPane.showInputDialog(null,</span></div><div class="line">                "temp = ",</div><div class="line">                "请输入温度",</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        ));*/</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (speed&gt;<span class="number">120</span>)&#123;</div><div class="line">            speed = <span class="number">115</span>;</div><div class="line">            <span class="keyword">return</span> <span class="string">"您超速了"</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="comment">//speed = 40;</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"您的速度正常"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></div><div class="line">                <span class="string">"r_id = "</span>+r_id+<span class="string">"\n"</span>+<span class="string">"speed = "</span>+speed +<span class="string">"\n"</span> <span class="comment">/*+ "temp = "+temp+"\n"*/</span>+ judge() + <span class="string">"\n"</span>,</div><div class="line">                <span class="string">"机器人信息"</span>,</div><div class="line">                JOptionPane.INFORMATION_MESSAGE</div><div class="line">        );</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="keyword">abstract</span> <span class="title">run</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>##2.子类</p>
<p>###2.1 子类1<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Class_1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fatel on 2016/5/8.</div><div class="line"> */</div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">WarRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> weapon_count;</div><div class="line">    <span class="comment">//private String r_id;</span></div><div class="line">    <span class="comment">//private int speed;</span></div><div class="line">    <span class="comment">//private double temp;</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WarRobot</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">        weapon_count = Integer.parseInt(JOptionPane.showInputDialog(<span class="keyword">null</span>,</div><div class="line">                <span class="string">"weapon_count = "</span>,</div><div class="line">                <span class="string">"请输入武器数量"</span>,</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        ));</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (weapon_count &gt; <span class="number">10</span>) &#123;</div><div class="line">            speed = <span class="number">200</span>;</div><div class="line">            <span class="keyword">return</span> <span class="string">"您是战神"</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">//speed = 40;</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"您是菜鸟"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></div><div class="line">                <span class="string">"r_id = "</span> + r_id + <span class="string">"\n"</span> + <span class="string">"speed = "</span> + speed + <span class="string">"\n"</span> + <span class="string">"weapon_count = "</span> + weapon_count + <span class="string">"\n"</span> + judge() + <span class="string">"\n"</span>,</div><div class="line">                <span class="string">"战斗机器人信息"</span>,</div><div class="line">                JOptionPane.INFORMATION_MESSAGE</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">		System.out.println(<span class="string">"我像风一样的奔跑"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>###2.2 子类2（HomeRobot）<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Class_1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fatel on 2016/5/8.</div><div class="line"> */</div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">HomeRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> skill_count;</div><div class="line">    <span class="comment">//protected String r_id;</span></div><div class="line">    <span class="comment">//protected int speed;</span></div><div class="line">    <span class="comment">//private double temp;</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HomeRobot</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">        skill_count = Integer.parseInt(JOptionPane.showInputDialog(<span class="keyword">null</span>,</div><div class="line">                <span class="string">"skill_count = "</span>,</div><div class="line">                <span class="string">"请输入技能数"</span>,</div><div class="line">                JOptionPane.QUESTION_MESSAGE</div><div class="line">        ));</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (skill_count&gt;<span class="number">5</span>)&#123;</div><div class="line">           <span class="comment">// speed = 115;</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"你是家务大师"</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="comment">//speed = 40;</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"您是家务菜鸟"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">super</span>.output();</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></div><div class="line">                <span class="string">"skill_count = "</span>+skill_count+<span class="string">"\n"</span>+ judge() + <span class="string">"\n"</span>,</div><div class="line">                <span class="string">"机器人信息"</span>,</div><div class="line">                JOptionPane.INFORMATION_MESSAGE</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">		System.out.println(<span class="string">"我像仙女一样在飘"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>##3. 运行程序<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Class_1;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fatel on 2016/5/8.</div><div class="line"> */</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainProg</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span> <span class="params">(String [] args)</span></span>&#123;<span class="comment">// 命令行运行输入的参数</span></div><div class="line">        Robot r1;<span class="comment">//为超类Robot新建一个引用</span></div><div class="line"></div><div class="line">        WarRobot wr = <span class="keyword">new</span> WarRobot();</div><div class="line">        wr.output();</div><div class="line"></div><div class="line">        HomeRobot hr = <span class="keyword">new</span> HomeRobot();</div><div class="line">        hr.output();</div><div class="line">		<span class="comment">//将超类Robot的引用r1指向子类WarRobot的对象wr</span></div><div class="line">		r1 = wr;</div><div class="line">		r1.run();</div><div class="line"></div><div class="line">		r1 = hr;</div><div class="line">		r1.run();</div><div class="line"></div><div class="line">		<span class="comment">//Robot r1 = new WarRobot();</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>#接口</p>
<p>##1. 接口<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Program;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Robot</span> </span>&#123;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> SPEED=<span class="number">100</span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">walk</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Program;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MusicRobot</span> </span>&#123;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> PLAY_KINDS=<span class="number">10</span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Program;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WarRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span></span>&#123;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> WEAPON_COUNT=<span class="number">15</span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">war</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Program;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HomeRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span></span>&#123;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> SKILL_COUNT=<span class="number">8</span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">cook</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>##2. 子类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Program;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuperRobot</span> <span class="keyword">implements</span> <span class="title">HomeRobot</span>,<span class="title">WarRobot</span>,<span class="title">MusicRobot</span></span>&#123;</div><div class="line">	<span class="keyword">private</span> String id;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> SuperAbility;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SuperRobot</span><span class="params">(String i,<span class="keyword">int</span> s)</span></span>&#123;</div><div class="line">		id=i;</div><div class="line">		SuperAbility=s;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">judge</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">if</span> (SuperAbility&gt;<span class="number">120</span>)&#123;</div><div class="line">			System.out.println(<span class="string">"您太厉害了"</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			System.out.println(<span class="string">"您还需要继续修炼"</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cook</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		System.out.println(<span class="string">"I can cook!"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">walk</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		System.out.println(<span class="string">"I can walk!"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">war</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		System.out.println(<span class="string">"I can war!"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		System.out.println(<span class="string">"I can play instruments!"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</div><div class="line">		System.out.println(<span class="string">"id="</span>+id+<span class="string">"\nSuperAbility="</span>+SuperAbility);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>##3. 执行程序<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Program;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainProgram</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * <span class="doctag">@param</span> args</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		SuperRobot r=<span class="keyword">new</span> SuperRobot(<span class="string">"r001"</span>,<span class="number">10</span>);</div><div class="line">		r.judge();</div><div class="line">		r.walk();</div><div class="line">		r.war();</div><div class="line">		r.cook();</div><div class="line">		r.play();</div><div class="line">		r.output();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>##4. UML图<br><img src="https://github.com/fatelancer/robot_class/blob/master/src/Program/diagram.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;封装继承多态&quot;&gt;&lt;a href=&quot;#封装继承多态&quot; class=&quot;headerlink&quot; title=&quot;封装继承多态&quot;&gt;&lt;/a&gt;封装继承多态&lt;/h1&gt;
    
    </summary>
    
      <category term="Java" scheme="http://fatelancer.github.io/categories/Java/"/>
    
    
  </entry>
  
  <entry>
    <title>Java第三次课</title>
    <link href="http://fatelancer.github.io/2016/10/23/javaclass3/"/>
    <id>http://fatelancer.github.io/2016/10/23/javaclass3/</id>
    <published>2016-10-22T16:00:00.000Z</published>
    <updated>2017-02-21T02:03:17.069Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GUI设计"><a href="#GUI设计" class="headerlink" title="GUI设计"></a>GUI设计</h1><a id="more"></a>
<h2 id="1-框架"><a href="#1-框架" class="headerlink" title="1. 框架"></a>1. 框架</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> AreaCalculate;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</div><div class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fatel on 2016/5/14.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CircleArea</span> <span class="keyword">extends</span> <span class="title">JFrame</span> <span class="keyword">implements</span> <span class="title">ActionListener</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CircleArea</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span></span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="2-主界面"><a href="#2-主界面" class="headerlink" title="2. 主界面"></a>2. 主界面</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">CircleArea ca = <span class="keyword">new</span> CircleArea();</div><div class="line">ca.setTitle(<span class="string">"圆面积的计算"</span>);</div><div class="line">ca.setBounds(<span class="number">400</span>,<span class="number">300</span>,<span class="number">280</span>,<span class="number">180</span>);</div><div class="line">ca.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</div><div class="line">ca.setVisible(<span class="keyword">true</span>);</div></pre></td></tr></table></figure>
<h2 id="3-搭建面板"><a href="#3-搭建面板" class="headerlink" title="3. 搭建面板"></a>3. 搭建面板</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">JPanel p0 = <span class="keyword">new</span> JPanel();</div><div class="line">JPanel p1 = <span class="keyword">new</span> JPanel();</div><div class="line">JPanel p2 = <span class="keyword">new</span> JPanel();</div><div class="line">JPanel p3 = <span class="keyword">new</span> JPanel();</div><div class="line"></div><div class="line">JLabel l0 = <span class="keyword">new</span> JLabel(<span class="string">"圆面积计算系统"</span>, JLabel.CENTER);</div><div class="line">JLabel l1 = <span class="keyword">new</span> JLabel(<span class="string">"请输入圆的半径："</span>, JLabel.CENTER);</div><div class="line">JLabel l2 = <span class="keyword">new</span> JLabel(<span class="string">"圆的面积是："</span>, JLabel.CENTER);</div><div class="line"></div><div class="line">JTextField t1 = <span class="keyword">new</span> JTextField(<span class="number">10</span>);</div><div class="line">JTextField t2 = <span class="keyword">new</span> JTextField(<span class="number">10</span>);</div><div class="line"></div><div class="line">JButton b1 = <span class="keyword">new</span> JButton(<span class="string">"计算"</span>);</div><div class="line">JButton b2 = <span class="keyword">new</span> JButton(<span class="string">"清空"</span>);</div></pre></td></tr></table></figure>
<h2 id="4-面板布局"><a href="#4-面板布局" class="headerlink" title="4. 面板布局"></a>4. 面板布局</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">p1.setLayout(fl);</div><div class="line">p1.setBackground(Color.yellow);</div><div class="line">p1.add(l0);</div><div class="line"></div><div class="line">p2.setLayout(<span class="keyword">new</span> GridLayout(<span class="number">2</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">5</span>));</div><div class="line">p2.setBackground(Color.green);</div><div class="line">p2.add(l1);</div><div class="line">p2.add(t1);</div><div class="line">p2.add(l2);</div><div class="line">t2.setEditable(<span class="keyword">false</span>);<span class="comment">//t2不可编辑</span></div><div class="line">p2.add(t2);</div><div class="line"></div><div class="line">p3.setLayout(<span class="keyword">new</span> FlowLayout(FlowLayout.CENTER, <span class="number">5</span>, <span class="number">5</span>));</div><div class="line">p3.setBackground(Color.pink);</div><div class="line">b1.addActionListener(<span class="keyword">this</span>);</div><div class="line">b2.addActionListener(<span class="keyword">this</span>);<span class="comment">//添加监听器</span></div><div class="line">p3.add(b1);</div><div class="line">p3.add(b2);</div><div class="line"></div><div class="line">p0.add(<span class="string">"North"</span>, p1);</div><div class="line">p0.add(<span class="string">"Center"</span>, p2);</div><div class="line">p0.add(<span class="string">"South"</span>, p3);</div><div class="line"></div><div class="line"><span class="keyword">this</span>.setContentPane(p0);</div></pre></td></tr></table></figure>
<h2 id="5-事件处理"><a href="#5-事件处理" class="headerlink" title="5. 事件处理"></a>5. 事件处理</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (ae.getSource()==b1)&#123;</div><div class="line">        t2.setText(<span class="string">""</span>+<span class="number">3.1415926</span>*Double.parseDouble(t1.getText())*Double.parseDouble(t1.getText()));</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        t1.setText(<span class="string">""</span>);</div><div class="line">        t2.setText(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="6-代码优化"><a href="#6-代码优化" class="headerlink" title="6. 代码优化"></a>6. 代码优化</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">JPanel []p = <span class="keyword">new</span> JPanel[<span class="number">4</span>];</div><div class="line">Color [] c = &#123;Color.red, Color.yellow, Color.green, Color.pink&#125;;</div><div class="line">LayoutManager [] lm = &#123; <span class="keyword">new</span> BorderLayout(<span class="number">5</span>,<span class="number">5</span>),</div><div class="line">                        <span class="keyword">new</span> FlowLayout(FlowLayout.CENTER, <span class="number">5</span>, <span class="number">5</span>),</div><div class="line">                        <span class="keyword">new</span> GridLayout(<span class="number">2</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">5</span>),</div><div class="line">                        <span class="keyword">new</span> FlowLayout(FlowLayout.CENTER, <span class="number">5</span>, <span class="number">5</span>)&#125;;</div><div class="line">String [] str = &#123;<span class="string">"圆面积计算系统"</span>, <span class="string">"请输入圆的半径："</span>, <span class="string">"圆的面积是："</span>&#125;;</div><div class="line"></div><div class="line">JLabel [] l = <span class="keyword">new</span> JLabel[<span class="number">3</span>];</div><div class="line"></div><div class="line">JTextField [] t = <span class="keyword">new</span> JTextField [<span class="number">2</span>];</div><div class="line"></div><div class="line">String [] str1 = &#123;<span class="string">"计算"</span>, <span class="string">"清空"</span>&#125;;</div><div class="line"></div><div class="line">JButton [] b = <span class="keyword">new</span> JButton[<span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">CircleArea</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; p.length;i++)&#123;</div><div class="line">        p[i] = <span class="keyword">new</span> JPanel(lm[i]);</div><div class="line">        p[i].setBackground(c[i]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; l.length;i++)&#123;</div><div class="line">        l[i] = <span class="keyword">new</span> JLabel(str[i], JLabel.CENTER);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; t.length;i++)&#123;</div><div class="line">        t[i] = <span class="keyword">new</span> JTextField(<span class="number">10</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; b.length;i++)&#123;</div><div class="line">        b[i] = <span class="keyword">new</span> JButton(str1[i]);</div><div class="line">        b[i].addActionListener(<span class="keyword">this</span>);</div><div class="line">        p[<span class="number">3</span>].add(b[i]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    p[<span class="number">1</span>].add(l[<span class="number">0</span>]);</div><div class="line"></div><div class="line">    p[<span class="number">2</span>].add(l[<span class="number">1</span>]);</div><div class="line">    p[<span class="number">2</span>].add(t[<span class="number">0</span>]);</div><div class="line">    p[<span class="number">2</span>].add(l[<span class="number">2</span>]);</div><div class="line">    t[<span class="number">1</span>].setEditable(<span class="keyword">false</span>);</div><div class="line">    p[<span class="number">2</span>].add(t[<span class="number">1</span>]);</div><div class="line"></div><div class="line">    p[<span class="number">0</span>].add(<span class="string">"North"</span>, p[<span class="number">1</span>]);</div><div class="line">    p[<span class="number">0</span>].add(<span class="string">"Center"</span>, p[<span class="number">2</span>]);</div><div class="line">    p[<span class="number">0</span>].add(<span class="string">"South"</span>, p[<span class="number">3</span>]);</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.setContentPane(p[<span class="number">0</span>]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="7-异常处理"><a href="#7-异常处理" class="headerlink" title="7. 异常处理"></a>7. 异常处理</h2><p>###7.1 throw<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span> <span class="keyword">throws</span> NumberFormatException</span>&#123;</div><div class="line">    <span class="keyword">if</span> (ae.getSource()==b[<span class="number">0</span>])&#123;</div><div class="line">        area=String.format(<span class="string">"%5f"</span>, <span class="number">3.1415926</span>*Double.parseDouble(t[<span class="number">0</span>].getText())*Double.parseDouble(t[<span class="number">0</span>].getText()));</div><div class="line">        t[<span class="number">1</span>].setText(area);</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        t[<span class="number">0</span>].setText(<span class="string">""</span>);</div><div class="line">        t[<span class="number">1</span>].setText(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="7-2-try-catch"><a href="#7-2-try-catch" class="headerlink" title="7.2 try catch"></a>7.2 try catch</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span> <span class="keyword">throws</span> NumberFormatException</span>&#123;</div><div class="line">    <span class="keyword">try</span>&#123;</div><div class="line">        <span class="keyword">if</span> (ae.getSource()==b[<span class="number">0</span>])&#123;</div><div class="line">            area=String.format(<span class="string">"%5f"</span>, <span class="number">3.1415926</span>*Double.parseDouble(t[<span class="number">0</span>].getText())*Double.parseDouble(t[<span class="number">0</span>].getText()));</div><div class="line">            t[<span class="number">1</span>].setText(area);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            t[<span class="number">0</span>].setText(<span class="string">""</span>);</div><div class="line">            t[<span class="number">1</span>].setText(<span class="string">""</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">catch</span> (NumberFormatException nfe)&#123;</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,</div><div class="line">                nfe.getMessage(),<span class="string">"异常消息"</span>,JOptionPane.ERROR_MESSAGE);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="7-3-异常类"><a href="#7-3-异常类" class="headerlink" title="7.3 异常类"></a>7.3 异常类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span> <span class="keyword">throws</span> NumberFormatException </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">if</span> (ae.getSource() == b[<span class="number">0</span>]) &#123;</div><div class="line">            <span class="keyword">if</span> (t[<span class="number">0</span>].getText().equals(<span class="string">""</span>))&#123;</div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> MyException(<span class="string">"半径不能为空，请重新输入！！！"</span>);</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                area = String.format(<span class="string">"%5f"</span>, <span class="number">3.1415926</span> * Double.parseDouble(t[<span class="number">0</span>].getText()) * Double.parseDouble(t[<span class="number">0</span>].getText()));</div><div class="line">                t[<span class="number">1</span>].setText(area);</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            t[<span class="number">0</span>].setText(<span class="string">""</span>);</div><div class="line">            t[<span class="number">1</span>].setText(<span class="string">""</span>);</div><div class="line">        &#125;</div><div class="line">    &#125; <span class="keyword">catch</span> (MyException me) &#123;</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,</div><div class="line">                me.outExceMessage(), <span class="string">"异常消息"</span>, JOptionPane.ERROR_MESSAGE);</div><div class="line">    &#125;<span class="keyword">catch</span> (NumberFormatException nfe)&#123;</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,</div><div class="line">                <span class="string">"输入不能为非数字，请重新输入"</span>, <span class="string">"异常消息"</span>, JOptionPane.ERROR_MESSAGE);</div><div class="line">        t[<span class="number">0</span>].setText(<span class="string">""</span>);</div><div class="line">        t[<span class="number">1</span>].setText(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyException</span> <span class="keyword">extends</span> <span class="title">NumberFormatException</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String str;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyException</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        str = s;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">outExceMessage</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> str;</div><div class="line">    &#125;</div><div class="line">&#125;<span class="comment">//类中类</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;GUI设计&quot;&gt;&lt;a href=&quot;#GUI设计&quot; class=&quot;headerlink&quot; title=&quot;GUI设计&quot;&gt;&lt;/a&gt;GUI设计&lt;/h1&gt;
    
    </summary>
    
      <category term="Java" scheme="http://fatelancer.github.io/categories/Java/"/>
    
    
  </entry>
  
  <entry>
    <title>Java第四次课</title>
    <link href="http://fatelancer.github.io/2016/10/23/javaclass4/"/>
    <id>http://fatelancer.github.io/2016/10/23/javaclass4/</id>
    <published>2016-10-22T16:00:00.000Z</published>
    <updated>2017-02-21T02:03:14.208Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-基础面板搭建"><a href="#1-基础面板搭建" class="headerlink" title="1. 基础面板搭建"></a>1. 基础面板搭建</h2><a id="more"></a>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> mygame;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</div><div class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fatel on 2016/5/28.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CartoonApp</span> <span class="keyword">extends</span> <span class="title">JFrame</span> <span class="keyword">implements</span> <span class="title">ActionListener</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CartoonApp</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">CartoonPaint</span> <span class="keyword">extends</span> <span class="title">JPanel</span></span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span> <span class="params">(String [] args)</span></span>&#123;</div><div class="line">        CartoonApp ca = <span class="keyword">new</span> CartoonApp();</div><div class="line">        ca.setTitle(<span class="string">"我的第一个动画程序"</span>);</div><div class="line">        ca.setBounds(<span class="number">300</span>,<span class="number">200</span>,<span class="number">400</span>,<span class="number">450</span>);</div><div class="line">        ca.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</div><div class="line">        ca.setVisible(<span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="2-变量定义"><a href="#2-变量定义" class="headerlink" title="2. 变量定义"></a>2. 变量定义</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">JPanel [] pnl = &#123;<span class="keyword">new</span> JPanel(<span class="keyword">new</span> BorderLayout()),</div><div class="line">                    <span class="keyword">new</span> JPanel(<span class="keyword">new</span> FlowLayout()),</div><div class="line">                    <span class="keyword">new</span> JPanel(<span class="keyword">new</span> BorderLayout()),</div><div class="line">                    <span class="keyword">new</span> JPanel(<span class="keyword">new</span> FlowLayout())&#125;;</div><div class="line">    String [] str = &#123;<span class="string">"North"</span>, <span class="string">"Center"</span>, <span class="string">"South"</span>&#125;;</div><div class="line">    JLabel lblTitle = <span class="keyword">new</span> JLabel(<span class="string">"我的第一个动画程序"</span>);</div><div class="line">    JButton [] btn = &#123;<span class="keyword">new</span> JButton(<span class="string">"start"</span>), <span class="keyword">new</span> JButton(<span class="string">"pause"</span>),</div><div class="line">                        <span class="keyword">new</span> JButton(<span class="string">"resume"</span>), <span class="keyword">new</span> JButton(<span class="string">"exit"</span>)&#125;;</div><div class="line">    <span class="keyword">int</span> x,y,z;</div><div class="line">    Random rnd = <span class="keyword">new</span> Random();</div><div class="line">    Color [] c = &#123;Color.red, Color.green, Color.blue,Color.pink, Color.yellow&#125;;</div><div class="line">    CartoonPaint cp = <span class="keyword">new</span> CartoonPaint();</div></pre></td></tr></table></figure>
<h2 id="3-基本图形绘制"><a href="#3-基本图形绘制" class="headerlink" title="3.基本图形绘制"></a>3.基本图形绘制</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CartoonPaint</span> <span class="keyword">extends</span> <span class="title">JPanel</span></span>&#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">paintComponent</span><span class="params">(Graphics g)</span></span>&#123;</div><div class="line">            g.setColor(c[<span class="number">0</span>]);</div><div class="line">            g.drawOval(<span class="number">10</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">            g.fillOval(<span class="number">120</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">            g.drawRect(<span class="number">230</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">            g.fillRect(<span class="number">340</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">            <span class="keyword">int</span> [] x1 = &#123;<span class="number">100</span>, <span class="number">50</span>,<span class="number">150</span>&#125;;</div><div class="line">            <span class="keyword">int</span> [] y1 = &#123;<span class="number">50</span>,<span class="number">150</span>, <span class="number">150</span>&#125;;</div><div class="line">            g.drawPolygon(<span class="keyword">new</span> Polygon(x1,y1,x1.length));</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="4-异常"><a href="#4-异常" class="headerlink" title="4. 异常"></a>4. 异常</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span>&#123;</div><div class="line">        <span class="keyword">if</span> (ae.getSource()==btn[<span class="number">0</span>])&#123;</div><div class="line"></div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (ae.getSource()==btn[<span class="number">1</span>])&#123;</div><div class="line"></div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (ae.getSource()==btn[<span class="number">2</span>])&#123;</div><div class="line"></div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (ae.getSource()==btn[<span class="number">3</span>])&#123;</div><div class="line">            System.exit(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;<span class="keyword">catch</span>(Exception ex)&#123;</div><div class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,ex.getMessage());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-基础面板搭建&quot;&gt;&lt;a href=&quot;#1-基础面板搭建&quot; class=&quot;headerlink&quot; title=&quot;1. 基础面板搭建&quot;&gt;&lt;/a&gt;1. 基础面板搭建&lt;/h2&gt;
    
    </summary>
    
      <category term="Java" scheme="http://fatelancer.github.io/categories/Java/"/>
    
    
  </entry>
  
  <entry>
    <title>可延迟负荷控制</title>
    <link href="http://fatelancer.github.io/2016/07/06/%E5%8F%AF%E5%BB%B6%E8%BF%9F%E8%B4%9F%E8%8D%B7%E6%8E%A7%E5%88%B6/"/>
    <id>http://fatelancer.github.io/2016/07/06/可延迟负荷控制/</id>
    <published>2016-07-06T01:27:57.000Z</published>
    <updated>2018-06-21T03:47:04.120Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Notes-of-Real-time-deferrable-load-control-handling-the-uncertainties-of-renewable-generation"><a href="#Notes-of-Real-time-deferrable-load-control-handling-the-uncertainties-of-renewable-generation" class="headerlink" title="Notes of Real-time deferrable load control: handling the uncertainties of renewable generation"></a>Notes of <a href="http://conferences.sigcomm.org/eenergy/2013/papers/p10.pdf" target="_blank" rel="external">Real-time deferrable load control: handling the uncertainties of renewable generation</a></h1><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><ul>
<li>趋势：传统的煤炭、核能等发电能源逐渐被可再生能源所取代</li>
<li>可再生能源的不规律、不可预测性给控制带来了很多麻烦</li>
<li>需求响应：引导用户的动态电力负载需求管理与电力供应情况相匹配，可以弥补可再生能源的不确定性造成的影响</li>
<li><a href="http://fatelancer.top/2016/07/05/flexibility/#more" target="_blank" rel="external">deferrable load</a>：可以推迟一段时间再执行，可以通过推迟负荷时间来与可再生能源的供给匹配</li>
<li>要点：分散式直接负荷控制<a id="more"></a>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2></li>
</ul>
<p>提供了一个考虑未来时间段的负载与可再生能源状态预测的实时分布式可延迟负载控制算法</p>
<h1 id="建模"><a href="#建模" class="headerlink" title="建模"></a>建模</h1><p>给可延迟负载排了时间表</p>
<p>一个有限时间域里的离散时间模型（一天，十分钟为间隔）</p>
<h2 id="可再生能源与非可延迟负载"><a href="#可再生能源与非可延迟负载" class="headerlink" title="可再生能源与非可延迟负载"></a>可再生能源与非可延迟负载</h2><p>非可延时负载在低聚程度上很难有效预测<br>将可再生能源发电机与非可延时类负载聚合到一个进程——基础负载<br>是非可延迟负载与可再生能源之间的误差<br><strong>滤波器？</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Notes-of-Real-time-deferrable-load-control-handling-the-uncertainties-of-renewable-generation&quot;&gt;&lt;a href=&quot;#Notes-of-Real-time-deferrable-load-control-handling-the-uncertainties-of-renewable-generation&quot; class=&quot;headerlink&quot; title=&quot;Notes of Real-time deferrable load control: handling the uncertainties of renewable generation&quot;&gt;&lt;/a&gt;Notes of &lt;a href=&quot;http://conferences.sigcomm.org/eenergy/2013/papers/p10.pdf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Real-time deferrable load control: handling the uncertainties of renewable generation&lt;/a&gt;&lt;/h1&gt;&lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;趋势：传统的煤炭、核能等发电能源逐渐被可再生能源所取代&lt;/li&gt;
&lt;li&gt;可再生能源的不规律、不可预测性给控制带来了很多麻烦&lt;/li&gt;
&lt;li&gt;需求响应：引导用户的动态电力负载需求管理与电力供应情况相匹配，可以弥补可再生能源的不确定性造成的影响&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://fatelancer.top/2016/07/05/flexibility/#more&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;deferrable load&lt;/a&gt;：可以推迟一段时间再执行，可以通过推迟负荷时间来与可再生能源的供给匹配&lt;/li&gt;
&lt;li&gt;要点：分散式直接负荷控制
    
    </summary>
    
      <category term="电气工程" scheme="http://fatelancer.github.io/categories/%E7%94%B5%E6%B0%94%E5%B7%A5%E7%A8%8B/"/>
    
    
      <category term="柔性建模" scheme="http://fatelancer.github.io/tags/%E6%9F%94%E6%80%A7%E5%BB%BA%E6%A8%A1/"/>
    
      <category term="deferrable load" scheme="http://fatelancer.github.io/tags/deferrable-load/"/>
    
      <category term="需求响应" scheme="http://fatelancer.github.io/tags/%E9%9C%80%E6%B1%82%E5%93%8D%E5%BA%94/"/>
    
      <category term="可再生能源" scheme="http://fatelancer.github.io/tags/%E5%8F%AF%E5%86%8D%E7%94%9F%E8%83%BD%E6%BA%90/"/>
    
      <category term="real-time" scheme="http://fatelancer.github.io/tags/real-time/"/>
    
  </entry>
  
  <entry>
    <title>关于柔性建模</title>
    <link href="http://fatelancer.github.io/2016/07/05/flexibility/"/>
    <id>http://fatelancer.github.io/2016/07/05/flexibility/</id>
    <published>2016-07-05T08:21:41.000Z</published>
    <updated>2016-07-05T08:27:59.490Z</updated>
    
    <content type="html"><![CDATA[<h1 id="智能电网柔性成分运行建模方法研究"><a href="#智能电网柔性成分运行建模方法研究" class="headerlink" title="智能电网柔性成分运行建模方法研究"></a>智能电网柔性成分运行建模方法研究</h1><p>研究可调负荷和储能的运行特性，并建立其运行模型；研究柔性成分与可再生能源联合运行方式；仿真模拟可调负荷和储能运行的减排效果，验证所建模型有效性。<br><a id="more"></a></p>
<ul>
<li>存在大量的DER（分布式能源），其潜在的供需调节能力尚未被完全开发和利用：<ul>
<li>电――化学类：钠硫电站、电动汽车、充换电站、气电转换。</li>
<li>电――热转换类: 空调、地暖、电热水器、蓄热、蓄冷、蓄冰等，调节特性受热力/耗散方程的约束。</li>
<li>纯电类需求响应：通过工作时间的调整响应电力波动，实现供需两侧之间的缓冲调节功能（类储能功能）。e.g:洗衣机、洗碗机、etc.</li>
</ul>
</li>
<li>基本描述：参与方申报可承受功率曲线范围、服务的最早开始时间和能量水平、最晚结束（完成）时间和能量水平、可承受价格范围、最大可中断次数等。云服务器端进行在线优化、实时结算和价格发布。</li>
<li>实现虚拟储能网的关键技术――1、设备间的统一通讯标准和规约、即插即识别即用、智能家居；2、电力传输网络的建模，阻塞与网损管理；3、有效的电价信号、激励机制和商业模式；4、对设备和其拥有者信息的有效保护。</li>
<li>研究内容：1、DER的统一建模；2、电力传输网络的建模；3、信息安全；4、电价设计；5、实施效果的检验与仿真；6、现场测试。</li>
<li>项目成效及应用前景：1、调峰效果；2、延缓输配电系统投资的效果（线路、变压器、线路）；3、运行效益（网损、运维、检修灵活性）；4、促进随机间歇性可再生能源消纳与碳减排效果；5、社会效益。</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;智能电网柔性成分运行建模方法研究&quot;&gt;&lt;a href=&quot;#智能电网柔性成分运行建模方法研究&quot; class=&quot;headerlink&quot; title=&quot;智能电网柔性成分运行建模方法研究&quot;&gt;&lt;/a&gt;智能电网柔性成分运行建模方法研究&lt;/h1&gt;&lt;p&gt;研究可调负荷和储能的运行特性，并建立其运行模型；研究柔性成分与可再生能源联合运行方式；仿真模拟可调负荷和储能运行的减排效果，验证所建模型有效性。&lt;br&gt;
    
    </summary>
    
      <category term="电气工程" scheme="http://fatelancer.github.io/categories/%E7%94%B5%E6%B0%94%E5%B7%A5%E7%A8%8B/"/>
    
    
      <category term="柔性建模" scheme="http://fatelancer.github.io/tags/%E6%9F%94%E6%80%A7%E5%BB%BA%E6%A8%A1/"/>
    
      <category term="配电网" scheme="http://fatelancer.github.io/tags/%E9%85%8D%E7%94%B5%E7%BD%91/"/>
    
      <category term="优化" scheme="http://fatelancer.github.io/tags/%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>notes</title>
    <link href="http://fatelancer.github.io/2016/07/05/notes/"/>
    <id>http://fatelancer.github.io/2016/07/05/notes/</id>
    <published>2016-07-04T16:00:00.000Z</published>
    <updated>2017-03-01T01:52:16.808Z</updated>
    
    <content type="html"><![CDATA[<p> Notes about <a href="http://ieor.berkeley.edu/~oren/pubs/No113.pdf" target="_blank" rel="external">Large-scale integration of deferrable demand and renewable energy sources</a></p>
<h1 id="ABSTRACT"><a href="#ABSTRACT" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h1><blockquote>
<ul>
<li><a href="http://s3.amazonaws.com/academia.edu.documents/42998787/A_Stochastic_Unit-commitment_Model_for_t20160223-1673-5tjopb.pdf?AWSAccessKeyId=AKIAJ56TQJRTWSMTNPEA&amp;Expires=1467280071&amp;Signature=12zFdv9seJSAEfV1OBP2emAFj9I%3D&amp;response-content-disposition=inline%3B%20filename%3DA_stochastic_unit-commitment_model_for_t.pdf" target="_blank" rel="external">stochastic unit commitment model</a> 随机机组组合模型  <strong>？</strong></li>
<li>[ ]deferrable demand in power system 电力系统中的可暂缓需求<strong>（可调性需求？）</strong></li>
<li>[x]reserve requirements 储能需求</li>
<li>[ ]the benefits of demand flexibility 需求弹性收益 <strong>？</strong></li>
<li><p>[x]three demand response paradigms 三个需求响应的样例</p>
<blockquote>
<ul>
<li>[ ]the centralized co-optimization of generation 发电的集中联合优化 <strong>？</strong></li>
<li>[x]demand by the system operator, demand bids 来自于系统操作人员和订单的需求</li>
<li>[ ]the coupling of renewable resources with deferrable loads 可再生能源与可调性负载的耦合 <strong>？</strong></li>
</ul>
</blockquote>
</li>
<li><p>[ ]motivate coupling as an alternative for overcoming the drawbacks of the two alternative demand response options 将耦合作为克服另外两个需求响应缺点的替代选项</p>
</li>
<li>[x]a dynamic programming algorithm for coordinating deferrable demand with renewable supply 一个用于协调可调性需求与可再生能源供给的动态算法</li>
<li>[ ]simulation results for a model of the <a href="https://www.wecc.biz/Pages/home.aspx" target="_blank" rel="external">Western Electricity Coordinating Council</a> 关于<a href="https://en.wikipedia.org/wiki/Western_Electricity_Coordinating_Council" target="_blank" rel="external">西部电力协调理事会</a>的模型仿真结果</li>
<li>[ ]load management 负载管理</li>
<li>[ ]power generation scheduling 电力发电规划</li>
<li>[ ]wind power generation 风力发电</li>
</ul>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="INTRODUCTION"><a href="#INTRODUCTION" class="headerlink" title="INTRODUCTION"></a>INTRODUCTION</h1><blockquote>
<ul>
<li>high variability, unpredictable fluctuation, a limited control of output<br>与传统发电方式相比，可再生能源的关键缺陷在于它的高变化性，波动不可预测和输出仅在有限范围内可控</li>
<li>demand response<br>需求响应对于大规模的可再生能源是很有好处的</li>
<li>represent the balancing operations of the remaining grid by using a unit commitment model<br>用一个机组组合模型来表示当前电网的平衡措施来评估可再生能源与需求响应的影响</li>
<li>doesn’t model the deferrable nature of various of various demand response or account for the uncertainty that is introduced by the large-scale integration of renewable resources<br>以往这个领域的研究没有就变化的需求响应的可调性特征建模，也没有考虑由大规模可再生能源导致的不确定性</li>
<li>economic dispatch model<br>经济调度模型</li>
<li>explore the direct coupling of deferrable consumers with renewable resources into a virtual resource through a contractual agreement based on a strike price that limits the impact of the coupled system on the rest of the network<br>探索了在限制耦合系统对于网络其他部分的影响的成交价下将可调性负载与可再生能源直接耦合接入虚拟。。。（不是很懂）</li>
</ul>
</blockquote>
<h2 id="Literature-Review"><a href="#Literature-Review" class="headerlink" title="Literature Review"></a>Literature Review</h2><blockquote>
<ul>
<li>high investment cost of backup reserves<br>后备储能设施的投入来保证系统的可靠操作</li>
<li>quantifying reserve requirements as well as the impacts of renewable integration on operating costs<br>定量储藏要求和可再生能源对于运行损耗的影响</li>
<li>impact of renewable supply uncertainty on power system operations (focus)<br>可再生能源供应的不确定性对电力系统操作的影响</li>
<li>the potential benefits of demand response integration<br>一体化需求响应的潜在好处 <strong>？</strong></li>
<li>demand function<br>需求函数</li>
<li>However, many flexible consumption tasks are best characterized as deferrable, in the sense that consumers need a certain amount of energy within a certain time window. As such, deferrable demand behaves much like a hydro or storage resource from the view point of the system operator. Electric vehicle charging, agricultural pumping, pre-cooling, and residential consumption such as laundry fit this characterization.<br><strong>为什么更像一个水电或者储存？农业泵，洗衣机为什么相似？</strong></li>
<li>real-time pricing at the retail level<br>需要实时电价</li>
<li>volatility of wholesale electricity prices<br>批发电价的波动性</li>
<li>the <a href="https://en.wikipedia.org/wiki/Non-convexity_(economics" target="_blank" rel="external">non-convex</a>) costs of system operations<br>实时电价由于系统运行中的非凸成本（有绝对的需求时）不能表达出需求响应的经济价值      <strong>为什么是非凸的？</strong></li>
<li>excessive startup and minimum load costs<br>上述问题会导致过多的启动和最小负载成本</li>
<li>the system operator dispatches the system at a bulk scale and cannot control individual retail loads<br>只能在大规模上，不能分布式</li>
<li>concerns about defining market products that correspond to the types of services that loads can actually offer, which raises the need for reform in existing electricity markets<br>需要对现有市场进行改革</li>
</ul>
</blockquote>
<h2 id="Paper-Contributions"><a href="#Paper-Contributions" class="headerlink" title="Paper Contributions"></a>Paper Contributions</h2><blockquote>
<ul>
<li><strong>a stochastic unit commitment model that can be used in order to quantify the benefits of deferrable demand in mitigating the increased operating costs and day-ahead reserve requirements resulting from the random fluctuation of renewable energy supply</strong><br>一个可以用来量化可延缓需求在减少增长的运行损耗和由于可再生能源的随机波动导致的提前一天的存储需求</li>
<li>The use of stochastic planning models for simulating long-term market equilibrium in order to quantify generation investment in the face of long-term uncertainty<br>用随机规划模型来模拟长期市场均衡以用来量化面对长期不确定性情况下的发电投资</li>
<li>used in order to simulate the two-stage operation of day-ahead and real-time electricity markets<br>用来模拟提前一天的二阶操作和实时的电力市场</li>
<li>computational challenges</li>
<li>using an appropriate scenario selection technique to discretize the uncertainty space of the <a href="http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=4806110" target="_blank" rel="external">problem</a></li>
<li><strong>extend existing models by simultaneously modeling the inter-temporal dependency of deferrable demand and renewable supply uncertainty</strong><br>跨时间段的依赖关系和可再生能源供给的随机性</li>
<li>present a contractual alternative for coupling the operations of renewable resources with deferrable demand that attempts to overcome the implementation barriers associated with centralized load dispatch and real-time pricing of retail loads, and compare the relative performance of each demand response paradigm in terms of system operating costs<br>展现了一个（（具备试图克服执行障碍和集中负载调度的可调需求的可再生资源的操作）与（基于零售负载的实时电价的耦合））的基于合同的替代选项，并且比较了在系统运行损耗中各个不同的需求响应模式的表现</li>
</ul>
</blockquote>
<hr>
<h1 id="MODEL-OVERVIEW"><a href="#MODEL-OVERVIEW" class="headerlink" title="MODEL OVERVIEW"></a>MODEL OVERVIEW</h1><blockquote>
<ul>
<li>Uncertainty in the model is driven by renewable supply and demand.</li>
<li>Demand resources in the system are categorized as inflexible (firm) consumers with stochastic consumption patterns and deferrable consumers that require a fixed amount of energy within the day and adapt their instantaneous consumption patterns to the prevailing system conditions.<br>把需求分为了两类，一类是固定用户，消耗模式随机，另一类是可调用户，需求固定，消耗模式适配到系统即时状态</li>
<li>The decision support module in the upper portion of the figure simulates day-ahead market operations and is used for determining day-ahead reserve requirements when deferrable demand contributes to absorbing the variability of renewable energy supply</li>
<li>The evaluation module in the lower portion of the figure uses the reserves committed by the day-ahead model in order to compare the real-time operating costs of the system under the three demand response paradigms that are discussed in the introduction of the paper.</li>
</ul>
</blockquote>
<h2 id="Statistical-Models"><a href="#Statistical-Models" class="headerlink" title="Statistical Models"></a>Statistical Models</h2><blockquote>
<ul>
<li>We use a second order autoregressive model for modeling demand and load.<br><a href="http://baike.baidu.com/link?url=0DvVl_b1tAPmWB1whlIPgAen-oIVPTw8beF-jQWMYxU5ajNrdJ_5a5x67zbcw3XoMMPr6oWcc_I-AKD76T-Ev_" target="_blank" rel="external">二阶自回归模型</a>用来模拟需求和负载</li>
<li>固定需求与可再生能源产出是相互独立的（assumption）</li>
<li>employ a data set published by NREL which provides time series of wind speed at various geographic locations over a year</li>
<li><a href="https://en.wikipedia.org/wiki/Walker_circulation#Yule-Walker_equations" target="_blank" rel="external">Yule-Walker equations</a><br><img src="./1467355871705.png" alt="Probability distribution function of inflexible demand.|center|500x0"><br>Probability distribution function of inflexible demand</li>
<li>In the present analysis we use a single-area wind model and ignore transmission constraints in order to focus on the impact of demand response.<br>在现在的分析中，我们使用了单个区域的风力模型并且为了集中于需求响应忽略了传递约束 （没做多个区域和考虑传递约束的）</li>
<li>The problem of balancing the schedules of coupled resources with the rest of the system while respecting transmission constraints would be addressed by the system operator and would be reflected in locational marginal prices from the point of view of aggregators.<br>在考虑传递约束的情况下，平衡耦合资源规划与系统其他部分的问题会有系统操作员来解决，并且从聚合的角度来看 <strong>？</strong>，这个结果会反映在节点边际电价上</li>
<li>the aggregator can hedge by buying financial transmission rights<br><strong>？</strong> 购买输电权。。对冲</li>
</ul>
</blockquote>
<h2 id="Stochastic-Unit-Commitment"><a href="#Stochastic-Unit-Commitment" class="headerlink" title="Stochastic Unit Commitment"></a>Stochastic Unit Commitment</h2><blockquote>
<ul>
<li>assumes that the system operator co-optimizes the dispatch of flexible loads and generation resources<br>假设系统操作员可以同时协调控制柔性负载与发电资源</li>
<li>two-stage decision model where the first stage represents day-ahead unit commitment and the second stage represents real-time economic dispatch in the hour-ahead market, in hourly intervals, subsequent to the realization of uncertainty<br>一个第一阶段表示日超前机组组合模型第二阶段表示由于不确定性的实现因而以一小时为间隔的时超前市场上的实时经济调度的二阶决策模型</li>
<li>操作员每小时能够计算出模型结果是基础</li>
</ul>
</blockquote>
<p><img src="/images/1.png" alt=""></p>
<blockquote>
<p><code>$S$</code>　　a discrete set of scenarios<br><code>$G$</code>　　set of gengrators<br><code>$G_s$</code>　　set of slow generators which commitment decisions are fixed in the day-ahead time frame <code>$G_s\in G$</code>, another part are fast generators that can adjust their commitment schedule in the second stage<br><code>$w_{gt}$</code>　　First-stage decisions<br><code>$z_{gt}$</code>　the binary unit commitment and startup decisions for slow generators<br><code>$u_{gst}$</code>　　the unit commitment of all generators<br><code>$v_{gst}$</code>　startup of all generators<br><code>$p_{gst}$</code>　　power output of all generators<br><code>$e_{st}$</code>　　The dispatch of deferrable loads (a second-stage decision variable)<br><code>$S_{g}$</code>　　startup cost for each generator<br><code>$K_g$</code>　　minimun load costs for each generator<br><code>$C_g$</code>　　constant fuel costs for each generator<br><code>$D_{st}$</code>　　net demand (the net of firm demand minus renewable power supply, represents the source of uncertainty)<br><code>$\mathcal{D}$</code>　　includes generator capacity constraints, ramping constraints, and minimum up and down times, where bold fonts indicate vectors.</p>
<ul>
<li>The objective function of (1) minimizes operating costs.</li>
<li>Power balance is enforced in (2).</li>
<li>The constraint of (3) requires that deferrable loads be supplied an amount of energy within a given time window.</li>
<li>(4) enforces a limit of on the consumption (e.g., charge) rate of deferrable loads.</li>
<li>The non-anticipativity constraints on first-stage decisions is enforced in (5).</li>
<li><strong>all generators, including slow units, can adjust their production level in the second stage</strong></li>
<li>The solution of the stochastic unit commitment model is described in detail by <a href="https://perso.uclouvain.be/anthony.papavasiliou/public_html/uctestV3.pdf" target="_blank" rel="external">Papavasiliou [37]</a></li>
</ul>
</blockquote>
<hr>
<blockquote>
<p>About scenario selection algorithm</p>
<ul>
<li>scenarios are selected according to their effect on expected cost and weighed such that their selection does not bias the objective function of the stochastic unit commitment formulation<br>场景是根据他们各自对于期望损耗的效果来权衡保证选择与随机机组组合模型的目标函数无关</li>
<li>The decomposition algorithm which is employed relies on a Lagrangian relaxation scheme for scenario decomposition.<br>分解算法基于<a href="http://baike.baidu.com/link?url=vzPK82hLesPPe4MA_lGK1bcpHJDPaelhQf4B3T_geYEJM1_WCUh7oQPo4r34y1it7ZDY56U_fE3Kh1FhlYGai_" target="_blank" rel="external">拉格朗日松弛算法</a></li>
<li>The centralized stochastic unit commitment model presented in this section presumes the ability of the system operator to centrally monitor and control individual loads.</li>
</ul>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt; Notes about &lt;a href=&quot;http://ieor.berkeley.edu/~oren/pubs/No113.pdf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Large-scale integration of deferrable demand and renewable energy sources&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;ABSTRACT&quot;&gt;&lt;a href=&quot;#ABSTRACT&quot; class=&quot;headerlink&quot; title=&quot;ABSTRACT&quot;&gt;&lt;/a&gt;ABSTRACT&lt;/h1&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://s3.amazonaws.com/academia.edu.documents/42998787/A_Stochastic_Unit-commitment_Model_for_t20160223-1673-5tjopb.pdf?AWSAccessKeyId=AKIAJ56TQJRTWSMTNPEA&amp;amp;Expires=1467280071&amp;amp;Signature=12zFdv9seJSAEfV1OBP2emAFj9I%3D&amp;amp;response-content-disposition=inline%3B%20filename%3DA_stochastic_unit-commitment_model_for_t.pdf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;stochastic unit commitment model&lt;/a&gt; 随机机组组合模型  &lt;strong&gt;？&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;[ ]deferrable demand in power system 电力系统中的可暂缓需求&lt;strong&gt;（可调性需求？）&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;[x]reserve requirements 储能需求&lt;/li&gt;
&lt;li&gt;[ ]the benefits of demand flexibility 需求弹性收益 &lt;strong&gt;？&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;[x]three demand response paradigms 三个需求响应的样例&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;[ ]the centralized co-optimization of generation 发电的集中联合优化 &lt;strong&gt;？&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;[x]demand by the system operator, demand bids 来自于系统操作人员和订单的需求&lt;/li&gt;
&lt;li&gt;[ ]the coupling of renewable resources with deferrable loads 可再生能源与可调性负载的耦合 &lt;strong&gt;？&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;[ ]motivate coupling as an alternative for overcoming the drawbacks of the two alternative demand response options 将耦合作为克服另外两个需求响应缺点的替代选项&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;[x]a dynamic programming algorithm for coordinating deferrable demand with renewable supply 一个用于协调可调性需求与可再生能源供给的动态算法&lt;/li&gt;
&lt;li&gt;[ ]simulation results for a model of the &lt;a href=&quot;https://www.wecc.biz/Pages/home.aspx&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Western Electricity Coordinating Council&lt;/a&gt; 关于&lt;a href=&quot;https://en.wikipedia.org/wiki/Western_Electricity_Coordinating_Council&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;西部电力协调理事会&lt;/a&gt;的模型仿真结果&lt;/li&gt;
&lt;li&gt;[ ]load management 负载管理&lt;/li&gt;
&lt;li&gt;[ ]power generation scheduling 电力发电规划&lt;/li&gt;
&lt;li&gt;[ ]wind power generation 风力发电&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="电气工程" scheme="http://fatelancer.github.io/categories/%E7%94%B5%E6%B0%94%E5%B7%A5%E7%A8%8B/"/>
    
    
      <category term="柔性建模" scheme="http://fatelancer.github.io/tags/%E6%9F%94%E6%80%A7%E5%BB%BA%E6%A8%A1/"/>
    
      <category term="可再生能源" scheme="http://fatelancer.github.io/tags/%E5%8F%AF%E5%86%8D%E7%94%9F%E8%83%BD%E6%BA%90/"/>
    
      <category term="deferrable" scheme="http://fatelancer.github.io/tags/deferrable/"/>
    
      <category term="机组组合" scheme="http://fatelancer.github.io/tags/%E6%9C%BA%E7%BB%84%E7%BB%84%E5%90%88/"/>
    
  </entry>
  
</feed>
