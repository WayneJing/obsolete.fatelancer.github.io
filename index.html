<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Jingwen&#39;s Note</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta property="og:type" content="website">
<meta property="og:title" content="Jingwen&#39;s Note">
<meta property="og:url" content="http://fatelancer.github.io/index.html">
<meta property="og:site_name" content="Jingwen&#39;s Note">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jingwen&#39;s Note">
  
    <link rel="alternate" href="/atom.xml" title="Jingwen&#39;s Note" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/mylogo.jpg">
  <link rel="apple-touch-icon" href="/css/images/mylogo.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>
  <script src="/js/bootstrap.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    <link rel="stylesheet" href="/css/home.css" >
  

  

  

  
  
  
    <link rel="stylesheet" href="/css/vdonate.css" >
  

</head>



  <body>


  
    <header id="header">

	<!-- 背景图模式 -->
	

    
      <div id="intrologo" class="intro-logo">
    
 


    <canvas width="100%" height="100%"></canvas>
    <script>
      var c = document.getElementsByTagName('canvas')[0],
          x = c.getContext('2d'),
          w = window.innerWidth,
          h = window.innerHeight,
          pr = window.devicePixelRatio || 1,
          f = 90,
          q,
          m = Math,
          r = 0,
          u = m.PI*2,
          v = m.cos,
          z = m.random
      c.width = w*pr
      c.height = h*pr
      x.scale(pr, pr)
      x.globalAlpha = 0.6

      <!-- 折线Polyline背景 -->
      
        function i(){
            x.clearRect(0,0,w,h)
            q=[{x:0,y:h*.7+f},{x:0,y:h*.7-f}]
            while(q[1].x<w+f) d(q[0], q[1])
        }
        function d(i,j){   
            x.beginPath()
            x.moveTo(i.x, i.y)
            x.lineTo(j.x, j.y)
            var k = j.x + (z()*2-0.25)*f,
                n = y(j.y)
            x.lineTo(k, n)
            x.closePath()
            r-=u/-50
            x.fillStyle = '#'+(v(r)*127+128<<16 | v(r+u/3)*127+128<<8 | v(r+u/3*2)*127+128).toString(16)
            x.fill()
            q[0] = q[1]
            q[1] = {x:k,y:n}
        }
        function y(p){
            var t = p + (z()*2-1.1)*f
            return (t>h||t<0) ? y(p) : t
        }
        document.getElementById("intrologo").onclick = i
        document.getElementById("intrologo").ontouchstart = i
        i()

      <!-- 多边形trianglify背景 -->
      
    </script>
    

    
      <div id="homelogo" class="homelogo"> 
    

        
          <div class="homelogoback" >
            <h1><a href="#content" id="logo">Jingwen&#39;s Note</a></h1>
            <h3>null</h3>
            <h5>Jingwen CHEN</h5>
            <!-- <p><a href="https://github.com/iTimeTraveler" target="_blank">Github</a></p> -->
          </div>
        
    
    </div>
  </div>

  <!-- 自适应主页背景大图 -->
  

 <!-- home_logo_image居中 -->
 
    <script>
        var homelogodiv = document.getElementById("homelogo");
        if (document.all.homelogo.offsetWidth > document.body.clientWidth) {
          homelogodiv.style.width = document.body.clientWidth + "px";
          homelogodiv.style.marginLeft = document.body.clientWidth * -0.5 + "px";
        } else {
          homelogodiv.style.width = homelogodiv.clientWidth  + "px";
          homelogodiv.style.marginLeft = (homelogodiv.clientWidth)  * -0.5 + "px";
        }
    </script>
  

  <div class="intro-navigate">
      <p class="navigater-list">
        
          <a id="beautifont" class="main-nav-link" href="/">首页</a>
        
          <a id="beautifont" class="main-nav-link" href="/archives">归档</a>
        
          <a id="beautifont" class="main-nav-link" href="/categories">分类</a>
        
          <a id="beautifont" class="main-nav-link" href="/tags">标签</a>
        
          <a id="beautifont" class="main-nav-link" href="/about">关于</a>
        
      </p>
  </div>

</header>
  
  <div id="container">
    <div id="wrap">
      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;">
  
    <article id="[post]-EESM-5650-L1-Introduction"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/09/04/EESM-5650-L1-Introduction/">EESM 5650 L1 Introduction</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/09/04/EESM-5650-L1-Introduction/" class="article-date">
	  <time datetime="2017-09-04T06:36:00.000Z" itemprop="datePublished">2017-09-04</time>
	</a>

      
    <a class="article-category-link" href="/categories/EESM-5650-Digital-Comminications-and-Networks/">EESM 5650 Digital Comminications and Networks</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="L1-Intrduction"><a href="#L1-Intrduction" class="headerlink" title="L1 Intrduction"></a>L1 Intrduction</h1><p>network consists essentially of <strong>network switches, or nodes</strong>, interconnected by transmission links.</p>
<p><strong>Key operating parameters:</strong></p>
<ul>
<li>frequence: 2.4Ghz/5GHz (WiFi)</li>
<li>Band Width: 20MHz</li>
</ul>
<p><strong>Key tecxhnologies: OFDM（Orthogonal Frequency Division Multiplexing），MIMO（Multiple Input Multiple Output）</strong></p>
<p>Different types of networks</p>
<ul>
<li>Local Area Network (LAN)</li>
<li>Metropolitan Area Network (MAN)</li>
<li>Wide Area Network (WAN)</li>
</ul>
<a id="more"></a>
<h2 id="Communication-Systems-and-Networks"><a href="#Communication-Systems-and-Networks" class="headerlink" title="Communication Systems and Networks"></a>Communication Systems and Networks</h2><h3 id="Protocol-Architectures"><a href="#Protocol-Architectures" class="headerlink" title="Protocol Architectures"></a>Protocol Architectures</h3><ul>
<li>most networks are designed as a series of layers or levels: each one built upon its predecessor.</li>
<li>the goal of each layer is to offer certain services to the higher levels, shielding those layers from the details of how the offered services are actually implemented.</li>
<li>Layer N on one host carries on a conversation with layer N on another host.</li>
<li>The rules and conventions used in this conversation or session are collectively<br>known as the layer N protocol.</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504508669154.png" alt=""></p>
<h3 id="ISO’s-OSI-Reference-Model"><a href="#ISO’s-OSI-Reference-Model" class="headerlink" title="ISO’s OSI Reference Model"></a>ISO’s OSI Reference Model</h3><p>ISO’s OSI Reference Model consists <strong>7 Layers</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504508757572.png" alt=""></p>
<h4 id="Internet-Protocol-Stack"><a href="#Internet-Protocol-Stack" class="headerlink" title="Internet Protocol Stack"></a>Internet Protocol Stack</h4><ul>
<li>application: supporting network applications : HTTP, SMTP, FTP, DNS</li>
<li>transport: process-process data transfer:  TCP, UDP</li>
<li>network: routing of datagrams from source to destination: IP, routing protocols</li>
<li>link: data transfer between neighboring network elements: 802.11, Ethernet</li>
<li>physical: bits “on the wire”</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504509033269.png" alt=""></p>
<ul>
<li>link layer: bits—&gt;packets—&gt;correct errors</li>
<li>physical layer: sending bits from A —&gt; B</li>
<li>network layer: join nodes together</li>
</ul>
<h4 id="How-Layer-Works"><a href="#How-Layer-Works" class="headerlink" title="How Layer Works"></a>How Layer Works</h4><ul>
<li>Each layer adds/strips off its own header (and possibly a trailer)</li>
<li>Each layer may split up higher-level data</li>
<li>Each layer multiplexes multiple higher layers</li>
<li>Each layer is (mostly) transparent to higher layers</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504509297663.png" alt=""></p>
<p><strong>Encapsulation</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504509393734.png" alt=""></p>
<h3 id="Transmission-Protocols"><a href="#Transmission-Protocols" class="headerlink" title="Transmission Protocols"></a>Transmission Protocols</h3><ul>
<li>Simplex（单工）：Communication flow can <strong>only occur in one direction</strong></li>
<li>Half Duplex（半双工）：Communication flow can occur <strong>in both directions, but not at the same time</strong></li>
<li>Full Duplex（全双工）：Communication link can support <strong>simultaneous two-way communications.</strong>（requires twice channels of Simplex or half-duplex）</li>
</ul>
<h3 id="Transmission-Systems"><a href="#Transmission-Systems" class="headerlink" title="Transmission Systems"></a>Transmission Systems</h3><p><strong>Analog Communications</strong></p>
<ul>
<li>Continuous modulation</li>
<li>Fidelity is usually defined in terms of SNR</li>
</ul>
<p>$$ SNR={P_S \over P_N} $$<br>$$ dB=10log{P_S\over P_N} $$<br>When SNR&gt;10dB====&gt; Good Communications</p>
<p><strong>Digital Communications</strong></p>
<ul>
<li>Signals made up of discrete symbols selected from a finite set</li>
<li>Fidelity or Accuracy is specified in terms of bit error rate ( BER )</li>
</ul>
<p>mobile out: 0.1W<br>mobile in: $10^{-10}W\sim 10^{-13}W$<br>mobile noise: around $10^{-13}W$</p>
<h4 id="Digital-Communication-Systems"><a href="#Digital-Communication-Systems" class="headerlink" title="Digital Communication Systems"></a>Digital Communication Systems</h4><ul>
<li>Sampling</li>
<li>Quantization</li>
<li>Source Coding</li>
<li>Encryption</li>
<li>Channel coding</li>
<li>Modulation</li>
</ul>
<h4 id="Communication-Channels"><a href="#Communication-Channels" class="headerlink" title="Communication Channels"></a>Communication Channels</h4><p><strong>Effects include:</strong></p>
<ul>
<li>Attenuation</li>
<li>Noise</li>
<li>Filtering</li>
<li>Fading</li>
<li>Time Variation</li>
</ul>
<p><strong>Good Commnication System</strong></p>
<ul>
<li>Small signal power (measured in Watts or dBm)</li>
<li>Large data rate (measured in bits/sec)</li>
<li>Small bandwidth (measured in Hertz)</li>
<li>Low distortion (measured in SNR or bit error rate)</li>
<li>Low cost - with digital communications, large complexity does not always result in large cost</li>
</ul>
<h2 id="Stochastic-Process"><a href="#Stochastic-Process" class="headerlink" title="Stochastic Process"></a>Stochastic Process</h2><h3 id="Statistical-Description-of-Noise"><a href="#Statistical-Description-of-Noise" class="headerlink" title="Statistical Description of Noise"></a>Statistical Description of Noise</h3><ul>
<li>Generally noise can be modeled as a Gaussian process (by the central limit theorem). In this case, we say that at a particular time, t, the noise signal amplitude will be Gaussian distributed</li>
<li>If the noise is white noise, then all frequency components appear with equal power (white used in white light for similar reason)</li>
</ul>
<h3 id="Statistical-Averages"><a href="#Statistical-Averages" class="headerlink" title="Statistical Averages"></a>Statistical Averages</h3><p><strong>discrete: </strong></p>
<p>  $$\bar {X}=E[X]=\sum_{i=1}^M x_iP_i$$</p>
<p><strong>continuous: </strong></p>
<p>  $$\bar {X}=E[X]=\int_{-\infty}^{\infty}xf_X(x)dx$$</p>
<p><strong>Variance</strong></p>
<p>  $$\sigma_X^2=E[(X-\bar{X})]=E[X^2]-(E[X])^2$$</p>
<p>$\sigma_X$= Standard Deviation</p>
<h3 id="Joint-Distribution"><a href="#Joint-Distribution" class="headerlink" title="Joint Distribution"></a>Joint Distribution</h3><p>  $$F_{XY}=(x,y) \triangleq P(X\le x, Y\le y)$$</p>
<p>  $$f<em>{XY}(x, y)={\partial^2 F</em>{XY}(x, y)\over {\partial x\partial y}}$$</p>
<p><strong>If X and Y are said to be independent, </strong></p>
<p>  $$P(X\le x, Y\le y)=P(X\le x)P(Y\le y)$$</p>
<h3 id="Key-Distribution"><a href="#Key-Distribution" class="headerlink" title="Key Distribution"></a>Key Distribution</h3><p><strong>Gaussian Distribution</strong></p>
<p>  $$X\sim N(m_X, \sigma^2_X)$$</p>
<p>  $$f_X(x)={1\over {\sqrt{2\pi\sigma_X^2}}}exp(-{(x-m_X)^2\over {2\sigma^2_X}})$$</p>
<p>Zero Mean</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544041296.png" alt=""></p>
<h3 id="Correlation"><a href="#Correlation" class="headerlink" title="Correlation"></a>Correlation</h3><p>Correlation: the dependency between 2 entities</p>
<h3 id="Random-Process"><a href="#Random-Process" class="headerlink" title="Random Process"></a><a href="https://en.wikipedia.org/wiki/Stochastic_process" target="_blank" rel="external">Random Process</a></h3><ul>
<li><strong>A random process is a rule assigning every outcome of an experiment a function X(t)</strong></li>
<li><strong>A random process can be described as X(t)=x(t,n) where n is a member in the sample space S</strong></li>
<li>A particular X(t)=x(t,n) is referred to as <strong>a sample function or realization of the random process</strong></li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544336973.png" alt=""></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544361678.png" alt="n is fixed"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544390155.png" alt="t is fixed"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544415515.png" alt="t and n are fixed"></p>
<p>A random process is said to be Wide-Sense Stationary (WSS) If and Only If</p>
<p>  $$E[X(t)]\triangleq \bar{X}(t)=Constant$$</p>
<p>  $$R_X(t_1, t_2)=E[X(t_1)X(t_2)]=R_X(|t_1-t_2|)\triangleq R_X(\tau)$$</p>
<p>That is, a WSS process is characterized by a constant mean and a one-dimensional autocorrelation function that depends on only the time difference t</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504544501666.png" alt=""></p>
<h3 id="Autocorrelation"><a href="#Autocorrelation" class="headerlink" title="Autocorrelation"></a>Autocorrelation</h3><ul>
<li>The autocorrelation of a random process describes the correlation between values of the process at different times</li>
<li><p>It is a function of the two times for which the values are found</p>
<p>$$R_X(t_1,t_2)=E[X(t_1)X(t_2)]$$</p>
</li>
<li><p>Typically as the difference between the two times gets larger the auto-correlation gets less</p>
</li>
</ul>
<p>for white noise: Autocorrelation = 0</p>
<h3 id="Time-Averages"><a href="#Time-Averages" class="headerlink" title="Time Averages"></a>Time Averages</h3><p><img src="http://oag5ozkgs.bkt.clouddn.com/1504545092742.png" alt=""></p>
<p>A r.p. is said to be Ergodic if all time averages and Ensemble averages are equal</p>
<p>  <img src="http://oag5ozkgs.bkt.clouddn.com/1504549964236.png" alt=""></p>
<p>Noise Power = $KT\times B$<br>$$dBW=10log(KTB/1W)$$</p>
<p>$$dB=10log({P_1\over P_2})\<br>dBW=10log({P_1 \over 1W})\<br>dBm=10log({P_1 \over 1mW})$$</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p><strong>Noise: </strong></p>
<ul>
<li>Gaussian</li>
<li>Ergodic-&gt;Stationary</li>
<li>mean-&gt;Zero mean</li>
<li>PSD-&gt;(FT)Autocorrelation</li>
</ul>

      
    </div>
    <footer class="article-footer">
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Stochastic-Processe/">Stochastic Processe</a></li></ul>

      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="[post]-EESM-5620-L1-Introduction"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/09/04/EESM-5620-L1-Introduction/">EESM 5620 L1 Introduction</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/09/04/EESM-5620-L1-Introduction/" class="article-date">
	  <time datetime="2017-09-04T06:10:39.000Z" itemprop="datePublished">2017-09-04</time>
	</a>

      
    <a class="article-category-link" href="/categories/EESM-5620-Flat-Display/">EESM 5620 Flat Display</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="EESM-5620-Flat-Display"><a href="#EESM-5620-Flat-Display" class="headerlink" title="EESM 5620 Flat Display"></a>EESM 5620 Flat Display</h1><h1 id="L1-Introduction"><a href="#L1-Introduction" class="headerlink" title="L1 Introduction"></a>L1 Introduction</h1><h2 id="Chapter-1-Introduction"><a href="#Chapter-1-Introduction" class="headerlink" title="Chapter 1 Introduction"></a>Chapter 1 Introduction</h2><h3 id="1-1-Background-Knowledge"><a href="#1-1-Background-Knowledge" class="headerlink" title="1.1  Background Knowledge"></a>1.1  Background Knowledge</h3><ul>
<li>materials science</li>
<li>electronics</li>
<li>optics</li>
</ul>
<h3 id="1-2-Various-kinds-of-displays"><a href="#1-2-Various-kinds-of-displays" class="headerlink" title="1.2 Various kinds of displays"></a>1.2 Various kinds of displays</h3><p>Information displays:</p>
<ul>
<li>Fixed displays （指针显示器？）</li>
<li>Electronic displays （电子显示器）<ul>
<li>Emissive （主动发光）<ul>
<li>Neon light signs Cathode ray tube (CRT) 阴极射线显像管</li>
<li>Light emitting diode (LED) 发光二极管</li>
<li>Electroluminescent display (ELD) 电致发光显示器</li>
<li>Plasma display panels (PDP) 等离子显示板</li>
<li>Vacuum fluorescent display (VFD) 真空荧光显示屏（类似电子管）</li>
<li>Field emission display (FED) 场发射显示器</li>
<li>Organic LED (OLED) 有机发光二极管</li>
<li>Polymer LED (PLED) 高分子发光二极管</li>
</ul>
</li>
<li>Non-emissive (based on control of light transmission or reflection) 被动发光（基于光的传输和反射的非发射性？）<ul>
<li>Mechanical tile displays</li>
<li>Liquid crystal display (LCD) 液晶显示器</li>
<li>Microelectromechanical (MEMS) based display (DMD or DLP) 微机电系统显示器</li>
<li>Electrochromic display (ECD) 电致变色显示器</li>
<li>Electronic ink (e-ink) 电墨显示器</li>
</ul>
</li>
</ul>
</li>
</ul>
<a id="more"></a>
<p> But the market is dominated by <strong>CRT</strong> and <strong>LCD</strong>.</p>
<p> LCD technology is further subdivided into TN, STN, TFT (active matrix) etc. TN = Twisted nematic（扭曲向列型）. STN = Supertwisted nematic（超扭曲向列屏）. TFT = Thin film transistor（薄膜晶体管）.</p>
<p>A projection display system consists of imager（成像器） + color management optics（光学色相。。） + projection lens（投影透镜） + screen （屏幕）</p>
<h2 id="Chapter-2-Basic-Structure-of-LCD"><a href="#Chapter-2-Basic-Structure-of-LCD" class="headerlink" title="Chapter 2 Basic Structure of LCD"></a>Chapter 2 Basic Structure of LCD</h2><h3 id="2-1-Basic-Structure-AND-Materials"><a href="#2-1-Basic-Structure-AND-Materials" class="headerlink" title="2.1 Basic Structure AND Materials"></a>2.1 Basic Structure AND Materials</h3><p><img src="http://oag5ozkgs.bkt.clouddn.com/1504231634577.png" alt="Basic Structure AND Materials"></p>
<h3 id="2-2-Basic-operating-principles"><a href="#2-2-Basic-operating-principles" class="headerlink" title="2.2 Basic operating principles"></a>2.2 Basic operating principles</h3><p>polarization manipulation of light using electrical pulses</p>
<p>Common model of a TN display:</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504231872291.png" alt="Common model"></p>
<h3 id="2-3-Different-ways-to-view-a-LCD"><a href="#2-3-Different-ways-to-view-a-LCD" class="headerlink" title="2.3 Different ways to view a LCD"></a>2.3 Different ways to view a LCD</h3><ul>
<li>Transmittive（透射）: This is often the case for LCD with backlighting（no reflector）.</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504232324260.png" alt="Transmittive"></p>
<ul>
<li><a href="https://baike.baidu.com/item/%E5%8D%8A%E5%8F%8D%E5%8D%8A%E9%80%8F%E5%B1%8F%E5%B9%95" target="_blank" rel="external">Transflective（半透）</a>: The rear reflector is often a diffusive type reflector to eliminate mirror effects.</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504232646622.png" alt="Transflective"></p>
<ul>
<li>Reflective（全反射）:  In a truly reflective LCD, there is only one front polarizer.</li>
</ul>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1504233149000.png" alt="Reflective"></p>

      
    </div>
    <footer class="article-footer">
      
      
      
        
      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="[post]-多维混合Copula的风速建模"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/13/多维混合Copula的风速建模/">多维混合Copula的风速建模</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/13/多维混合Copula的风速建模/" class="article-date">
	  <time datetime="2017-04-13T08:12:39.000Z" itemprop="datePublished">2017-04-13</time>
	</a>

      
    <a class="article-category-link" href="/categories/毕业设计/">毕业设计</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="多维混合Copula参数估计"><a href="#多维混合Copula参数估计" class="headerlink" title="多维混合Copula参数估计"></a>多维混合Copula参数估计</h1><h2 id="EM算法主体部分"><a href="#EM算法主体部分" class="headerlink" title="EM算法主体部分"></a>EM算法主体部分</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">tic</div><div class="line">U=QWC;</div><div class="line">V=BDQC;</div><div class="line">Z=GHKC;</div><div class="line">M=CMC;</div><div class="line"><span class="comment">%初始化</span></div><div class="line">S=<span class="number">5</span>;</div><div class="line">th=<span class="number">0.001</span></div><div class="line">omega=[<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>];</div><div class="line">a1=copulafit(<span class="string">'Gaussian'</span>,[U,V,Z,M]);</div><div class="line">[a2,nuhat]=copulafit(<span class="string">'t'</span>,[U,V,Z,M]);</div><div class="line">a3=copula4fit(<span class="string">'Gumbel'</span>,[U,V,Z,M]);</div><div class="line">a4=copula4fit(<span class="string">'Clayton'</span>,[U,V,Z,M]);</div><div class="line">a5=copula4fit(<span class="string">'Frank'</span>,[U,V,Z,M]);</div><div class="line">theta=&#123;a1,a2,a3,a4,a5&#125;;</div><div class="line">tturntheta_old=<span class="built_in">zeros</span>(<span class="number">35</span>,<span class="number">1</span>);</div><div class="line">N=<span class="built_in">numel</span>(U);</div><div class="line">count=<span class="number">0</span>;</div><div class="line">tt=<span class="built_in">zeros</span>(N,<span class="number">4</span>);</div><div class="line">nn=<span class="built_in">zeros</span>(N,<span class="number">4</span>);</div><div class="line">tt(:,<span class="number">1</span>)=tinv(U(:),nuhat);</div><div class="line">tt(:,<span class="number">2</span>)=tinv(V(:),nuhat);</div><div class="line">tt(:,<span class="number">3</span>)=tinv(Z(:),nuhat);</div><div class="line">tt(:,<span class="number">4</span>)=tinv(M(:),nuhat);</div><div class="line">nn(:,<span class="number">1</span>)=norminv(U(:));</div><div class="line">nn(:,<span class="number">2</span>)=norminv(V(:));</div><div class="line">nn(:,<span class="number">3</span>)=norminv(Z(:));</div><div class="line">nn(:,<span class="number">4</span>)=norminv(M(:));</div><div class="line">t=<span class="built_in">inf</span>;</div><div class="line">COPULA=<span class="built_in">zeros</span>(N,S);</div><div class="line">list1=cell(<span class="number">6</span>,<span class="number">101</span>);</div><div class="line">list2=<span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">101</span>);</div><div class="line">puz=<span class="built_in">zeros</span>(N,S);</div><div class="line">puz1=<span class="built_in">zeros</span>(N,S);</div><div class="line">turntheta_old=<span class="built_in">zeros</span>(<span class="number">15</span>,<span class="number">1</span>);</div><div class="line">lower=[-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,<span class="number">1.001</span>,<span class="number">0.001</span>,-inf];</div><div class="line">turntheta=<span class="built_in">zeros</span>(<span class="number">15</span>,<span class="number">1</span>);</div><div class="line"><span class="keyword">while</span> t&gt;=th&amp;&amp;count&lt;=<span class="number">100</span></div><div class="line">    theta_old=theta;</div><div class="line">    omega_old=omega;</div><div class="line"></div><div class="line"><span class="comment">%保证搜索过程中仍为正定矩阵</span></div><div class="line">    [A1,B1]=eig(theta_old&#123;<span class="number">1</span>&#125;);</div><div class="line">    [A2,B2]=eig(theta_old&#123;<span class="number">2</span>&#125;);</div><div class="line">    C1=A1*<span class="built_in">sqrt</span>(B1);</div><div class="line">    C2=A2*<span class="built_in">sqrt</span>(B2);</div><div class="line"></div><div class="line">    tturntheta_old(<span class="number">1</span>:<span class="number">16</span>)=<span class="built_in">reshape</span>(C1,[<span class="number">16</span>,<span class="number">1</span>]);</div><div class="line">    tturntheta_old(<span class="number">17</span>:<span class="number">32</span>)=<span class="built_in">reshape</span>(C2,[<span class="number">16</span>,<span class="number">1</span>]);</div><div class="line">    tturntheta_old(<span class="number">33</span>)=theta_old&#123;<span class="number">3</span>&#125;;</div><div class="line">    tturntheta_old(<span class="number">34</span>)=theta_old&#123;<span class="number">4</span>&#125;;</div><div class="line">    tturntheta_old(<span class="number">35</span>)=theta_old&#123;<span class="number">5</span>&#125;;</div><div class="line"></div><div class="line">    COPULA(:,<span class="number">1</span>)=copulapdf(<span class="string">'Gaussian'</span>,[U,V,Z,M],theta_old&#123;<span class="number">1</span>&#125;);</div><div class="line">    COPULA(:,<span class="number">2</span>)=copulapdf(<span class="string">'t'</span>,[U,V,Z,M],theta_old&#123;<span class="number">2</span>&#125;,nuhat);</div><div class="line">    COPULA(:,<span class="number">3</span>)=copula4pdf(<span class="string">'Gumbel'</span>,[U,V,Z,M],theta_old&#123;<span class="number">3</span>&#125;);</div><div class="line">    COPULA(:,<span class="number">4</span>)=copula4pdf(<span class="string">'Clayton'</span>,[U,V,Z,M],theta_old&#123;<span class="number">4</span>&#125;);</div><div class="line">    COPULA(:,<span class="number">5</span>)=copula4pdf(<span class="string">'Frank'</span>,[U,V,Z,M],theta_old&#123;<span class="number">5</span>&#125;);</div><div class="line"></div><div class="line">    puz(:,<span class="number">1</span>)=COPULA(:,<span class="number">1</span>)*omega_old(<span class="number">1</span>);</div><div class="line">    puz(:,<span class="number">2</span>)=COPULA(:,<span class="number">2</span>)*omega_old(<span class="number">2</span>);</div><div class="line">    puz(:,<span class="number">3</span>)=COPULA(:,<span class="number">3</span>)*omega_old(<span class="number">3</span>);</div><div class="line">    puz(:,<span class="number">4</span>)=COPULA(:,<span class="number">4</span>)*omega_old(<span class="number">4</span>);</div><div class="line">    puz(:,<span class="number">5</span>)=COPULA(:,<span class="number">5</span>)*omega_old(<span class="number">5</span>);</div><div class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">1</span>)=puz(<span class="built_in">i</span>,<span class="number">1</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">2</span>)=puz(<span class="built_in">i</span>,<span class="number">2</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">3</span>)=puz(<span class="built_in">i</span>,<span class="number">3</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">4</span>)=puz(<span class="built_in">i</span>,<span class="number">4</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">5</span>)=puz(<span class="built_in">i</span>,<span class="number">5</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    omega(<span class="number">1</span>)=sum(puz1(:,<span class="number">1</span>))/N;</div><div class="line">    omega(<span class="number">2</span>)=sum(puz1(:,<span class="number">2</span>))/N;</div><div class="line">    omega(<span class="number">3</span>)=sum(puz1(:,<span class="number">3</span>))/N;</div><div class="line">    omega(<span class="number">4</span>)=sum(puz1(:,<span class="number">4</span>))/N;</div><div class="line">    omega(<span class="number">5</span>)=sum(puz1(:,<span class="number">5</span>))/N;</div><div class="line">    omega</div><div class="line">    [tturntheta,fval,exitflag,output]=update4theta(N,U,V,Z,M,tturntheta_old,puz1,tt,nn,lower,nuhat);</div><div class="line"></div><div class="line">    CC1=<span class="built_in">reshape</span>(tturntheta(<span class="number">1</span>:<span class="number">16</span>),[<span class="number">4</span>,<span class="number">4</span>]);</div><div class="line">    CC2=<span class="built_in">reshape</span>(tturntheta(<span class="number">17</span>:<span class="number">32</span>),[<span class="number">4</span>,<span class="number">4</span>]);</div><div class="line">    CC1=CC1*CC1';</div><div class="line">    CC2=CC2*CC2';</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">find</span>(eig(CC1)&lt;<span class="number">0.000000001</span>)&gt;<span class="number">0</span>)</div><div class="line">        CC1=CC1+<span class="built_in">eps</span>*<span class="built_in">eye</span>(<span class="number">4</span>);</div><div class="line">    <span class="keyword">end</span></div><div class="line">    <span class="keyword">if</span> (<span class="built_in">find</span>(eig(CC2)&lt;<span class="number">0.000000001</span>)&gt;<span class="number">0</span>)</div><div class="line">        CC2=CC2+<span class="built_in">eps</span>*<span class="built_in">eye</span>(<span class="number">4</span>);</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    theta&#123;<span class="number">1</span>&#125;=[<span class="number">1</span>,CC1(<span class="number">1</span>,<span class="number">2</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">2</span>,<span class="number">2</span>)),CC1(<span class="number">1</span>,<span class="number">3</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),CC1(<span class="number">1</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC1(<span class="number">1</span>,<span class="number">2</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,CC1(<span class="number">2</span>,<span class="number">3</span>)/sqrt(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),CC1(<span class="number">2</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC1(<span class="number">1</span>,<span class="number">3</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),CC1(<span class="number">2</span>,<span class="number">3</span>)/sqrt(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,CC1(<span class="number">3</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">3</span>,<span class="number">3</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC1(<span class="number">1</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>)),CC1(<span class="number">2</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>)),CC1(<span class="number">3</span>,<span class="number">4</span>)/sqrt(CC1(<span class="number">3</span>,<span class="number">3</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</div><div class="line">    theta&#123;<span class="number">2</span>&#125;=[<span class="number">1</span>,CC2(<span class="number">1</span>,<span class="number">2</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">2</span>,<span class="number">2</span>)),CC2(<span class="number">1</span>,<span class="number">3</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),CC2(<span class="number">1</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC2(<span class="number">1</span>,<span class="number">2</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,CC2(<span class="number">2</span>,<span class="number">3</span>)/sqrt(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),CC2(<span class="number">2</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC2(<span class="number">1</span>,<span class="number">3</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),CC2(<span class="number">2</span>,<span class="number">3</span>)/sqrt(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,CC2(<span class="number">3</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">3</span>,<span class="number">3</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            CC2(<span class="number">1</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>)),CC2(<span class="number">2</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>)),CC2(<span class="number">3</span>,<span class="number">4</span>)/sqrt(CC2(<span class="number">3</span>,<span class="number">3</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</div><div class="line">    theta&#123;<span class="number">3</span>&#125;=tturntheta(<span class="number">33</span>);</div><div class="line">    theta&#123;<span class="number">4</span>&#125;=tturntheta(<span class="number">34</span>);</div><div class="line">    theta&#123;<span class="number">5</span>&#125;=tturntheta(<span class="number">35</span>);</div><div class="line"></div><div class="line"></div><div class="line">    theta;</div><div class="line">    list1&#123;<span class="number">1</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">1</span>&#125;;</div><div class="line">    list1&#123;<span class="number">2</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">2</span>&#125;;</div><div class="line">    list1&#123;<span class="number">3</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">3</span>&#125;;</div><div class="line">    list1&#123;<span class="number">4</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">4</span>&#125;;</div><div class="line">    list1&#123;<span class="number">5</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">5</span>&#125;;</div><div class="line"></div><div class="line">    theta&#123;<span class="number">1</span>&#125;</div><div class="line">    theta&#123;<span class="number">2</span>&#125;</div><div class="line">    theta&#123;<span class="number">3</span>&#125;</div><div class="line">    theta&#123;<span class="number">4</span>&#125;</div><div class="line">    theta&#123;<span class="number">5</span>&#125;</div><div class="line"></div><div class="line">    list2(:,count+<span class="number">1</span>)=omega;</div><div class="line">    t=max([norm(tturntheta(:)-tturntheta_old(:));norm(omega_old(:)-omega(:))])</div><div class="line">    count=count+<span class="number">1</span></div><div class="line"><span class="keyword">end</span></div><div class="line">toc</div></pre></td></tr></table></figure>
<p><strong>注：在多维模式下最应注意的是搜索过程中多维高斯Copula与t-Copula的相依结构参数应该保持正定</strong></p>
<blockquote>
<p>保持矩阵正定的方法<br>假设 $A$ 矩阵正定，则;<br>$A=Y<em>\lambda</em>Y^T$,其中 $\lambda$ 为对角线上为矩阵$A$的特征值的对角矩阵，$Y$为对应各特征值的特征向量矩阵。<br>因此对于$B=Y<em>\sqrt{\lambda}$，有$A=B</em>B^T$。<br>因此只需对$B$中的元素进行搜索就能保证最后合成的$A$一定为正定。</p>
</blockquote>
<a id="more"></a>
<h2 id="非线性优化部分"><a href="#非线性优化部分" class="headerlink" title="非线性优化部分"></a>非线性优化部分</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="params">[turntheta,fval,exitflag,output]</span>=<span class="title">update4theta</span><span class="params">(N,U,V,Z,M,ttheta,puz,t,n,lower,nuhat)</span></span></div><div class="line">tic</div><div class="line">options=optimset(<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'MaxFunEvals'</span>,<span class="number">10000</span>,<span class="string">'TolFun'</span>,<span class="number">1e-8</span>,<span class="string">'TolX'</span>,<span class="number">1e-10</span>,<span class="string">'LargeScale'</span>,<span class="string">'on'</span>,<span class="string">'HessUpdate'</span>,<span class="string">'bfgs'</span>,<span class="string">'UseParallel'</span>,<span class="number">1</span>);</div><div class="line">[turntheta,fval,exitflag,output]=fmincon(@u4theta,ttheta,[],[],[],[],lower,[],[],options);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">u4theta</span><span class="params">(ttheta)</span></span></div><div class="line">    theta=cell(<span class="number">5</span>,<span class="number">1</span>);</div><div class="line"></div><div class="line">    X1=<span class="built_in">reshape</span>(ttheta(<span class="number">1</span>:<span class="number">16</span>),[<span class="number">4</span>,<span class="number">4</span>]);</div><div class="line">    X2=<span class="built_in">reshape</span>(ttheta(<span class="number">17</span>:<span class="number">32</span>),[<span class="number">4</span>,<span class="number">4</span>]);</div><div class="line">    X1=X1*X1';</div><div class="line">    X2=X2*X2';</div><div class="line"></div><div class="line">    theta&#123;<span class="number">1</span>&#125;=[<span class="number">1</span>,X1(<span class="number">1</span>,<span class="number">2</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">2</span>,<span class="number">2</span>)),X1(<span class="number">1</span>,<span class="number">3</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),X1(<span class="number">1</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X1(<span class="number">1</span>,<span class="number">2</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,X1(<span class="number">2</span>,<span class="number">3</span>)/sqrt(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),X1(<span class="number">2</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X1(<span class="number">1</span>,<span class="number">3</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),X1(<span class="number">2</span>,<span class="number">3</span>)/sqrt(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,X1(<span class="number">3</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">3</span>,<span class="number">3</span>)*X1(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X1(<span class="number">1</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">4</span>,<span class="number">4</span>)),X1(<span class="number">2</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">4</span>,<span class="number">4</span>)),X1(<span class="number">3</span>,<span class="number">4</span>)/sqrt(X1(<span class="number">3</span>,<span class="number">3</span>)*X1(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</div><div class="line">    theta&#123;<span class="number">2</span>&#125;=[<span class="number">1</span>,X2(<span class="number">1</span>,<span class="number">2</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">2</span>,<span class="number">2</span>)),X2(<span class="number">1</span>,<span class="number">3</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),X2(<span class="number">1</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X2(<span class="number">1</span>,<span class="number">2</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,X2(<span class="number">2</span>,<span class="number">3</span>)/sqrt(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),X2(<span class="number">2</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X2(<span class="number">1</span>,<span class="number">3</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),X2(<span class="number">2</span>,<span class="number">3</span>)/sqrt(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,X2(<span class="number">3</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">3</span>,<span class="number">3</span>)*X2(<span class="number">4</span>,<span class="number">4</span>));</div><div class="line">            X2(<span class="number">1</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">4</span>,<span class="number">4</span>)),X2(<span class="number">2</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">4</span>,<span class="number">4</span>)),X2(<span class="number">3</span>,<span class="number">4</span>)/sqrt(X2(<span class="number">3</span>,<span class="number">3</span>)*X2(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</div><div class="line">    theta&#123;<span class="number">3</span>&#125;=ttheta(<span class="number">33</span>);</div><div class="line">    theta&#123;<span class="number">4</span>&#125;=ttheta(<span class="number">34</span>);</div><div class="line">    theta&#123;<span class="number">5</span>&#125;=ttheta(<span class="number">35</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span> theta&#123;<span class="number">5</span>&#125;==<span class="number">0</span></div><div class="line">    theta&#123;<span class="number">5</span>&#125;=theta&#123;<span class="number">5</span>&#125;+<span class="number">0.0001</span>;</div><div class="line"><span class="keyword">end</span></div><div class="line">th1=theta&#123;<span class="number">1</span>&#125;;</div><div class="line">th2=theta&#123;<span class="number">2</span>&#125;;</div><div class="line">th3=theta&#123;<span class="number">3</span>&#125;;</div><div class="line">th4=theta&#123;<span class="number">4</span>&#125;;</div><div class="line">th5=theta&#123;<span class="number">5</span>&#125;;</div><div class="line">y=<span class="number">0</span>;</div><div class="line">Y=<span class="built_in">zeros</span>(<span class="number">1</span>,N);</div><div class="line"><span class="keyword">parfor</span> <span class="built_in">j</span>=<span class="number">1</span>:N</div><div class="line">    Y(<span class="built_in">j</span>)=<span class="built_in">log</span>(det(th1)^(<span class="number">-1</span>/<span class="number">2</span>)*<span class="built_in">exp</span>(<span class="number">-1</span>/<span class="number">2</span>*n(<span class="built_in">j</span>,:)*(th1^(<span class="number">1</span>)-<span class="built_in">eye</span>(<span class="number">4</span>))*n(<span class="built_in">j</span>,:)'))*puz(<span class="built_in">j</span>,<span class="number">1</span>)+...</div><div class="line">         <span class="built_in">log</span>(det(th2)^(<span class="number">-1</span>/<span class="number">2</span>)*<span class="built_in">gamma</span>((nuhat+<span class="number">4</span>)/<span class="number">2</span>)*<span class="built_in">gamma</span>(nuhat/<span class="number">2</span>)^(<span class="number">3</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,:)*th2^(<span class="number">-1</span>)*t(<span class="built_in">j</span>,:)'/nuhat)^(-(nuhat+<span class="number">4</span>)/<span class="number">2</span>)/((<span class="built_in">gamma</span>((nuhat+<span class="number">1</span>)/<span class="number">2</span>))^<span class="number">4</span>*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">1</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">2</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">3</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">4</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)))*puz(<span class="built_in">j</span>,<span class="number">2</span>)+...</div><div class="line">         <span class="built_in">log</span>((<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">4</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) + (th3^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)^<span class="number">2</span>*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) + (th3^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">2</span>/th3 - <span class="number">2</span>)*(<span class="number">2</span>/th3 - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) - (<span class="number">2</span>*th3*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">2</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) - (<span class="number">2</span>*th3*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">2</span>/th3 - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">3</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) - (th3^<span class="number">3</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">2</span>)*(<span class="number">1</span>/th3 - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) + (<span class="number">2</span>*th3^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">3</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)))*puz(<span class="built_in">j</span>,<span class="number">3</span>)+...</div><div class="line">         <span class="built_in">log</span>((th4^<span class="number">3</span>*(<span class="number">1</span>/th4 + <span class="number">1</span>)*(<span class="number">1</span>/th4 + <span class="number">2</span>)*(<span class="number">1</span>/th4 + <span class="number">3</span>))/(M(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*U(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*V(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*Z(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*(<span class="number">1</span>/M(<span class="built_in">j</span>)^th4 + <span class="number">1</span>/U(<span class="built_in">j</span>)^th4 + <span class="number">1</span>/V(<span class="built_in">j</span>)^th4 + <span class="number">1</span>/Z(<span class="built_in">j</span>)^th4 - <span class="number">3</span>)^(<span class="number">1</span>/th4 + <span class="number">4</span>)))*puz(<span class="built_in">j</span>,<span class="number">4</span>)+...</div><div class="line">         <span class="built_in">log</span>((<span class="number">7</span>*th5^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)^<span class="number">2</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">2</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)) + (<span class="number">6</span>*th5^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)^<span class="number">4</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">4</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)) - (th5^<span class="number">3</span>*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>))/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)) - (<span class="number">12</span>*th5^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)^<span class="number">3</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">3</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)))*puz(<span class="built_in">j</span>,<span class="number">5</span>);</div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line">y=-sum(Y);</div><div class="line"><span class="keyword">end</span></div><div class="line">toc</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h1 id="参数估计结果"><a href="#参数估计结果" class="headerlink" title="参数估计结果"></a>参数估计结果</h1><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">rho_n=[<span class="number">1.0000</span>   <span class="number">-0.4594</span>    <span class="number">0.6594</span>    <span class="number">0.3254</span></div><div class="line">     <span class="number">-0.4594</span>    <span class="number">1.0000</span>   <span class="number">-0.8218</span>    <span class="number">0.6426</span></div><div class="line">      <span class="number">0.6594</span>   <span class="number">-0.8218</span>    <span class="number">1.0000</span>   <span class="number">-0.4552</span></div><div class="line">      <span class="number">0.3254</span>    <span class="number">0.6426</span>   <span class="number">-0.4552</span>    <span class="number">1.0000</span>];</div><div class="line"></div><div class="line">rho_t=[<span class="number">1.0000</span>    <span class="number">0.6856</span>    <span class="number">0.6195</span>    <span class="number">0.6621</span></div><div class="line">      <span class="number">0.6856</span>    <span class="number">1.0000</span>    <span class="number">0.9344</span>    <span class="number">0.3696</span></div><div class="line">      <span class="number">0.6195</span>    <span class="number">0.9344</span>    <span class="number">1.0000</span>    <span class="number">0.3127</span></div><div class="line">      <span class="number">0.6621</span>    <span class="number">0.3696</span>    <span class="number">0.3127</span>    <span class="number">1.0000</span>];</div><div class="line"></div><div class="line">rho_g=<span class="number">1.9479</span>;</div><div class="line"></div><div class="line">rho_c=<span class="number">0.0010</span>;</div><div class="line"></div><div class="line">rho_f=<span class="number">2.0234</span>;</div><div class="line"></div><div class="line">omega=[<span class="number">0</span>    <span class="number">0.7098</span>    <span class="number">0.1432</span>    <span class="number">0.0364</span>    <span class="number">0.1106</span>]</div></pre></td></tr></table></figure>
<p>欧式距离</p>
<p>$d_m=6.6293$</p>
<p>可以看出从欧氏距离上讲，确实混合Copula模型比单个Copula建模的效果要好。<br>由于高斯Copula在多维下并不能表现出尾部相关性，因此其权重参数为0。其余的Copula基本是按照各自拟合优度占据权重。</p>

      
    </div>
    <footer class="article-footer">
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/EM算法/">EM算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MATLAB/">MATLAB</a></li></ul>

      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="[post]-多维形式的Copula函数推导及建模"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/06/多维形式的Copula函数推导及建模/">多维形式的Copula函数推导及建模</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/06/多维形式的Copula函数推导及建模/" class="article-date">
	  <time datetime="2017-04-06T06:57:33.000Z" itemprop="datePublished">2017-04-06</time>
	</a>

      
    <a class="article-category-link" href="/categories/毕业设计/">毕业设计</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="两种Copula"><a href="#两种Copula" class="headerlink" title="两种Copula"></a>两种Copula</h1><p>Copula函数主要分为两种，一种为椭圆族Copula，一种为Archimedean-Copula。其中椭圆族Copula直接给出了其多维形式，具体详见<a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;filter=sc_long_sign&amp;tn=SE_xueshusource_2kduw22v&amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;ie=utf-8&amp;sc_us=15886197312218780659" target="_blank" rel="external">《MATLAB统计分析与应用：40个案例分析》</a>P189。而Archimedean-Copula的函数由于各种生成元的不同导致只给出了常用的二元形式。多维形式需要手动推导。</p>
<h1 id="对多维Archimedean-Copula推导"><a href="#对多维Archimedean-Copula推导" class="headerlink" title="对多维Archimedean-Copula推导"></a>对多维Archimedean-Copula推导</h1><h2 id="对于分布函数的推导"><a href="#对于分布函数的推导" class="headerlink" title="对于分布函数的推导"></a>对于分布函数的推导</h2><p>根据<a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;filter=sc_long_sign&amp;tn=SE_xueshusource_2kduw22v&amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;ie=utf-8&amp;sc_us=15886197312218780659" target="_blank" rel="external">书中</a>P190给出的生成元与基础形式，推导出各自生成元的反函数，然后将生成元带入，得到四维Copula分布函数。<br><a id="more"></a><br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Gumbelcdf =</div><div class="line"><span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U)).^a+(-<span class="built_in">log</span>(V)).^a+(-<span class="built_in">log</span>(Z)).^a+(-<span class="built_in">log</span>(M)).^a).^(<span class="number">1.</span>/a))</div><div class="line"></div><div class="line">Claytoncdf =</div><div class="line">(U.^(-a)+V.^(-a)+Z.^(-a)+M.^(-a)<span class="number">-3</span>).^(<span class="number">-1.</span>/a)</div><div class="line"></div><div class="line">Frankcdf =</div><div class="line">-<span class="built_in">log</span>(<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)./a</div></pre></td></tr></table></figure></p>
<h2 id="对于密度函数的推导"><a href="#对于密度函数的推导" class="headerlink" title="对于密度函数的推导"></a>对于密度函数的推导</h2><p>根据定义，密度函数是对分布函数中的多个样本进行多次求偏导得到的。由于函数较为复杂，手动推导会带来很大的麻烦，因而采用MATLAB程序进行推导。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">clear all;</div><div class="line">syms U V Z M a d</div><div class="line">S1=<span class="string">'exp(-((-log(U))^a+(-log(V))^a+(-log(Z))^a+(-log(M))^a)^(1/a))'</span>;</div><div class="line">d=S1;</div><div class="line">v=[U V Z M];</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></div><div class="line">    d=diff(d,v(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line">Gum=d</div><div class="line">S2=<span class="string">'(U^(-a)+V^(-a)+Z^(-a)+M^(-a)-3)^(-1/a)'</span></div><div class="line">d=S2;</div><div class="line">v=[U V Z M];</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></div><div class="line">    d=diff(d,v(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line">Clay=d</div><div class="line">S3=<span class="string">'-log(exp(log((exp(-M*a) - 1)/(exp(-a) - 1)) + log((exp(-U*a) - 1)/(exp(-a) - 1)) + log((exp(-V*a) - 1)/(exp(-a) - 1)) + log((exp(-Z*a) - 1)/(exp(-a) - 1)))*(exp(-a) - 1) + 1)/a'</span>;</div><div class="line">d=S3;</div><div class="line">v=[U V Z M];</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></div><div class="line">    d=diff(d,v(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line">Frank=d</div></pre></td></tr></table></figure>
<p>求得结果</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Gum =</div><div class="line">(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">4.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).^<span class="number">2.</span>*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*(<span class="number">2.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">2</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*(<span class="number">1.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (<span class="number">2.</span>*a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z)</div><div class="line"></div><div class="line">Clay =</div><div class="line">(a.^<span class="number">3.</span>*(<span class="number">1.</span>/a + <span class="number">1</span>).*(<span class="number">1.</span>/a + <span class="number">2</span>).*(<span class="number">1.</span>/a + <span class="number">3</span>))./(M.^(a + <span class="number">1</span>).*U.^(a + <span class="number">1</span>).*V.^(a + <span class="number">1</span>).*Z.^(a + <span class="number">1</span>).*(<span class="number">1.</span>/M.^a + <span class="number">1.</span>/U.^a + <span class="number">1.</span>/V.^a + <span class="number">1.</span>/Z.^a - <span class="number">3</span>).^(<span class="number">1.</span>/a + <span class="number">4</span>))</div><div class="line"></div><div class="line">Frank =</div><div class="line">(<span class="number">7.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">2</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">2.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) + (<span class="number">6.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">4</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">4.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (<span class="number">12.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">3</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">3.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>))</div></pre></td></tr></table></figure>
<p><em>注：以上是经过修正后能直接进行矩阵计算的结果，修正方法为将原结果中的`</em>,^,/<code>转换为</code>.<em>,.^,./`</em></p>
<h1 id="多维Copula参数估计"><a href="#多维Copula参数估计" class="headerlink" title="多维Copula参数估计"></a>多维Copula参数估计</h1><p>MATLAB自带的函数不支持多维的Archimdean-Copula的参数估计与函数计算，因此需要自己写出极大似然估计算法。由于MATLAB自带的极大似然估计函数<code>mle</code>不支持多维变量的输入，因此先计算出对数似然函数，然后利用非线性优化函数<code>fmincon</code>求解对应的参数值</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">para</span>=<span class="title">copula4fit</span><span class="params">(name,data)</span></span></div><div class="line">options = optimset(<span class="string">'Algorithm'</span>,<span class="string">'interior-point'</span>,<span class="string">'MaxFunEvals'</span>,<span class="number">1000</span>,<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'TolCon'</span>,<span class="number">10</span>^<span class="number">-12</span>,<span class="string">'TolFun'</span>,<span class="number">10</span>^<span class="number">-4</span>,<span class="string">'TolX'</span>,<span class="number">10</span>^<span class="number">-6</span>);</div><div class="line"><span class="keyword">switch</span> name</div><div class="line">    <span class="keyword">case</span> <span class="string">'Gumbel'</span></div><div class="line"></div><div class="line">        lower = <span class="number">1.1</span>;</div><div class="line">        a = <span class="number">2</span>;</div><div class="line">        [ para LL6] = fmincon(@mlepdffun_G,a,[],[],[],[],lower,[],[],options);</div><div class="line">    <span class="keyword">case</span> <span class="string">'Clayton'</span></div><div class="line">        lower = <span class="number">0.0001</span>;</div><div class="line">        a = <span class="number">1</span>;</div><div class="line">        [ para LL2] = fmincon(@mlepdffun_C,a,[],[],[],[],lower,[],[],options);</div><div class="line">    <span class="keyword">case</span> <span class="string">'Frank'</span></div><div class="line">        theta0 = <span class="number">1</span>;</div><div class="line">        [ para LL5] = fmincon(@mlepdffun_F,theta0,[],[],[],[],[],[],[],options);</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">mlepdffun_G</span><span class="params">(a)</span></span></div><div class="line">    U=data(:,<span class="number">1</span>);</div><div class="line">    V=data(:,<span class="number">2</span>);</div><div class="line">    Z=data(:,<span class="number">3</span>);</div><div class="line">    M=data(:,<span class="number">4</span>);</div><div class="line">    N=<span class="built_in">numel</span>(U);</div><div class="line">    Y=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U));</div><div class="line"></div><div class="line">    <span class="keyword">parfor</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        Y(<span class="built_in">i</span>)=<span class="built_in">log</span>((<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">4</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) + (a^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)^<span class="number">2</span>*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) + (a^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">2</span>/a - <span class="number">2</span>)*(<span class="number">2</span>/a - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) - (<span class="number">2</span>*a*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">2</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) - (<span class="number">2</span>*a*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">2</span>/a - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">3</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) - (a^<span class="number">3</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">2</span>)*(<span class="number">1</span>/a - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) + (<span class="number">2</span>*a^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">3</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    y=-sum(Y);</div><div class="line"></div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">mlepdffun_C</span><span class="params">(a)</span></span></div><div class="line">    U=data(:,<span class="number">1</span>);</div><div class="line">    V=data(:,<span class="number">2</span>);</div><div class="line">    Z=data(:,<span class="number">3</span>);</div><div class="line">    M=data(:,<span class="number">4</span>);</div><div class="line">    N=<span class="built_in">numel</span>(U);</div><div class="line">    Y=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U));</div><div class="line">    <span class="keyword">parfor</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        Y(<span class="built_in">i</span>)=<span class="built_in">log</span>((a^<span class="number">3</span>*(<span class="number">1</span>/a + <span class="number">1</span>)*(<span class="number">1</span>/a + <span class="number">2</span>)*(<span class="number">1</span>/a + <span class="number">3</span>))/(M(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*U(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*V(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*Z(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*(<span class="number">1</span>/M(<span class="built_in">i</span>)^a + <span class="number">1</span>/U(<span class="built_in">i</span>)^a + <span class="number">1</span>/V(<span class="built_in">i</span>)^a + <span class="number">1</span>/Z(<span class="built_in">i</span>)^a - <span class="number">3</span>)^(<span class="number">1</span>/a + <span class="number">4</span>)));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    y=-sum(Y);</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">mlepdffun_F</span><span class="params">(a)</span></span></div><div class="line">    U=data(:,<span class="number">1</span>);</div><div class="line">    V=data(:,<span class="number">2</span>);</div><div class="line">    Z=data(:,<span class="number">3</span>);</div><div class="line">    M=data(:,<span class="number">4</span>);</div><div class="line">    N=<span class="built_in">numel</span>(U);</div><div class="line">    Y=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U));</div><div class="line">    <span class="keyword">parfor</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        Y(<span class="built_in">i</span>)=<span class="built_in">log</span>((<span class="number">7</span>*a^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)^<span class="number">2</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">2</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)) + (<span class="number">6</span>*a^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)^<span class="number">4</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">4</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)) - (a^<span class="number">3</span>*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)) - (<span class="number">12</span>*a^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)^<span class="number">3</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">3</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    y=-sum(Y);</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h1 id="多维Copula函数值计算"><a href="#多维Copula函数值计算" class="headerlink" title="多维Copula函数值计算"></a>多维Copula函数值计算</h1><h2 id="多维分布函数"><a href="#多维分布函数" class="headerlink" title="多维分布函数"></a>多维分布函数</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">c</span>=<span class="title">copula4cdf</span><span class="params">(name,data,a)</span></span></div><div class="line">U=data(:,<span class="number">1</span>);</div><div class="line">V=data(:,<span class="number">2</span>);</div><div class="line">Z=data(:,<span class="number">3</span>);</div><div class="line">M=data(:,<span class="number">4</span>);</div><div class="line"><span class="keyword">switch</span> name</div><div class="line">    <span class="keyword">case</span> <span class="string">'Gumbel'</span></div><div class="line">        c=<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U)).^a+(-<span class="built_in">log</span>(V)).^a+(-<span class="built_in">log</span>(Z)).^a+(-<span class="built_in">log</span>(M)).^a).^(<span class="number">1.</span>/a));</div><div class="line">    <span class="keyword">case</span> <span class="string">'Clayton'</span></div><div class="line">        c=(U.^(-a)+V.^(-a)+Z.^(-a)+M.^(-a)<span class="number">-3</span>).^(<span class="number">-1.</span>/a);</div><div class="line">    <span class="keyword">case</span> <span class="string">'Frank'</span></div><div class="line">        c=-<span class="built_in">log</span>(<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)./a;</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="多维密度函数"><a href="#多维密度函数" class="headerlink" title="多维密度函数"></a>多维密度函数</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">p</span>=<span class="title">copula4pdf</span><span class="params">(name,data,a)</span></span></div><div class="line">U=data(:,<span class="number">1</span>);</div><div class="line">V=data(:,<span class="number">2</span>);</div><div class="line">Z=data(:,<span class="number">3</span>);</div><div class="line">M=data(:,<span class="number">4</span>);</div><div class="line"><span class="keyword">switch</span> name</div><div class="line">    <span class="keyword">case</span> <span class="string">'Gumbel'</span></div><div class="line">        p=(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">4.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).^<span class="number">2.</span>*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*(<span class="number">2.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">2</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*(<span class="number">1.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (<span class="number">2.</span>*a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z);</div><div class="line">    <span class="keyword">case</span> <span class="string">'Clayton'</span></div><div class="line">        p=(a.^<span class="number">3.</span>*(<span class="number">1.</span>/a + <span class="number">1</span>).*(<span class="number">1.</span>/a + <span class="number">2</span>).*(<span class="number">1.</span>/a + <span class="number">3</span>))./(M.^(a + <span class="number">1</span>).*U.^(a + <span class="number">1</span>).*V.^(a + <span class="number">1</span>).*Z.^(a + <span class="number">1</span>).*(<span class="number">1.</span>/M.^a + <span class="number">1.</span>/U.^a + <span class="number">1.</span>/V.^a + <span class="number">1.</span>/Z.^a - <span class="number">3</span>).^(<span class="number">1.</span>/a + <span class="number">4</span>));</div><div class="line">    <span class="keyword">case</span> <span class="string">'Frank'</span></div><div class="line">        p=(<span class="number">7.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">2</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">2.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) + (<span class="number">6.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">4</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">4.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (<span class="number">12.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">3</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">3.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>));</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h1 id="多维单一Copula建模"><a href="#多维单一Copula建模" class="headerlink" title="多维单一Copula建模"></a>多维单一Copula建模</h1><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">rho_n=copulafit(<span class="string">'Gaussian'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">[rho_t,df]=copulafit(<span class="string">'t'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">rho_g=copula4fit(<span class="string">'Gumbel'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">rho_c=copula4fit(<span class="string">'Clayton'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">rho_f=copula4fit(<span class="string">'Frank'</span>,[QWC,BDQC,GHKC,CMC]);</div><div class="line">[fx,xsort]=ecdf(qw);</div><div class="line">[fy,ysort]=ecdf(bdq);</div><div class="line">[fz,zsort]=ecdf(ghk);</div><div class="line">[fn,nsort]=ecdf(cm);</div><div class="line">U1=spline(xsort(<span class="number">2</span>:<span class="keyword">end</span>),fx(<span class="number">2</span>:<span class="keyword">end</span>),qw);</div><div class="line">U2=spline(ysort(<span class="number">2</span>:<span class="keyword">end</span>),fy(<span class="number">2</span>:<span class="keyword">end</span>),bdq);</div><div class="line">U3=spline(zsort(<span class="number">2</span>:<span class="keyword">end</span>),fz(<span class="number">2</span>:<span class="keyword">end</span>),ghk);</div><div class="line">U4=spline(nsort(<span class="number">2</span>:<span class="keyword">end</span>),fn(<span class="number">2</span>:<span class="keyword">end</span>),cm);</div><div class="line">C=@(u1,u2,u3,u4)mean((U1&lt;=u1).*(U2&lt;=u2).*(U3&lt;=u3).*(U4&lt;=u4));</div><div class="line">CU=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U1(:)));</div><div class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(U1)</div><div class="line">    CU(<span class="built_in">i</span>)=C(U1(<span class="built_in">i</span>),U2(<span class="built_in">i</span>),U3(<span class="built_in">i</span>),U4(<span class="built_in">i</span>));</div><div class="line"><span class="keyword">end</span></div><div class="line">C_n=copulacdf(<span class="string">'Gaussian'</span>,[QWC,BDQC,GHKC,CMC],rho_n);</div><div class="line">C_t=copulacdf(<span class="string">'t'</span>,[QWC,BDQC,GHKC,CMC],rho_t,df);</div><div class="line">C_g=copula4cdf(<span class="string">'Gumbel'</span>,[QWC,BDQC,GHKC,CMC],rho_g);</div><div class="line">C_c=copula4cdf(<span class="string">'Clayton'</span>,[QWC,BDQC,GHKC,CMC],rho_c);</div><div class="line">C_f=copula4cdf(<span class="string">'Frank'</span>,[QWC,BDQC,GHKC,CMC],rho_f);</div><div class="line"></div><div class="line">d_n=(CU-C_n)'*(CU-C_n);</div><div class="line">d_t=(CU-C_t)'*(CU-C_t);</div><div class="line">d_g=(CU-C_g)'*(CU-C_g);</div><div class="line">d_c=(CU-C_c)'*(CU-C_c);</div><div class="line">d_f=(CU-C_f)'*(CU-C_f);</div></pre></td></tr></table></figure>
<h2 id="结果及评价"><a href="#结果及评价" class="headerlink" title="结果及评价"></a>结果及评价</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">rho_n =</div><div class="line"></div><div class="line">    <span class="number">1.0000</span>    <span class="number">0.6339</span>    <span class="number">0.5346</span>    <span class="number">0.6108</span></div><div class="line">    <span class="number">0.6339</span>    <span class="number">1.0000</span>    <span class="number">0.8092</span>    <span class="number">0.3639</span></div><div class="line">    <span class="number">0.5346</span>    <span class="number">0.8092</span>    <span class="number">1.0000</span>    <span class="number">0.3028</span></div><div class="line">    <span class="number">0.6108</span>    <span class="number">0.3639</span>    <span class="number">0.3028</span>    <span class="number">1.0000</span></div><div class="line"></div><div class="line">rho_t =</div><div class="line"></div><div class="line">    <span class="number">1.0000</span>    <span class="number">0.6441</span>    <span class="number">0.5591</span>    <span class="number">0.6179</span></div><div class="line">    <span class="number">0.6441</span>    <span class="number">1.0000</span>    <span class="number">0.8427</span>    <span class="number">0.3769</span></div><div class="line">    <span class="number">0.5591</span>    <span class="number">0.8427</span>    <span class="number">1.0000</span>    <span class="number">0.3204</span></div><div class="line">    <span class="number">0.6179</span>    <span class="number">0.3769</span>    <span class="number">0.3204</span>    <span class="number">1.0000</span></div><div class="line"></div><div class="line">rho_g =</div><div class="line"></div><div class="line">    <span class="number">1.5298</span></div><div class="line"></div><div class="line">rho_c =</div><div class="line"></div><div class="line">    <span class="number">0.4995</span></div><div class="line"></div><div class="line">rho_f =</div><div class="line"></div><div class="line">    <span class="number">3.5044</span></div></pre></td></tr></table></figure>
<h2 id="评价"><a href="#评价" class="headerlink" title="评价"></a>评价</h2><p>欧式距离</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">d_n =</div><div class="line"></div><div class="line">   <span class="number">11.0717</span></div><div class="line"></div><div class="line"></div><div class="line">d_t =</div><div class="line"></div><div class="line">    <span class="number">7.0748</span></div><div class="line"></div><div class="line"></div><div class="line">d_g =</div><div class="line"></div><div class="line">   <span class="number">48.8770</span></div><div class="line"></div><div class="line"></div><div class="line">d_c =</div><div class="line"></div><div class="line">  <span class="number">258.5072</span></div><div class="line"></div><div class="line"></div><div class="line">d_f =</div><div class="line"></div><div class="line">   <span class="number">48.3227</span></div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>欧氏距离</th>
<th>$d_n$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>计算值</td>
<td>11.0717</td>
<td>7.0748</td>
<td>48.8770</td>
<td>258.5072</td>
<td>48.3227</td>
</tr>
</tbody>
</table>
<p>我认为在对于多维变量的处理上，由于Archimedean-Copula函数仅仅通过一个变量来描述其多位相关性并不是很合理，因而通过一个结构相依矩阵来表述相关性的t-Copula与Normal-Copula就与源数据拟合方面表现的就更好</p>

      
    </div>
    <footer class="article-footer">
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MATLAB/">MATLAB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/多维Copula/">多维Copula</a></li></ul>

      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="[post]-阶段性总结"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/03/29/阶段性总结/">阶段性总结</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/03/29/阶段性总结/" class="article-date">
	  <time datetime="2017-03-29T07:54:58.000Z" itemprop="datePublished">2017-03-29</time>
	</a>

      
    <a class="article-category-link" href="/categories/毕业设计/">毕业设计</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="风速的随机性数学表述"><a href="#风速的随机性数学表述" class="headerlink" title="风速的随机性数学表述"></a>风速的随机性数学表述</h1><p>通过查阅文献可以得知，可以使用双参数威布尔分布来描述风速的概率分布</p>
<p>双参数威布尔函数<br>$$F_w(x)=1-exp(-({x \over c})^k)$$<br>其概率密度函数为<br>$$P(x)={k \over c} ({k \over c})^{k-1}exp(-({x \over c})^k)$$<br>式中 $k$ 为形状参数，无量纲； $c$ 为尺度参数，反映风电场的平均风速，单位为 $m/s$ 。</p>
<h2 id="程序验证随机性"><a href="#程序验证随机性" class="headerlink" title="程序验证随机性"></a>程序验证随机性</h2><p>通过将风速数据的频数分布图与根据风速数据拟合的威布尔分布概率密度函数曲线进行对比可以发现，使用双参数威布尔分布去拟合风速数据是完全合理的。下图中红色的曲线为威布尔分布概率密度函数曲线，蓝色部分为风速的频率分布直方图。</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/4in1_1.jpg" alt="图1 风速频数分布直方图"></p>
<h2 id="场间风速的关系"><a href="#场间风速的关系" class="headerlink" title="场间风速的关系"></a>场间风速的关系</h2><p>通过对拟合后的风速数据的分布函数绘制频数分布直方图可以简单的看出场间风速的一些关系。下图为桥湾（1）、北大桥（2）、干河口（3）以及昌马（4）四个风电场两两之间的风速频数分布直方图</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/6in1.jpg" alt="图2 场间风速频数直方图"></p>
<p>对于以上的关系可以通过地理以及气象等知识进行解释。下图是四个风电场的地理位置关系。<br><img src="http://oag5ozkgs.bkt.clouddn.com/%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE.jpg" alt="Alt text"></p>
<ul>
<li>桥湾（1）与北大桥（2）间地理位置是东西平行，在东西风向盛行的酒泉地区两者风况有较大的相似，所以线性相关性较大，如图2-1</li>
<li>干河口（3）与桥湾（1）的地理位置虽然接近东西平行，但是距离较远，因此线性相关性较低，如图2-2</li>
<li>桥湾（1）与昌马（4）间地理位置接近南北垂直，但是由于两者间距离较近，所以线性相关性也较为明显，如图2-3</li>
<li>干河口（3）与北大桥（2）的地理位置接近东西平行的，在东西风向盛行的酒泉地区两者风况有较大的相似。如图2-4可以看出存在较大的线性相关性。</li>
<li>昌马（4）与北大桥（2）的距离较远，因此线性相关性较差，如图2-5</li>
<li>干河口（3）与昌马（4）的距离最远，因此线性相关性也最差，如图2-6<a id="more"></a>
<h1 id="对场间风速进行建模"><a href="#对场间风速进行建模" class="headerlink" title="对场间风速进行建模"></a>对场间风速进行建模</h1></li>
</ul>
<h2 id="通过单个copula函数对场间风速进行建模"><a href="#通过单个copula函数对场间风速进行建模" class="headerlink" title="通过单个copula函数对场间风速进行建模"></a>通过单个copula函数对场间风速进行建模</h2><p><strong>参数估计结果</strong></p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$\rho_{Norm}$</th>
<th>$\rho_t$</th>
<th>$k$</th>
<th>$\theta_G$</th>
<th>$\theta_C$</th>
<th>$\theta_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾与北大桥</td>
<td>0.6339</td>
<td>0.6386</td>
<td>9.1619</td>
<td>1.8533</td>
<td>0.6913</td>
<td>5.0402</td>
</tr>
<tr>
<td>桥湾与干河口</td>
<td>0.5346</td>
<td>0.5364</td>
<td>9.7829</td>
<td>1.6350</td>
<td>0.4847</td>
<td>3.8853</td>
</tr>
<tr>
<td>桥湾与昌马</td>
<td>0.6108</td>
<td>0.6169</td>
<td>10.4474</td>
<td>1.7697</td>
<td>0.6530</td>
<td>4.8459</td>
</tr>
<tr>
<td>北大桥与干河口</td>
<td>0.8092</td>
<td>0.8479</td>
<td>2.7192</td>
<td>2.9270</td>
<td>1.4685</td>
<td>9.8959</td>
</tr>
<tr>
<td>北大桥与昌马</td>
<td>0.3639</td>
<td>0.3630</td>
<td>33.9054</td>
<td>1.3098</td>
<td>0.3072</td>
<td>2.3697</td>
</tr>
<tr>
<td>干河口与昌马</td>
<td>0.3028</td>
<td>0.3026</td>
<td>21.9903</td>
<td>1.2628</td>
<td>0.2141</td>
<td>1.9736</td>
</tr>
</tbody>
</table>
<p><strong>对建模结果进行评价</strong></p>
<p>与根据风速数据建立的经验Copula函数进行对比</p>
<p>使用Q-Q图进行校验（非定量分析）</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/2in1_1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/3in1_1.jpg" alt="qq图3"></p>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="external">Q-Q图的判定原则</a>可知，各类Copula函数差别很明显，其 中Gumbel-Copula，Frank-Copula，t-Copula函数曲线均较为接近45°曲线，拟合效果相对较好。以下采用统计法</p>
<p>使用K-S校验进行定量分析</p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>0.0406</td>
<td>0.0395</td>
<td>0.0302</td>
<td>0.0520</td>
<td>0.0364</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>0.0260</td>
<td>0.0219</td>
<td>0.0156</td>
<td>0.0489</td>
<td>0.0208</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>0.0260</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0499</td>
<td>0.0239</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>0.0239</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0385</td>
<td>0.0166</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>0.0208</td>
<td>0.0208</td>
<td>0.0146</td>
<td>0.0385</td>
<td>0.0156</td>
</tr>
</tbody>
</table>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="external">K-S检验法的判定原则</a>可知，在六种不同的风电场组合中，Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数的 $KS$ 统计值相对较小，而Normal-Copula，Clayton-Copula的统计值相对较大</p>
<p>秩相关性测度</p>
<table>
<thead>
<tr>
<th>数据来源</th>
<th>Kendall秩相关系数 $\tau$</th>
<th>Spearman秩相关系数 $\rho_s$</th>
</tr>
</thead>
<tbody>
<tr>
<td>原始观测数据</td>
<td>0.4816</td>
<td>0.6628</td>
</tr>
<tr>
<td>Normal-Copula</td>
<td>0.4371</td>
<td>0.6159</td>
</tr>
<tr>
<td>t-Copula</td>
<td>0.4410</td>
<td>0.6151</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>0.4604</td>
<td>0.6366</td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.2569</td>
<td>0.3751</td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>0.4592</td>
<td>0.6465</td>
</tr>
</tbody>
</table>
<p>通过与经验函数的Kendall秩相关系数，Spearman秩相关系数进行对比可以发现Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与原始数据保持着良好的秩相关性，而Normal-Copula，Clayton-Copula的秩相关性较差。</p>
<p>使用欧式距离进行分析</p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>2.8924</td>
<td>2.8209</td>
<td>1.3953</td>
<td>9.1763</td>
<td>2.4125</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>2.7285</td>
<td>2.6970</td>
<td>1.1862</td>
<td>8.2528</td>
<td>2.2180</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>2.3450</td>
<td>2.2558</td>
<td>1.3469</td>
<td>8.3662</td>
<td>1.8227</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>1.7187</td>
<td>1.7470</td>
<td>1.5995</td>
<td>5.0238</td>
<td>1.3692</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>1.8369</td>
<td>1.8561</td>
<td>1.3731</td>
<td>4.8842</td>
<td>1.4301</td>
</tr>
</tbody>
</table>
<p>可以看到在以上6种风电场组合中Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与经验Copula函数的欧氏距离较小，而Normal-Copula，Clayton-Copula与经验函数的欧氏距离较大</p>
<h2 id="使用多个Copula函数进行混合对风速进行建模"><a href="#使用多个Copula函数进行混合对风速进行建模" class="headerlink" title="使用多个Copula函数进行混合对风速进行建模"></a>使用多个Copula函数进行混合对风速进行建模</h2><p>通过查阅文献可以知道，多个Copula函数通过加权相加后仍然是Copula函数</p>
<p>由于Copula函数并非线性函数，简单的通过单个Copula函数拟合效果来选择使用哪几个Copula函数来进行混合可能不够准确，可能会存在两个单一表现并不好的Copula函数混合后结果却比较好的情况。</p>
<p>因此，将论文中的三个Copula混合模型拓展至五个常用Copula进行混合建模。</p>
<p>由于混合时运算量过大，因此选取干河口与北大桥的场间风速为例进行建模</p>
<p><strong>三个Copula混合的参数结果</strong></p>
<table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.1244</td>
<td>0.0822</td>
<td>3</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>4.1127</td>
<td>0.7495</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>6.5931</td>
<td>0.1683</td>
<td></td>
</tr>
</tbody>
</table>
<p>即<br>$$<br>C(u,v;a)=0.7495C<em>{Gumbel}(u,v;4.1127)+0.1683C</em>{Frank}(u,v;6.5931)<br>+0.0822C_t(u,v;0.1244,3)$$</p>
<p><strong>五个Copula混合的参数结果</strong></p>
<table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.9678</td>
<td>0.1075</td>
<td>2.7192</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>3.7781</td>
<td>0.5502</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>9.8959</td>
<td>0.1946</td>
<td></td>
</tr>
<tr>
<td>Norm-Copula</td>
<td>0.9250</td>
<td>0.0613</td>
<td></td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.0049</td>
<td>0.0864</td>
<td></td>
</tr>
</tbody>
</table>
<p>即<br>$$<br>\begin{aligned}<br>C(u,v;a)= &amp; 0.1075C_t(u,v;0.9678,2.7192)+0.0613C<em>N(u,v;0.9250)<br>+\<br>&amp; 0.5502C</em>{Gumbel}(u,v;3.7781)+0.1946C<em>{Frank}(u,v;9.8959)+0.0864C</em>{Clayton}(u,v;0.0049)<br>\end{aligned}<br> $$</p>
<p><strong>模型评价</strong></p>
<p>Q-Q图校验</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula.jpg" alt="3个Copula函数混合Q-Q图"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula_new.jpg" alt="5个Copula函数混合Q-Q图"></p>
<p>由于不是定量分析，对比效果不明显，以下采用定量分析，但是可以对比单个Copula时的QQ图<br><img src="http://oag5ozkgs.bkt.clouddn.com/im1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/im2.jpg" alt="qq图3"></p>
<p>可以明显看出混合Copula的效果比单个Copula效果要好。</p>
<p>K-S检验</p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
<th>$K_{3M}$</th>
<th>$K_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
<td>0.0271</td>
<td>0.0260</td>
</tr>
</tbody>
</table>
<p>可以看出5个Copula混合时的模型较3个Copula混合时的效果更好</p>
<p>欧氏距离</p>
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
<th>$d_{3M}$</th>
<th>$d_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
<td>1.3220</td>
<td>1.2730</td>
</tr>
</tbody>
</table>
<p>从欧氏距离上也能够得到与KS检验中同样的结果</p>
<h2 id="使用多元Copula进行4维风电场间风速建模"><a href="#使用多元Copula进行4维风电场间风速建模" class="headerlink" title="使用多元Copula进行4维风电场间风速建模"></a>使用多元Copula进行4维风电场间风速建模</h2><p><strong>使用单一多维Copula建模</strong></p>
<p>分别得到了Normal-Copula与t-Copula的多元风速相依结构矩阵</p>
<p>$$\rho_n=\begin{bmatrix}<br>1 &amp; 0.6339 &amp; 0.5346 &amp; 0.6108\<br>0.6339 &amp; 1 &amp; 0.8092 &amp; 0.3639\<br>0.5346 &amp; 0.8092 &amp; 1 &amp; 0.3028\<br>0.6108 &amp; 0.3639 &amp; 0.3028 &amp; 1<br>\end{bmatrix}$$</p>
<p>$$\rho_t=\begin{bmatrix}<br>1 &amp;0.6441  &amp;0.5591  &amp;0.6179 \<br>0.6441 &amp;1  &amp;0.8527  &amp;0.3769 \<br>0.5591 &amp;0.8527  &amp;1  &amp;0.3204 \<br>0.6179 &amp;0.3769  &amp;0.3204  &amp;1<br>\end{bmatrix}$$</p>
<p>$$k_t=7.8639$$</p>
<p><strong>模型评价</strong></p>
<p>K-S校验</p>
<p>$$k_G=0.0281\k_t=0.0401$$</p>
<p>欧氏距离</p>
<p>$$d_G=11.0717\d_t=7.0748$$</p>
<p>后来通过查阅文献得知KS校验不能在多维问题中使用，多维问题主要使用欧氏距离进行分析</p>
<p><strong>使用多维混合Copula两种思路</strong></p>
<ul>
<li><p>使用多维的Copula直接进行混合<br>问题： Archimedean Copula族的Copula函数需要手动计算多维形式，并手动编程通过MLE方法估算函数参数，MATLAB自带的fit函数仅支持二元的Archimedean Copula参数估计。并且在计算4维t-Copula概率密度函数时的计算量非常大，单句指令需要运算三个小时，当嵌套至EM算法的迭代中时将耗费更多的时间，预计计算时间将达到十几天。</p>
</li>
<li><p>通过pair-Copula将多个二维Copula函数进行合并，直至出现四维Copula<br>问题：暂时没有找到对于pair-Copula构建过程较为详细的文献，还处在摸索阶段</p>
</li>
</ul>
<h1 id="光伏的随机性表达"><a href="#光伏的随机性表达" class="headerlink" title="光伏的随机性表达"></a>光伏的随机性表达</h1><h2 id="通过核密度估计来表达长时间内的光伏照射强度"><a href="#通过核密度估计来表达长时间内的光伏照射强度" class="headerlink" title="通过核密度估计来表达长时间内的光伏照射强度"></a>通过核密度估计来表达长时间内的光伏照射强度</h2><p>定义<br>  :   设$x_1,x_2,…,x_n$为随机变量$x$的样本，令随机变量$x$的概率密度函数为$f(x)$，则 $f(x)$ 的核密度估计为：</p>
<p>  $$f<em>h(x)={1 \over nh}{\displaystyle \sum</em>{j=1}^n{K({x-x<em>j \over h})}}={1 \over n}{\displaystyle \sum</em>{j=1}^n{K_h(x-x_j)}}$$</p>
<p>  其中$n$为样本容量，$h$ 为平滑系数，$K(·)$ 为核函数</p>
<p><strong>结果</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1.jpg" alt="频率分布"></p>
<p>可以看到在长时间尺度上（上例为半年）核密度估计的拟合程度很高，但是在稍短的时间尺度上（一个月）则效果较差，如下图</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_2.jpg" alt=""></p>
<p>该种情况可以通过<a href="http://blog.csdn.net/matlab_matlab/article/details/56286868" target="_blank" rel="external">调整窗的宽度来提高拟合优度</a>，如下图为窗宽度为2.5时重新拟合一个月的光伏强度结果</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_3.jpg" alt="当width=2.5时拟合结果"></p>
<h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><p>所有代码详见<a href="https://github.com/fatelancer/Copula_Wind" target="_blank" rel="external">Copula_Wind</a></p>

      
    </div>
    <footer class="article-footer">
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Copula/">Copula</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/风速建模/">风速建模</a></li></ul>

      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="[post]-混合Copula建模修正"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/03/23/混合Copula建模修正/">混合Copula建模修正——更多Copula函数的加入</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/03/23/混合Copula建模修正/" class="article-date">
	  <time datetime="2017-03-23T05:46:07.000Z" itemprop="datePublished">2017-03-23</time>
	</a>

      
    <a class="article-category-link" href="/categories/毕业设计/">毕业设计</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="修正的原因"><a href="#修正的原因" class="headerlink" title="修正的原因"></a>修正的原因</h1><p>由于Copula函数并非线性函数，简单的通过单个Copula函数拟合效果来选择使用哪几个Copula函数来进行混合可能不够准确，可能会存在两个单一表现并不好的Copula函数混合后结果却比较好的情况。</p>
<p>因此，将原来的混合Copula模型拓展至五个常用Copula进行混合建模。</p>
<h1 id="修正后的代码"><a href="#修正后的代码" class="headerlink" title="修正后的代码"></a>修正后的代码</h1><h2 id="EM算法主体部分"><a href="#EM算法主体部分" class="headerlink" title="EM算法主体部分"></a>EM算法主体部分</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line">U=GHKC;</div><div class="line">V=BDQC;</div><div class="line"><span class="comment">% 初始化</span></div><div class="line">S=<span class="number">5</span>;</div><div class="line">th=<span class="number">0.01</span>;</div><div class="line">omega=[<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>];</div><div class="line">[a,nuhat]=copulafit(<span class="string">'t'</span>,[U,V]);</div><div class="line">a2=copulafit(<span class="string">'Gumbel'</span>,[U,V]);</div><div class="line">a3=copulafit(<span class="string">'Frank'</span>,[U,V]);</div><div class="line">a4=copulafit(<span class="string">'Gaussian'</span>,[U,V]);</div><div class="line">a5=copulafit(<span class="string">'Clayton'</span>,[U,V]);</div><div class="line">theta=[a(<span class="number">1</span>,<span class="number">2</span>),a2,a3,a4(<span class="number">1</span>,<span class="number">2</span>),a5];</div><div class="line">[N,~]=<span class="built_in">size</span>(U);</div><div class="line">count=<span class="number">0</span>;</div><div class="line">tt=<span class="built_in">zeros</span>(N,<span class="number">2</span>);</div><div class="line">nn=<span class="built_in">zeros</span>(N,<span class="number">2</span>);</div><div class="line">tt(:,<span class="number">1</span>)=tinv(U(:),nuhat);</div><div class="line">tt(:,<span class="number">2</span>)=tinv(V(:),nuhat);</div><div class="line">nn(:,<span class="number">1</span>)=norminv(U(:));</div><div class="line">nn(:,<span class="number">2</span>)=norminv(V(:));</div><div class="line">t=<span class="built_in">inf</span>;</div><div class="line">COPULA=<span class="built_in">zeros</span>(N,S);</div><div class="line">list1=<span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">101</span>);</div><div class="line">list2=<span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">101</span>);</div><div class="line">puz=<span class="built_in">zeros</span>(N,S);</div><div class="line">puz1=<span class="built_in">zeros</span>(N,S);</div><div class="line">turntheta_old=<span class="built_in">zeros</span>(<span class="number">1</span>,S);</div><div class="line">tic</div><div class="line"><span class="keyword">while</span> t&gt;=th&amp;&amp;count&lt;=<span class="number">50</span>;</div><div class="line">    theta_old=theta;</div><div class="line">    omega_old=omega;</div><div class="line">    <span class="comment">%转化为无约束限制的参数</span></div><div class="line">    turntheta_old(<span class="number">1</span>)=<span class="built_in">tan</span>(<span class="built_in">pi</span>*theta_old(<span class="number">1</span>)/<span class="number">2</span>);</div><div class="line">    turntheta_old(<span class="number">2</span>)=<span class="built_in">log</span>(theta_old(<span class="number">2</span>)<span class="number">-1</span>);</div><div class="line">    turntheta_old(<span class="number">4</span>)=<span class="built_in">tan</span>(<span class="built_in">pi</span>*theta_old(<span class="number">4</span>)/<span class="number">2</span>);</div><div class="line">    turntheta_old(<span class="number">5</span>)=<span class="built_in">log</span>(theta_old(<span class="number">5</span>));</div><div class="line">    COPULA(:,<span class="number">1</span>)=copulapdf(<span class="string">'t'</span>,[U(:) V(:)],theta_old(<span class="number">1</span>),nuhat);</div><div class="line">    COPULA(:,<span class="number">2</span>)=copulapdf(<span class="string">'Gumbel'</span>,[U(:) V(:)],theta_old(<span class="number">2</span>));</div><div class="line">    COPULA(:,<span class="number">3</span>)=copulapdf(<span class="string">'Frank'</span>,[U(:) V(:)],theta_old(<span class="number">3</span>));</div><div class="line">    COPULA(:,<span class="number">4</span>)=copulapdf(<span class="string">'Gaussian'</span>,[U(:) V(:)],theta_old(<span class="number">4</span>));</div><div class="line">    COPULA(:,<span class="number">5</span>)=copulapdf(<span class="string">'Clayton'</span>,[U(:) V(:)],theta_old(<span class="number">5</span>));</div><div class="line">    puz(:,<span class="number">1</span>)=COPULA(:,<span class="number">1</span>)*omega_old(<span class="number">1</span>);</div><div class="line">    puz(:,<span class="number">2</span>)=COPULA(:,<span class="number">2</span>)*omega_old(<span class="number">2</span>);</div><div class="line">    puz(:,<span class="number">3</span>)=COPULA(:,<span class="number">3</span>)*omega_old(<span class="number">3</span>);</div><div class="line">    puz(:,<span class="number">4</span>)=COPULA(:,<span class="number">4</span>)*omega_old(<span class="number">4</span>);</div><div class="line">    puz(:,<span class="number">5</span>)=COPULA(:,<span class="number">5</span>)*omega_old(<span class="number">5</span>);</div><div class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">1</span>)=puz(<span class="built_in">i</span>,<span class="number">1</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">2</span>)=puz(<span class="built_in">i</span>,<span class="number">2</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">3</span>)=puz(<span class="built_in">i</span>,<span class="number">3</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">4</span>)=puz(<span class="built_in">i</span>,<span class="number">4</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">5</span>)=puz(<span class="built_in">i</span>,<span class="number">5</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    omega(<span class="number">1</span>)=sum(puz1(:,<span class="number">1</span>))/N;</div><div class="line">    omega(<span class="number">2</span>)=sum(puz1(:,<span class="number">2</span>))/N;</div><div class="line">    omega(<span class="number">3</span>)=sum(puz1(:,<span class="number">3</span>))/N;</div><div class="line">    omega(<span class="number">4</span>)=sum(puz1(:,<span class="number">4</span>))/N;</div><div class="line">    omega(<span class="number">5</span>)=sum(puz1(:,<span class="number">5</span>))/N;</div><div class="line">    omega</div><div class="line">    tic</div><div class="line">    [turntheta,fval,exitflag,output,grad,hessian]=updatetheta(N,U,V,turntheta_old,puz1,tt,nn,nuhat);</div><div class="line">    toc</div><div class="line">    theta(<span class="number">1</span>)=<span class="built_in">atan</span>(turntheta(<span class="number">1</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">    theta(<span class="number">2</span>)=<span class="built_in">exp</span>(turntheta(<span class="number">2</span>))+<span class="number">1</span>;</div><div class="line">    theta(<span class="number">4</span>)=<span class="built_in">atan</span>(turntheta(<span class="number">4</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">    theta(<span class="number">5</span>)=<span class="built_in">exp</span>(turntheta(<span class="number">5</span>));</div><div class="line">    theta</div><div class="line">    list1(:,count+<span class="number">1</span>)=theta;</div><div class="line">    list2(:,count+<span class="number">1</span>)=omega;</div><div class="line">    t=max([norm(theta_old(:)-theta(:));norm(omega_old(:)-omega(:))])</div><div class="line">    count=count+<span class="number">1</span></div><div class="line"><span class="keyword">end</span></div><div class="line">toc</div><div class="line">beep</div></pre></td></tr></table></figure>
<p>代码中涉及对参数进行数学变换将其参数从各自有限定义域转为$(-\infty,+ \infty)$</p>
<p>其中:</p>
<ul>
<li>t-Copula与正态Copula参数定义域为$(-1,1)$</li>
<li>Gumbel-Copula参数定义域为$(1,+\infty)$</li>
<li>Clayton-Copula参数定义域为$(0,+\infty)$</li>
<li>Frank-Copula参数定义域为$(-\infty,+\infty)$</li>
</ul>
<a id="more"></a>
<h2 id="参数更新部分"><a href="#参数更新部分" class="headerlink" title="参数更新部分"></a>参数更新部分</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="params">[turntheta,fval,exitflag,output,grad,hessian]</span>=<span class="title">updatetheta</span><span class="params">(N,U,V,theta,puz,t,n,nuhat)</span></span></div><div class="line">options=optimset(<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'MaxFunEvals'</span>,<span class="number">1000</span>,<span class="string">'TolFun'</span>,<span class="number">1e-6</span>,<span class="string">'TolX'</span>,<span class="number">1e-10</span>,<span class="string">'LargeScale'</span>,<span class="string">'on'</span>,<span class="string">'FinDiffType'</span>,<span class="string">'central'</span>,<span class="string">'HessUpdate'</span>,<span class="string">'bfgs'</span>);</div><div class="line">[turntheta,fval,exitflag,output,grad,hessian]=fminunc(@utheta,theta,options);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">utheta</span><span class="params">(theta)</span></span></div><div class="line"><span class="keyword">if</span> theta(<span class="number">3</span>)==<span class="number">0</span></div><div class="line">    theta(<span class="number">3</span>)=theta(<span class="number">3</span>)+<span class="number">0.0001</span>;  <span class="comment">%防止出现 Frank  Copula 的相依结构参数为 0</span></div><div class="line"><span class="keyword">end</span></div><div class="line">y=<span class="number">0</span>;</div><div class="line">th=<span class="built_in">eye</span>(<span class="number">2</span>);</div><div class="line">th1=<span class="built_in">eye</span>(<span class="number">2</span>);</div><div class="line">th(<span class="number">1</span>,<span class="number">2</span>)=<span class="built_in">atan</span>(theta(<span class="number">1</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">th(<span class="number">2</span>,<span class="number">1</span>)=<span class="built_in">atan</span>(theta(<span class="number">1</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">th1(<span class="number">1</span>,<span class="number">2</span>)=<span class="built_in">atan</span>(theta(<span class="number">4</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line">th1(<span class="number">2</span>,<span class="number">1</span>)=<span class="built_in">atan</span>(theta(<span class="number">4</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</div><div class="line"><span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:N</div><div class="line"></div><div class="line">    y=y+<span class="built_in">log</span>(((det(th))^(<span class="number">-1</span>/<span class="number">2</span>))*<span class="built_in">gamma</span>((nuhat+<span class="number">2</span>)/<span class="number">2</span>)*<span class="built_in">gamma</span>(nuhat/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,:)*th^(<span class="number">-1</span>)*t(<span class="built_in">j</span>,:)'/nuhat)^(-(nuhat+<span class="number">2</span>)/<span class="number">2</span>)/((<span class="built_in">gamma</span>((nuhat+<span class="number">1</span>)/<span class="number">2</span>))^<span class="number">2</span>*((<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">1</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">2</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>))))*puz(<span class="built_in">j</span>,<span class="number">1</span>)+...</div><div class="line">        <span class="built_in">log</span>(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))^(<span class="number">1</span>/(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)))*(<span class="built_in">log</span>(U(<span class="built_in">j</span>))*<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)<span class="number">-1</span>)*(((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)))^(<span class="number">1</span>/(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))+(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)<span class="number">-1</span>)/(U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)))^(<span class="number">2</span><span class="number">-1</span>/(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))))*puz(<span class="built_in">j</span>,<span class="number">2</span>)+...</div><div class="line">        <span class="built_in">log</span>(theta(<span class="number">3</span>)*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))*<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*(U(<span class="built_in">j</span>)+V(<span class="built_in">j</span>)))/((<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))-(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*U(<span class="built_in">j</span>)))*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*V(<span class="built_in">j</span>))))^<span class="number">2</span>)*puz(<span class="built_in">j</span>,<span class="number">3</span>)+...</div><div class="line">        <span class="built_in">log</span>((det(th1))^(<span class="number">-1</span>/<span class="number">2</span>)*<span class="built_in">exp</span>(<span class="number">-1</span>/<span class="number">2</span>*n(<span class="built_in">j</span>,:)*(th1^(<span class="number">-1</span>)-<span class="built_in">eye</span>(<span class="number">2</span>))*n(<span class="built_in">j</span>,:)'))*puz(<span class="built_in">j</span>,<span class="number">4</span>)+...</div><div class="line">        <span class="built_in">log</span>((<span class="number">1</span>+<span class="built_in">exp</span>(theta(<span class="number">5</span>)))*(U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>))^(-<span class="built_in">exp</span>(theta(<span class="number">5</span>))<span class="number">-1</span>)*(U(<span class="built_in">j</span>)^(-<span class="built_in">exp</span>(theta(<span class="number">5</span>)))+V(<span class="built_in">j</span>)^(-<span class="built_in">exp</span>(theta(<span class="number">5</span>)))<span class="number">-1</span>)^(<span class="number">-2</span><span class="number">-1</span>/<span class="built_in">exp</span>(theta(<span class="number">5</span>))))*puz(<span class="built_in">j</span>,<span class="number">5</span>);</div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">y=-y;</div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h1 id="结果分析"><a href="#结果分析" class="headerlink" title="结果分析"></a>结果分析</h1><h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.9678</td>
<td>0.1075</td>
<td>2.7192</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>3.7781</td>
<td>0.5502</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>9.8959</td>
<td>0.1946</td>
<td></td>
</tr>
<tr>
<td>Norm-Copula</td>
<td>0.9250</td>
<td>0.0613</td>
<td></td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.0049</td>
<td>0.0864</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="Q-Q图"><a href="#Q-Q图" class="headerlink" title="Q-Q图"></a>Q-Q图</h2><p>与3个Copula函数混合时的模型相比：</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula.jpg" alt="3个Copula函数混合Q-Q图"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula_new.jpg" alt="5个Copula函数混合Q-Q图"></p>
<p>由于不是定量分析，对比效果不明显，以下采用定量分析</p>
<h2 id="KS检验"><a href="#KS检验" class="headerlink" title="KS检验"></a>KS检验</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
<th>$K_{3M}$</th>
<th>$K_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
<td>0.0271</td>
<td>0.0260</td>
</tr>
</tbody>
</table>
<p>可以看出5个Copula混合时的模型较3个Copula混合时的效果更好</p>
<h2 id="欧式距离"><a href="#欧式距离" class="headerlink" title="欧式距离"></a>欧式距离</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
<th>$d_{3M}$</th>
<th>$d_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
<td>1.3220</td>
<td>1.2730</td>
</tr>
</tbody>
</table>
<p>从欧氏距离上也能够得到与KS检验中同样的结果</p>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>综上，可以将混合Copula模型更新为如下形式</p>
<p>$$<br>\begin{aligned}<br>C(u,v;a)= &amp; 0.1075C_t(u,v;0.9678,2.7192)+0.0613C<em>N(u,v;0.9250)<br>+\<br>&amp; 0.5502C</em>{Gumbel}(u,v;3.7781)+0.1946C<em>{Frank}(u,v;9.8959)+0.0864C</em>{Clayton}(u,v;0.0049)<br>\end{aligned}<br> $$</p>
<p>PS:以上程序跑了9个小时，由于本人电脑运算处理速度问题，暂且限制在该精度下，但是结果仍可更加精确，后面会使用工作站进行进一步的精确计算</p>

      
    </div>
    <footer class="article-footer">
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MATLAB/">MATLAB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/混合Copula/">混合Copula</a></li></ul>

      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="[post]-光伏建模（2）——核密度估计实现"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/03/17/光伏建模（2）——核密度估计实现/">光伏建模（2）——核密度估计实现</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/03/17/光伏建模（2）——核密度估计实现/" class="article-date">
	  <time datetime="2017-03-17T05:33:01.000Z" itemprop="datePublished">2017-03-17</time>
	</a>

      
    <a class="article-category-link" href="/categories/毕业设计/">毕业设计</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数据录入"><a href="#数据录入" class="headerlink" title="数据录入"></a>数据录入</h1><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\一月\太阳能测光数据_2010-01-01 - 2010-02-01.xls'</span>);</div><div class="line">solardata=solar(:,<span class="number">2</span>);</div><div class="line">SData=cell(<span class="number">1</span>,<span class="number">7</span>);</div><div class="line">SData(<span class="number">1</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\二月\太阳能测光数据_2010-02.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">2</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\三月\太阳能测光数据_2010-03-01 - 2010-04-01.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">3</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\四月\太阳能测光数据_2010-04-01 - 2010-05-01.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">4</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\五月\太阳能测光数据_2010-05-01 - 2010-06-01.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">5</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\六月\太阳能测光数据_2010-06-01 - 2010-07-01.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</div><div class="line">SData(<span class="number">6</span>)=&#123;solar&#125;;</div><div class="line"></div><div class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\七月\太阳能测光数据2010-7-1-2010-8-1.xls'</span>);</div><div class="line">solardata=[solardata; solar(:,<span class="number">3</span>)]</div><div class="line">SData(<span class="number">7</span>)=&#123;solar&#125;;</div></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="使用核密度估计对长时间内的光伏强度进行估计"><a href="#使用核密度估计对长时间内的光伏强度进行估计" class="headerlink" title="使用核密度估计对长时间内的光伏强度进行估计"></a>使用核密度估计对长时间内的光伏强度进行估计</h1><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[fsd,sdc]=ecdf(solardata);</div><div class="line">[fks,ksc]=ksdensity(solardata,[<span class="number">-100</span>:<span class="number">1</span>:<span class="number">1200</span>]);</div><div class="line">figure;</div><div class="line">ecdfhist(fsd,sdc,<span class="number">100</span>);</div><div class="line">hold on</div><div class="line">plot(ksc,fks,<span class="string">'-r'</span>)</div></pre></td></tr></table></figure>
<p><em>在默认情况下核函数选取的是高斯核函数，事实上在所有核函数中，高斯与epanechnikov这两种核函数拟合效果较好</em></p>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p><img src="http://oag5ozkgs.bkt.clouddn.com/1.jpg" alt="频率分布"></p>
<p>可以看到在长时间尺度上（上例为半年）核密度估计的拟合程度很高，但是在稍短的时间尺度上（一个月）则效果较差，如下图</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_2.jpg" alt=""></p>
<p>该种情况可以通过<a href="http://blog.csdn.net/matlab_matlab/article/details/56286868" target="_blank" rel="external">调整窗的宽度来提高拟合优度</a>，如下图为窗宽度为2.5时重新拟合一个月的光伏强度结果</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_3.jpg" alt="当width=2.5时拟合结果"></p>

      
    </div>
    <footer class="article-footer">
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MATLAB/">MATLAB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/核密度估计/">核密度估计</a></li></ul>

      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="[post]-光伏建模"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/03/15/光伏建模/">光伏建模——核密度估计而非Beta分布</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/03/15/光伏建模/" class="article-date">
	  <time datetime="2017-03-15T02:44:56.000Z" itemprop="datePublished">2017-03-15</time>
	</a>

      
    <a class="article-category-link" href="/categories/毕业设计/">毕业设计</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="光伏建模与风速建模的不同"><a href="#光伏建模与风速建模的不同" class="headerlink" title="光伏建模与风速建模的不同"></a>光伏建模与风速建模的不同</h1><ul>
<li>对与风速建模而言，其符合双参数威布尔分布表示其样本数据符合双参数威布尔数据样本的特征</li>
<li>对于光伏建模而言，所谓的使用beta分布拟合光伏实际意义为在短时间内（一天之内）光照强度的曲线可以通过beta分布的概率密度函数去近似拟合</li>
</ul>
<p>此二者有本质区别，因此如果仅通过曲线拟合表示光伏建模数据不能称作光伏建模随机性的数学表述，因此在缺乏先验的情况下只能求助于仅基于样本数据核密度估计</p>
<a id="more"></a>
<h1 id="非参数核密度估计"><a href="#非参数核密度估计" class="headerlink" title="非参数核密度估计"></a>非参数核密度估计</h1><p>定义<br>  :   设$x_1,x_2,…,x_n$为随机变量$x$的样本，令随机变量$x$的概率密度函数为$f(x)$，则 $f(x)$ 的核密度估计为： </p>
<p>  $$f<em>h(x)={1 \over nh}{\displaystyle \sum</em>{j=1}^n{K({x-x<em>j \over h})}}={1 \over n}{\displaystyle \sum</em>{j=1}^n{K_h(x-x_j)}}$$</p>
<p>  其中$n$为样本容量，$h$ 为平滑系数，$K(·)$ 为核函数</p>
<iframe src="http://www.cnblogs.com/wt869054461/p/5935992.html" width="100%" height="700px" frameborder="0" scrolling="auto"> </iframe>

      
    </div>
    <footer class="article-footer">
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/核密度估计/">核密度估计</a></li></ul>

      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="[post]-混合Copula风速建模——代码实现与结果分析"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/03/10/混合Copula风速建模——代码实现与结果分析/">混合Copula风速建模——代码实现与结果分析</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/03/10/混合Copula风速建模——代码实现与结果分析/" class="article-date">
	  <time datetime="2017-03-10T08:05:37.000Z" itemprop="datePublished">2017-03-10</time>
	</a>

      
    <a class="article-category-link" href="/categories/毕业设计/">毕业设计</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>由于仿真一次所耗时间较长，因此选择北大桥与干河口风电场作为代表</em></p>
<h1 id="EM算法估计混合Copula参数"><a href="#EM算法估计混合Copula参数" class="headerlink" title="EM算法估计混合Copula参数"></a>EM算法估计混合Copula参数</h1><h2 id="EM主体"><a href="#EM主体" class="headerlink" title="EM主体"></a>EM主体</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">U=GHK;</div><div class="line">V=BDQ;</div><div class="line"><span class="comment">% 初始化</span></div><div class="line">S=<span class="number">3</span>;</div><div class="line">th=<span class="number">0.01</span>;</div><div class="line">omega=[<span class="number">1</span>/<span class="number">3</span>,<span class="number">1</span>/<span class="number">3</span>,<span class="number">1</span>/<span class="number">3</span>];</div><div class="line">[a,nuhat]=copulafit(<span class="string">'t'</span>,[U,V]);</div><div class="line">a2=copulafit(<span class="string">'Gumbel'</span>,[U,V]);</div><div class="line">a3=copulafit(<span class="string">'Frank'</span>,[U,V]);</div><div class="line">theta=[a(<span class="number">1</span>,<span class="number">2</span>),a2,a3];</div><div class="line">[N,~]=<span class="built_in">size</span>(U);</div><div class="line">count=<span class="number">0</span>;</div><div class="line">tt=<span class="built_in">zeros</span>(N,<span class="number">2</span>);</div><div class="line">t=<span class="built_in">inf</span>;</div><div class="line">COPULA=<span class="built_in">zeros</span>(N,S);</div><div class="line">list1=<span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">101</span>);</div><div class="line">list2=<span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">101</span>);</div><div class="line">puz=<span class="built_in">zeros</span>(N,S);</div><div class="line">puz1=<span class="built_in">zeros</span>(N,S);</div><div class="line"><span class="keyword">while</span> t&gt;=th&amp;&amp;count&lt;=<span class="number">100</span>;</div><div class="line">    theta_old=theta;</div><div class="line">    omega_old=omega;</div><div class="line">    COPULA(:,<span class="number">1</span>)=copulapdf(<span class="string">'t'</span>,[U(:) V(:)],theta_old(<span class="number">1</span>),nuhat);</div><div class="line">    COPULA(:,<span class="number">2</span>)=copulapdf(<span class="string">'Gumbel'</span>,[U(:) V(:)],theta_old(<span class="number">2</span>));</div><div class="line">    COPULA(:,<span class="number">3</span>)=copulapdf(<span class="string">'Frank'</span>,[U(:) V(:)],theta_old(<span class="number">3</span>));</div><div class="line">    puz(:,<span class="number">1</span>)=COPULA(:,<span class="number">1</span>)*omega_old(<span class="number">1</span>);</div><div class="line">    puz(:,<span class="number">2</span>)=COPULA(:,<span class="number">2</span>)*omega_old(<span class="number">2</span>);</div><div class="line">    puz(:,<span class="number">3</span>)=COPULA(:,<span class="number">3</span>)*omega_old(<span class="number">3</span>);</div><div class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">1</span>)=puz(<span class="built_in">i</span>,<span class="number">1</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">2</span>)=puz(<span class="built_in">i</span>,<span class="number">2</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">        puz1(<span class="built_in">i</span>,<span class="number">3</span>)=puz(<span class="built_in">i</span>,<span class="number">3</span>)/sum(puz(<span class="built_in">i</span>,:));</div><div class="line">    <span class="keyword">end</span></div><div class="line">    omega(<span class="number">1</span>)=sum(puz1(:,<span class="number">1</span>))/N;</div><div class="line">    omega(<span class="number">2</span>)=sum(puz1(:,<span class="number">2</span>))/N;</div><div class="line">    omega(<span class="number">3</span>)=sum(puz1(:,<span class="number">3</span>))/N;</div><div class="line">    omega</div><div class="line">    tt(:,<span class="number">1</span>)=tinv(U(:),nuhat);</div><div class="line">    tt(:,<span class="number">2</span>)=tinv(V(:),nuhat);</div><div class="line">    [turntheta,fval,exitflag,output,grad,hessian]=updatetheta(N,U,V,theta_old,puz1,tt,nuhat);</div><div class="line">    theta=turntheta;</div><div class="line">    theta</div><div class="line">    list1(:,count+<span class="number">1</span>)=theta;</div><div class="line">    list2(:,count+<span class="number">1</span>)=omega;</div><div class="line">    t=max([norm(theta_old(:)-theta(:));norm(omega_old(:)-omega(:))])</div><div class="line">    count=count+<span class="number">1</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="参数更新（非线性优化bfgs）"><a href="#参数更新（非线性优化bfgs）" class="headerlink" title="参数更新（非线性优化bfgs）"></a>参数更新（非线性优化bfgs）</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="params">[turntheta,fval,exitflag,output,grad,hessian]</span>=<span class="title">updatetheta</span><span class="params">(N,U,V,theta,puz,t,nuhat)</span></span></div><div class="line">options=optimset(<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'TolFun'</span>,<span class="number">1e-10</span>,<span class="string">'TolX'</span>,<span class="number">1e-10</span>,<span class="string">'LargeScale'</span>,<span class="string">'off'</span>,<span class="string">'FinDiffType'</span>,<span class="string">'central'</span>,<span class="string">'HessUpdate'</span>,<span class="string">'bfgs'</span>);</div><div class="line">[turntheta,fval,exitflag,output,grad,hessian]=fminunc(@utheta,theta,options);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">utheta</span><span class="params">(theta)</span></span></div><div class="line"><span class="keyword">if</span> theta(<span class="number">3</span>)==<span class="number">0</span></div><div class="line">    theta(<span class="number">3</span>)=theta(<span class="number">3</span>)+<span class="number">0.0001</span>;  <span class="comment">%防止出现 Frank  Copula 的相依结构参数为 0</span></div><div class="line"><span class="keyword">end</span></div><div class="line">y=<span class="number">0</span>;</div><div class="line">th=<span class="built_in">eye</span>(<span class="number">2</span>);</div><div class="line">th(<span class="number">1</span>,<span class="number">2</span>)=theta(<span class="number">1</span>);</div><div class="line">th(<span class="number">2</span>,<span class="number">1</span>)=theta(<span class="number">1</span>);</div><div class="line"><span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:N</div><div class="line"></div><div class="line">    y=y+<span class="built_in">log</span>(((det(th))^(<span class="number">-1</span>/<span class="number">2</span>))*<span class="built_in">gamma</span>((nuhat+<span class="number">2</span>)/<span class="number">2</span>)*<span class="built_in">gamma</span>(nuhat/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,:)*th^(<span class="number">-1</span>)*t(<span class="built_in">j</span>,:)'/nuhat)^(-(nuhat+<span class="number">2</span>)/<span class="number">2</span>)/((<span class="built_in">gamma</span>((nuhat+<span class="number">1</span>)/<span class="number">2</span>))^<span class="number">2</span>*((<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">1</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">2</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>))))*puz(<span class="built_in">j</span>,<span class="number">1</span>)+...</div><div class="line">        <span class="built_in">log</span>(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^theta(<span class="number">2</span>)+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^theta(<span class="number">2</span>))^(<span class="number">1</span>/theta(<span class="number">2</span>)))*(<span class="built_in">log</span>(U(<span class="built_in">j</span>))*<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>)<span class="number">-1</span>)*(((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>)))^(<span class="number">1</span>/theta(<span class="number">2</span>))+theta(<span class="number">2</span>)<span class="number">-1</span>)/(U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>)))^(<span class="number">2</span><span class="number">-1</span>/theta(<span class="number">2</span>))))*puz(<span class="built_in">j</span>,<span class="number">2</span>)+...</div><div class="line">        <span class="built_in">log</span>(theta(<span class="number">3</span>)*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))*<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*(U(<span class="built_in">j</span>)+V(<span class="built_in">j</span>)))/((<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))-(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*U(<span class="built_in">j</span>)))*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*V(<span class="built_in">j</span>))))^<span class="number">2</span>)*puz(<span class="built_in">j</span>,<span class="number">3</span>);</div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">y=-y;</div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.1244</td>
<td>0.0822</td>
<td>3</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>4.1127</td>
<td>0.7495</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>6.5931</td>
<td>0.1683</td>
<td></td>
</tr>
</tbody>
</table>
<p>即<br>$$C(u,v;a)=0.7495C<em>{Gumbel}(u,v;4.1127)+0.1683C</em>{Frank}(u,v;6.5931)+0.0822C_t(u,v;0.1244,3)$$</p>
<h1 id="结果评价"><a href="#结果评价" class="headerlink" title="结果评价"></a>结果评价</h1><h2 id="Q-Q图"><a href="#Q-Q图" class="headerlink" title="Q-Q图"></a>Q-Q图</h2><p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula.jpg" alt="mixed-Copula"><br>可以与之前单一Copula的仿真QQ图进行比较<br><img src="http://oag5ozkgs.bkt.clouddn.com/im1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/im2.jpg" alt="qq图3"><br>可以明显的看出拟合优度上混合Copula有很大的优势</p>
<h2 id="K-S检验"><a href="#K-S检验" class="headerlink" title="K-S检验"></a>K-S检验</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
<th>$K_M$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
<td>0.0271</td>
</tr>
</tbody>
</table>
<p>可以看出就K-S统计值而言混合Copula也小于其他单一Copula</p>
<h2 id="欧式距离"><a href="#欧式距离" class="headerlink" title="欧式距离"></a>欧式距离</h2><table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
<th>$d_M$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
<td>1.3220</td>
</tr>
</tbody>
</table>
<p>可以看出就欧式距离而言混合Copula也小于其他单一Copula</p>
<p>PS：作为一个学电气的人一开始看到要使用一个从未见过的EM算法我几乎是拒绝的，要多谢CS的室友和我分享了有关这方面的知识并且和我一起探讨。这个程序跑起来确实让人奔溃，跑一次就要三个多小时，但是最后仿真出来的结果符合我推测确实让我很开心</p>

      
    </div>
    <footer class="article-footer">
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/EM算法/">EM算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MATLAB/">MATLAB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bfgs/">bfgs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/混合Copula/">混合Copula</a></li></ul>

      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="[post]-混合Copula函数风速建模"  class="article article-type-[post]" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/03/06/混合Copula函数风速建模/">混合Copula函数风速建模——EM算法</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/03/06/混合Copula函数风速建模/" class="article-date">
	  <time datetime="2017-03-06T01:24:08.000Z" itemprop="datePublished">2017-03-06</time>
	</a>

      
    <a class="article-category-link" href="/categories/毕业设计/">毕业设计</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/images/123.jpg" alt="1"><br><a id="more"></a><br><img src="/images/1232.jpg" alt="2"><br><img src="/images/1233.jpg" alt="3"><br><img src="/images/1234.jpg" alt="4"><br><img src="/images/1235.jpg" alt="5"><br><img src="/images/1236.jpg" alt="6"><br><img src="/images/1237.jpg" alt="7"><br><img src="/images/1238.jpg" alt="8"><br><img src="/images/1239.jpg" alt="9"></p>

      
    </div>
    <footer class="article-footer">
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Copula/">Copula</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/EM算法/">EM算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/风速建模/">风速建模</a></li></ul>

      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
      </div>
      
        <div align="center" style="margin-top: 30px;"><hr class="hr" style="margin:0px; height:3px;"></div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2013 - 2018 Jingwen&#39;s Note All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				访客数 : <span id="busuanzi_value_site_uv"></span> |  
				访问量 : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/scripts.js"></script>


  <script src="/js/home.js"></script>










	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">设置</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              正文字号大小
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            您已调整页面字体大小
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              夜间护眼模式
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            夜间模式已经开启，再次单击按钮即可关闭 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关 于&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            Jingwen&#39;s Note
          </div>
          <div class="panel-body">
            Copyright © 2018 Jingwen CHEN All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
</body>
</html>